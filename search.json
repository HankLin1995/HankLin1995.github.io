[{"title":"å‰µç«™é¦–ç¯‡æ–‡ç« ","url":"/posts/2051013919/","content":"ğŸ™Œå‰è¨€\r\nè‡ª2018å¹´é–‹å§‹æ’°å¯«Bloggerç´€éŒ„å·¥ä½œä¸Šæœƒé‡åˆ°çš„å…§å®¹ï¼Œè—‰ç”±ç´€éŒ„çš„éç¨‹ä¹Ÿæœ‰åŠ©æ–¼åŠ æ·±å°æ–¼æŸé …æŠ€è¡“çš„å°è±¡ã€‚æƒ³ç•¶åˆæˆ‘é‡åˆ°å•é¡Œçš„æ™‚å€™ä¹Ÿæ˜¯ä¸æ–·Googleï¼Œå—æƒ æ–¼å¾ˆå¤šç¶²è·¯å¤§ç¥çš„æ–‡ç« æ‰è§£æ±ºäº†å•é¡Œï¼ŒæœŸè¨±æˆ‘ä¹Ÿèƒ½å¤ æˆç‚ºç¶²è·¯ä¸–ç•Œä¸­æœ‰ç”¨çš„äººï¼Œæ’°å¯«å‡ºä¸€äº›èƒ½å¤ å°é€™å€‹ä¸–ç•Œæœ‰æ‰€å¹«åŠ©çš„æ–‡ç« ã€‚\r\nç¤™æ–¼æˆ‘å°æ–¼Bloggerçš„èª¿æ•´ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¸¸å¸¸å½±ç‰‡ä¸Šå‚³å¤±æ•—æˆ–åˆ†é çš„éç¨‹æœƒç„¡æ³•å®Œæ•´å‘ˆç¾ï¼Œæœ‰ä¸€å¤©ç•¶æˆ‘é‡åˆ°Hexo-nexTçš„ä¸»é¡Œæ™‚ï¼Œé©šç‚ºå¤©äººï¼Œé€™å®Œå…¨å°±æ˜¯æˆ‘ç†æƒ³ä¸­çš„éƒ¨è½æ ¼å¤–è§€ï¼Œå› æ­¤å°±æ±ºå®šè—‰ç”±å­¸ç¿’ä¸€é …æ–°çš„æŠ€è¡“çš„åŒæ™‚ä¹Ÿä¾†é‡å»ºä¸€ä¸‹ä»¥å‰é†œé†œçš„Google\r\nBlogger...\r\n\r\n##ğŸŒŸ ç‚ºä»€éº¼æƒ³è¦é‡å»ºä¸€å€‹éƒ¨è½æ ¼?\r\nä¸»è¦åŸå› \r\n\r\nHexo-nexTç›¸ç•¶ç°¡æ½”æœ‰åŠ›\r\n\r\næ–¼æˆ‘è€Œè¨€ï¼Œç†æƒ³ä¸­çš„éƒ¨è½æ ¼å°±æ˜¯åªè¦å¯ä»¥ä»‹ç´¹æˆ‘æ˜¯èª°ã€æ–¹ä¾¿è¨ªå®¢æŸ¥çœ‹æ–‡ç« ã€ç•™è¨€ï¼Œé€™å¹¾é …åŸºæœ¬åŠŸèƒ½å³å¯\r\nå‰›å¥½Hexoçš„nexTä¸»é¡Œå¯ä»¥èªªæ˜¯å°ˆç‚ºé€™äº›å…§å®¹è€Œç”Ÿçš„éœæ…‹é é¢æ¸²æŸ“å™¨ï¼Œå…§å»ºçš„æ–‡ç« ç›®éŒ„ã€å¯ä»¥ç›´æ¥ä½¿ç”¨markdownèªæ³•é€²è¡Œæ¸²æŸ“çš„å…§å®¹ï¼Œé‚„æœ‰å„ç¨®ç•™è¨€å¤–æ›å¯ä¾›åˆ©ç”¨ï¼Œå®Œå…¨ç¬¦åˆæˆ‘çš„éœ€æ±‚ã€‚\r\né¡å¤–å¥½è™•\r\n\r\nç¶²ç«™è‡ªä¸»æ¬Šï¼Œéå¸¸çš„é‡è¦!\r\n\r\nHexoå¯ä»¥åœ¨æœ¬åœ°ç«¯é€éhexo-cliå¥—ä»¶é€²è¡Œéœæ…‹ç¶²é æ¸²æŸ“ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å„²å­˜åŸå§‹æª”æ¡ˆï¼Œä¸æ€•æœ‰ä¸€å¤©æœå‹™æ”¶æ‰å»æ²’æœ‰åŸå§‹æª”å¯ä»¥å¾©åŸã€‚\r\næ¸²æŸ“å¾Œçš„å…§å®¹è¦çµ¦ç¶²è·¯çœ‹å¿…é ˆè¦æ‰¾å€‹ç©ºé–“é€²è¡Œéƒ¨ç½²ï¼Œå‰›å¥½GitHubPageæœ‰æä¾›é€™é …æœå‹™ï¼Œå¦‚æœ‰è³¼è²·ç¶²åŸŸï¼Œä¹Ÿå¯ä»¥é€²è¡ŒCNAMEè¨­å®šå³å¯æ“æœ‰è‡ªå·±çš„å®˜æ–¹ç¶²ç«™éƒ¨è½æ ¼äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆè®š!\r\n\r\nâ¤´ï¸æœªä¾†æ–‡ç« çµ„æˆæ–¹å‘\r\né€™å¹¾å¹´ä¾†åšäº†ä¸å°‘å€‹side\r\nprojectï¼Œå°ˆæ¡ˆåŸ·è¡Œéç¨‹ä¹Ÿèƒ½æœ‰å¹¸èˆ‡å„åœ°ç¶²å‹äº¤æµï¼Œå› ç‚ºæˆ‘æœ¬èº«æ˜¯åå·¥ç¨‹äººå“¡ï¼Œå°æ–¼è³‡è¨Šäººå“¡æ‰€èƒ½æ’°å¯«çš„ç´ æï¼Œæˆ‘å¯ä»¥å†å¤šèå…¥æœ‰é—œå·¥ç¨‹ä¸Šçš„æ‡‰ç”¨ï¼Œè€Œé€™äº›å…§å®¹ä¹Ÿæ˜¯çœ¾å¤šç¶²å‹æ‰€é—œæ³¨çš„å…§å®¹ï¼ŒåŒ…å«è¦åŠƒã€è¨­è¨ˆã€ç›£é€ ã€å·¥å‹™è¡Œæ”¿...ç­‰ã€‚\r\nåœ¨æ­¤ï¼Œæˆ‘å¾ˆæ„Ÿè¬æ›¾ç¶“å¹«åŠ©éæˆ‘çš„æœ‹å‹ï¼Œå› ç‚ºæœ‰ä½ å€‘çš„æ”¯æŒï¼Œä¹Ÿæ‰èƒ½è®“æˆ‘æœ‰å‹•åŠ›ç¹¼çºŒç ”ç©¶é–‹ç™¼ã€‚\r\nåŸºæœ¬æ¦‚å¿µ\r\nç•¶é‡åˆ°çš„å•é¡Œçš„æ™‚å€™å°±çŸ¥é“è¦å»æ‰¾ç­”æ¡ˆäº†ï¼Œé€™æ˜¯æˆ‘åœ¨è‡ªå­¸çš„éç¨‹ä¸­æ‰€é ˜æ‚Ÿåˆ°çš„ä¸€ä»¶äº‹ï¼Œçœ‹éç¨‹å¼ç¢¼å…¶å¯¦ä¸ä»£è¡¨ä½ å·²ç¶“æœƒäº†ï¼Œè€Œæ˜¯å¿…é ˆè¦æŠŠç­”æ¡ˆå¯«å‡ºä¾†ä¸¦è§£æ±ºäº†å•é¡Œæ‰æ˜¯çœŸçš„æœƒäº†!\r\n\r\nå¯«ç¨‹å¼æœ¬èº«å°±æ˜¯ä¸€å€‹ä¸æ–·é‡åˆ°éŒ¯èª¤ã€ä¿®æ­£éŒ¯èª¤çš„éç¨‹\r\n\r\næˆ‘æœƒå°‡è§£æ±ºå•é¡Œçš„éç¨‹ä¸­ï¼Œé‚£äº›å€¼å¾—ç´€éŒ„çš„åŸºæœ¬æ¦‚å¿µå¯«åœ¨æˆ‘çš„éƒ¨è½æ ¼ä¸­ï¼Œæœ‰ä¸€å¤©ç¶²è·¯ä¸Šç›¸é‡æ™‚èƒ½å¹«åŠ©åˆ°ä½ æˆ‘æœƒå¾ˆé–‹å¿ƒã€‚\r\nå°ˆæ¡ˆé–‹ç™¼\r\nå¯«ç¨‹å¼çš„ç›®æ¨™ï¼Œå¾€å¾€æ˜¯é€éå®Œæˆå°å°ˆæ¡ˆåˆä½µæˆä¸€å€‹å¤§å°ˆæ¡ˆä¾†è§£æ±ºå¯¦å‹™ä¸Šçš„å•é¡Œï¼Œæ‡‚å¾—æ‹†åˆ†éœ€æ±‚ä¹Ÿæ˜¯ä¸€åå¥½çš„è³‡è¨Šäººå“¡æ‰€éœ€è¦çš„åŸºæœ¬æŠ€èƒ½ï¼Œé–‹ç™¼éç¨‹é›£å…æœƒé‡åˆ°ä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œä½†é€™äº›å•é¡Œåˆåé›¢åŸºæœ¬æ¦‚å¿µå¤ªé ï¼Œä¸»è¦è¨´æ±‚æ˜¯ç‚ºäº†è§£æ±ºå°ˆæ¡ˆå…§å®¹è€Œç”Ÿï¼Œå› æ­¤é€™éƒ¨åˆ†ç‚ºä»¥è§£æ±ºå¯¦å‹™ä¸Šçš„å•é¡Œç‚ºå…§å®¹ï¼Œå°‡æˆ‘è¸©éçš„å‘åˆ†äº«çµ¦å„ä½åŒæ¨£é‡è¦‹è©²å•é¡Œçš„äººï¼Œè€Œä¸å†å¤šç¢ç£¨åŸºæœ¬æ¦‚å¿µã€‚\r\n\r\nå°ˆæ¡ˆé …ç›®å¦‚æœèƒ½é€²è¡Œè‰¯å¥½çš„æ‹†åˆ†ä¸¦é€²è¡Œå–®å…ƒæ¸¬è©¦çœŸçš„å¾ˆæœ‰å¹«åŠ©\r\n\r\nå°ˆæ¡ˆæˆæœ\r\n\r\nå°ˆæ¡ˆå®Œæˆä¸€å®šçš„ç¨‹åº¦å°±æœƒéœ€è¦é€²è¡Œæ¸¬è©¦ï¼Œé€éå¯¦éš›ä¸Šçš„æ¸¬è©¦ï¼Œäº†è§£å°ˆæ¡ˆçš„ç‘•ç–µåœ¨å“ªè£¡ã€‚\r\n\r\næ—¢ç„¶æœƒæœ‰æ“ä½œï¼Œé‚£æŠŠå°ˆæ¡ˆçš„ç›¸é—œæ–‡ä»¶æ’°å¯«æ¸…æ¥šï¼Œæ‰å¯èƒ½æœƒæœ‰è¾¦æ³•å¥½å¥½æ“ä½œï¼Œå› æ­¤é€™éšæ®µçš„å…§å®¹æ˜¯å°‡é–‹ç™¼å®Œæˆçš„å°ˆæ¡ˆä½¿ç”¨æƒ…æ³ã€æ“ä½œæ­¥é©Ÿå¥½å¥½æè¿°ï¼Œåœ¨æ­¤ï¼Œå¾ˆæ„Ÿè¬é¡˜æ„é€²è¡Œæ¸¬è©¦çš„å¥½æœ‹å‹ï¼Œæœ‰ä½ å€‘æ‰èƒ½è®“å°ˆæ¡ˆè¶¨æ–¼å®Œæ•´ï¼Œç”±è¡·æ„Ÿè¬!!!\r\néœ€æ±‚å›é¥‹\r\nä¸åŒçš„ä½¿ç”¨è€…æœ‰å„å¼å„æ¨£çš„éœ€æ±‚ï¼Œé€™éƒ¨åˆ†å°æˆ‘è€Œè¨€éƒ½æ˜¯å¾ˆå¥½çš„å›é¥‹ï¼Œå¦‚æœé€™äº›éœ€æ±‚èƒ½å¤ è®“ç¨‹å¼æ›´é©ç”¨æ–¼å¤§å¤šæ•¸äººçš„éœ€æ±‚ï¼Œé€™æ¨£å°æ–¼å°ˆæ¡ˆåŸ·è¡Œçš„ç™¼å±•æ–¹å‘å°±æœƒæ˜¯å¥åº·çš„ï¼Œç•¢ç«ŸåŠŸèƒ½å¥½å£å„æœ‰æ‰€ä¸»è§€æ„è­˜ï¼Œä½†è‹¥èƒ½å¤ å¤§éƒ¨åˆ†çš„äººéƒ½èªç‚ºé€™æ¨£å¾ˆæ£’ï¼Œé‚£æˆ‘ä¹Ÿå¾ˆæ¨‚æ„ç‚ºä¹‹ã€‚\r\n\r\nç•¶å¯¦å‹™ä¸Šé‡åˆ°å•é¡Œçš„æ™‚å€™è«‹ç”¨åŠ›å‘Šè¨´æˆ‘ï¼Œè¯çµ¡LINEé‚„æ˜¯Mailéƒ½å¯ä»¥!(è©³è¦‹å·¦æ–¹å´é‚Šæ””)\r\n\r\n","tags":["Blog"]},{"title":"åœŸæ–¹è¨ˆç®—-æ–¹æ ¼æ³•(VBA)","url":"/posts/4262718496/","content":"ğŸ™Œå‰è¨€\r\næœ¬ç¯‡ä¸»è¦ä»‹ç´¹åˆ©ç”¨ AutoCAD VBA çš„ç‰©ä»¶æ“ä½œ+\r\nExcel VBA\r\nçš„å·¥ä½œè¡¨å‡½æ•¸ä¾†ç°¡åŒ–å¹³å¦åœ°è²Œæ”¶æ–¹ä½œæ¥­çš„éç¨‹ã€‚\r\n\r\nåœŸæ–¹è¨ˆç®—æ˜¯å·¥ç¨‹æ–½ä½œæ™‚æœ‰é—œæ–¼ç”²ä¹™æ–¹é‡å°åœŸæ–¹æ•¸é‡æ™‚çš„é‡è¦ä¾æ“šï¼Œåˆ†ç‚ºå°å‹å·¥ç¨‹åŠå¤§å‹å·¥ç¨‹ä¾†è¨è«–ã€‚\r\n\r\nå°å‹å·¥ç¨‹\r\nåœŸæ–¹é‡‘é¡ä½”æ¯”ä¸é«˜çš„æƒ…æ³ä¸‹ï¼Œé€šå¸¸å¥‘ç´„æ•¸é‡å¤šå°‘å°±å¤šå°‘ï¼Œç”²ä¹™é›™æ–¹ä¸å¤ªæœƒæœ‰æ„è¦‹ã€‚\r\nå¤§å‹å·¥ç¨‹\r\nåœŸæ–¹é‡‘é¡ä½”æ¯”é«˜çš„æƒ…æ³ä¸‹ï¼Œç”²ä¹™é›™æ–¹æœƒé‡å°è¨­è¨ˆåŸå§‹åœ°è²Œé€²è¡Œæ”¶æ–¹ä½œæ¥­ä¸¦ä½œæˆåœŸæ–¹å ±å‘Šï¼Œä¸¦ä»¥æ­¤ä½œç‚ºå¥‘ç´„æ•¸é‡ä¿®æ­£çš„ä¾æ“šï¼Œå†æ ¹æ“šçµæ§‹é«”çš„è¨­è¨ˆé«˜ç¨‹åŠåœ–èªªæŒ‡å®šçš„é–‹æŒ–æ–¹å¼é‡æ–°è¨ˆç®—æŒ–å¡«æ–¹æ•¸é‡ã€‚\r\nè¨ˆç®—æ–¹æ³•é¸å®š\r\nåœ°å½¢æ¨¡å‹çš„å»ºç«‹æœƒæ ¹æ“šåœ°è²Œç‹€æ³è€Œå®š\r\n\r\nå…·æœ‰è¤‡é›œåœ°å½¢ç‰¹å¾µçš„åœ°å€ï¼Œä½¿ç”¨TIN(ä¸è¦å‰‡ä¸‰è§’ç¶²)\r\nåœ°å½¢è®ŠåŒ–ç›¸å°å¹³ç·©çš„åœ°å€ï¼Œä½¿ç”¨DEM(æ•¸å­—é«˜ç¨‹æ¨¡å‹)\r\n\r\næ–¹æ ¼æ³•ä¾¿æ˜¯ä½¿ç”¨DEMçš„æ¦‚å¿µï¼Œé€éæ¯å€‹æ–¹æ ¼é ‚é»è¨ˆç®—æ–¹æ ¼å¹³å‡é«˜ç¨‹å¾Œæ¨ç®—æ±‚å¾—åœŸæ–¹é«”ç©ï¼Œé«˜ç¨‹é ‚é»å‰‡åˆ©ç”¨IDW(åè·é›¢åŠ æ¬Šæ³•)ä¾†é€²è¡Œé«˜ç¨‹è³¦å€¼ï¼Œæ’å€¼éç¨‹æœƒéœ€è¦å¤§é‡çš„åŸºæœ¬é‹ç®—ã€‚\r\n\r\næœ‰é—œä¸è¦å‰‡ä¸‰è§’ç¶²å¦è«‹åƒè€ƒç­†è€…å‰æ–‡ CAD\r\nVBA@æ”¶æ–¹ä½œæ¥­(ä¸è¦å‰‡ä¸‰è§’ç¶²æ³•)\r\n\r\n\r\nğŸ¬å½±ç‰‡æ“ä½œ\r\n\r\n\r\n\r\næœ‰æ”¶æ–¹ä½œæ¥­çš„éœ€æ±‚æ­¡è¿é€éå·¦æ–¹å´é‚Šæ¬„å…§å®¹è¯ç¹«E-mailæˆ–LINEé€²è¡Œè«®è©¢ã€‚\r\n\r\nğŸ‘‰å¯¦ç¾é‚è¼¯\r\nå»ºç«‹æ¸¬é‡é»(å½±ç‰‡æœªå‡ºç¾)\r\nå¯ä»¥å°‡GPSæˆ–å…¨æ¸¬ç«™æ‰€æ‹¿åˆ°çš„é«˜ç¨‹é»åŒ¯å‡ºæˆCSVæª”æ¡ˆå†æ”¾ç½®æ–¼Excelæœƒæ¯”è¼ƒå¿«ï¼Œå¦‚æœæ”¶åˆ°çš„æª”æ¡ˆå·²ç¶“æ˜¯CADåœ–ä¹Ÿå¯ä»¥ï¼Œåœ–å¡Šçš„é»è³‡æ–™å¯ä»¥èƒå–å‡ºä»–çš„XYåº§æ¨™ï¼ŒZåº§æ¨™å‰‡é€šå¸¸æœƒæ”¾ç½®æ–¼åœ–å¡Šå±¬æ€§ä¸­ï¼Œé€™éœ€è¦çœ‹å€‹æ¡ˆåœ–å¡Šå…§å®¹è§£æ±ºã€‚\r\n\r\nå°‡è¨­è¨ˆåœ–é¢æ‰€è¨˜éŒ„çš„é«˜ç¨‹é»æ”¾å…¥å·¥ä½œè¡¨(\"DESIGN\")\r\n\r\n\r\n\r\nFig1. è¨­è¨ˆåœ–é¢é«˜ç¨‹\r\n\r\n\r\nå°‡æ”¶æ–¹ä½œæ¥­æ‰€è¨˜éŒ„çš„é«˜ç¨‹é»æ”¾å…¥å·¥ä½œè¡¨(\"CHECK\")\r\n\r\n\r\n\r\nFig2.æ”¶æ–¹ä½œæ¥­é«˜ç¨‹\r\n\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nç”¨é€”èªªæ˜\r\n\r\n\r\n\r\n\r\nNum\r\né»åç¨±\r\n\r\n\r\nX\r\nTWD97-Eåº§æ¨™\r\n\r\n\r\nY\r\nTWD97-Nåº§æ¨™\r\n\r\n\r\nZ\r\né«˜ç¨‹\r\n\r\n\r\nLength\r\nèˆ‡é ‚é»çš„è·é›¢\r\n\r\n\r\n\r\næ­¤è™•çš„Lengthæœƒç”±æ¯ä¸€é»å»èˆ‡range(\"F1\")ã€range(\"G1\")é€²è¡Œè·é›¢æ›ç®—(IDWä½¿ç”¨)\r\nç¹ªè£½é»ä½(0608æ›´æ–°)\r\nå¡«å¯«å®Œ\r\nDESIGNå·¥ä½œè¡¨åŠCHECKå·¥ä½œè¡¨æ™‚ï¼Œå¯ä»¥ç¢ºèªä¸€ä¸‹é‚Šç•Œæ˜¯å¦ç¬¦åˆè¨­å®šç¯„åœï¼Œæ­¤æ™‚å¯ä»¥é»é¸æŒ‰éˆ•\"ç¹ªè£½é»ä½\"ä¾†æª¢æ ¸å¯¦éš›é»è³‡æ–™åè½æ–¼CADä¸­çš„ä½•è™•ã€‚\r\n\r\n\r\nFig2-1.ç¹ªè£½é»ä½æˆæœ\r\n\r\nå»ºç«‹æ–¹æ ¼\r\n\r\nå–å¾—è¨ˆç•«ç¯„åœä¹‹å¾Œï¼Œæ‰¾å‡ºå…¶é‚Šç•Œä½ç½®\r\næ–¹æ ¼æœƒåœ¨é‚Šç•Œå…§ä¾åºç¹ªè£½ä¸¦èˆ‡è¨ˆç•«ç¯„åœåˆ¤é‡‹å…©å¤šé‚Šå½¢ä½ç½®é—œä¿‚\r\nä½ç½®é—œä¿‚å¯åˆ†ç‚ºä¸‹åˆ—ä¸‰ç¨®\r\n\r\nè¨ˆç•«ç¯„åœå¤–&gt;&gt;åˆªé™¤\r\nè¨ˆç•«ç¯„åœå…§&gt;&gt;ä¿ç•™ä¸å‹•\r\nè¨ˆç•«ç¯„åœèˆ‡ä¹‹ç›¸äº¤&gt;&gt;å¦å¤–å»ºç«‹è¨ˆç•«ç¯„åœå¤–éƒ¨é¢ç©\r\n\r\n\r\n\r\nè¨ˆç•«ç¯„åœèˆ‡ä¹‹ç›¸äº¤å¯èƒ½æœƒæœ‰å°å•é¡Œï¼Œéœ€è¦é‡å°éŒ¯èª¤åœ°æ–¹é€²è¡Œ-BOå¢åŠ æ–¹æ ¼é‚Šç•Œç·šæˆ–åˆªé™¤éŒ¯èª¤æ–¹æ ¼\r\n\r\næ–¹æ ¼ç·¨è™ŸåŠé¢ç©\r\n\r\næ¡†é¸æ‰€æœ‰æ–¹æ ¼åŠå¤–éƒ¨é¢ç©\r\næ–¹æ ¼ç”±å·¦ä¸Šåˆ°å³ä¸‹ä¾åºç·¨è™Ÿ\r\nè¨ˆç®—å¤–éƒ¨é¢ç©å½¢å¿ƒåˆ°æ‰€æœ‰æ–¹æ ¼çš„ä½ç½®ä¸¦æŒ‡å®šå…¶æ­¸å±¬å“ªå€‹æ–¹æ ¼\r\nç”±æŒ‡å®šå…§å®¹é€²è¡Œé¢ç©æ‰£é™¤\r\n\r\n\r\n\r\nFig3.æ–¹æ ¼è³‡æ–™ä¸»è¦é é¢\r\n\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nç”¨é€”èªªæ˜\r\n\r\n\r\n\r\n\r\nNum\r\næ–¹æ ¼ç·¨è™Ÿ\r\n\r\n\r\nGrid_Handle\r\næ–¹æ ¼åœ¨CADä¸­çš„é€£æ¥ç¢¼\r\n\r\n\r\nCentroid_X\r\næ–¹æ ¼å½¢å¿ƒXåº§æ¨™\r\n\r\n\r\nCentroid_Y\r\næ–¹æ ¼å½¢å¿ƒYåº§æ¨™\r\n\r\n\r\nDESIGN\r\nå¹³å‡é ‚é»è¨­è¨ˆé«˜ç¨‹\r\n\r\n\r\nCHECK\r\nå¹³å‡é ‚é»æ”¶æ–¹é«˜ç¨‹\r\n\r\n\r\nVolume\r\nåœŸæ–¹é«”ç©\r\n\r\n\r\n\r\næ–¹æ ¼é ‚é»è¨ˆç®—æ’å€¼\r\n\r\nåŒ¯å‡ºæ‰€æœ‰æ–¹æ ¼ä¸é‡è¤‡é ‚é»\r\né‡å°æ¯å€‹é ‚é»é€²è¡ŒIDWæ’å€¼\r\næœå°‹åŠå¾‘é è¨­ç‚ºæ–¹æ ¼å¤§å°ï¼Œè¨ˆç®—é»æ•¸é è¨­ç‚º3é»\r\nå¦‚é ‚é»å› ç‚ºé«˜ç¨‹é»çš„åˆ†å¸ƒé—œä¿‚ç„¡æ³•æ»¿è¶³ä¸Šè¿°æ¢ä»¶å‰‡æ’å€¼ç‚º0\r\n\r\n\r\n\r\nFig4.æ–¹æ ¼é ‚é»è³‡æ–™\r\n\r\næ–¹æ ¼åœŸæ–¹é«”ç©è¨ˆç®—\r\n\r\né€éGrid_Handleé€£æ¥è©²æ–¹æ ¼åœ¨CADä¸­çš„å„é ‚é»\r\nå°‡å„é ‚é»èˆ‡è¨­è¨ˆé«˜ç¨‹åº§æ¨™æ¯”å°è¨ˆç®—è©²æ–¹æ ¼å¹³å‡é ‚é»è¨­è¨ˆé«˜ç¨‹\r\nå°‡å„é ‚é»èˆ‡æ”¶æ–¹é«˜ç¨‹åº§æ¨™æ¯”å°è¨ˆç®—è©²æ–¹æ ¼å¹³å‡é ‚é»æ”¶æ–¹é«˜ç¨‹\r\nç”±å¹³å‡æ”¶æ–¹é«˜ç¨‹æ‰£é™¤å¹³å‡è¨­è¨ˆé«˜ç¨‹èˆ‡æ–¹æ ¼é¢ç©é€²è¡Œç›¸ä¹˜æ±‚å¾—æ–¹æ ¼åœŸæ–¹é«”ç©\r\n\r\nåœŸæ–¹å ±å‘Š\r\nå°‡ä¸Šè¿°è¨ˆç®—æˆæœæ”¾å…¥å·¥ä½œè¡¨(\"REPORT\")\r\n\r\n\r\nFig5.åœŸæ–¹è¨ˆç®—æ›¸\r\n\r\nVBAå·¥å…·é€£çµ\r\nä¸Šè¿°åŸºæœ¬åŠŸèƒ½æœ‰éœ€è¦å¯ä»¥åƒè€ƒä¸‹æ–¹é€£çµï¼Œæ“ä½œä¸Šæœ‰å•é¡Œå¯è‡³LINEå®˜æ–¹å¸³è™Ÿæå•ã€‚\r\nğŸ”—åœŸæ–¹è¨ˆç®—(æ–¹æ ¼æ³•)VBAæ“ä½œæª”æ¡ˆ+å®Œæ•´åŸå§‹ç¢¼\r\n\r\nå¯è¦–åŒ–å‘ˆç¾(é–‹ç™¼ä¸­)\r\næ–¹æ ¼å¯ä»¥é€éå»ºç«‹3D\r\nBOXçš„æ–¹å¼é€²è¡Œå¯è¦–åŒ–å‘ˆç¾ï¼Œå› ç‚ºé«˜ç¨‹çš„å·®ç•°åªæœ‰ä¸€é»é»ï¼Œæ‰€ä»¥é‚„æ˜¯éœ€è¦å°‡é«˜ç¨‹å€æ•¸æ”¾å¤§è®“ä½¿ç”¨è€…å¯ä»¥æ›´æ¸…æ¥šæŒæ¡ç´°ç¯€ã€‚\r\n\r\n\r\nFig6.åœŸæ–¹é«˜ç¨‹å·®å¯è¦–åŒ–å‘ˆç¾\r\n\r\né™¤äº†ä»¥æŸ±ç‹€é«”æ–¹å¼å‘ˆç¾ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥é€éHatchçš„é¡è‰²å·®ç•°é€²è¡ŒæŒ–æ–¹å¡«æ–¹çš„åˆ¤é‡‹ï¼Œæ¯”å¦‚èªªæŒ–æ–¹å€åŸŸå°±çµ¦ç¶ è‰²ï¼Œå¡«æ–¹å€åŸŸå°±çµ¦ç´…è‰²ã€‚\r\nğŸ‘¨â€ğŸ«å¹¾ä½•åœ–å­¸åˆ¤é‡‹\r\n\r\næ•´é«”é‚„æœ‰å¾ˆå¤šå¯¦ç¾ç´°ç¯€å¯ä»¥é€²å»ç¨‹å¼ç¢¼è£¡é¢çœ‹!\r\n\r\nåˆ¤æ–·é»è·Ÿå¤šé‚Šå½¢çš„é—œä¿‚\r\nFunction IsPointInPolygon(X, Y, poly() As Double) As Boolean    &#x27; Check if a point is inside a polygon.    &#x27; Args:    &#x27;   x: X coordinate of the point.    &#x27;   y: Y coordinate of the point.    &#x27;   poly: An array representing the vertices of the polygon.    &#x27; Returns:    &#x27;   True if the point is inside the polygon, False otherwise.    Dim i As Integer, j As Integer    Dim numVertices As Integer    Dim oddNodes As Boolean    numVertices = UBound(poly) \\ 2 + 1    &#x27; Check if the point is inside the polygon using the ray-casting algorithm    j = numVertices - 1    oddNodes = False    For i = 0 To numVertices - 1        If (poly(2 * i + 1) &gt; Y) &lt;&gt; (poly(2 * j + 1) &gt; Y) Then            If (poly(2 * j + 1) - poly(2 * i + 1)) &lt;&gt; 0 Then                If X &lt; (poly(2 * j) - poly(2 * i)) * (Y - poly(2 * i + 1)) / (poly(2 * j + 1) - poly(2 * i + 1)) + poly(2 * i) Then                    oddNodes = Not oddNodes                End If            End If        End If        j = i    Next i    &#x27; Check if the point is exactly on a vertex or an edge    For i = 0 To numVertices - 1        j = (i + 1) Mod numVertices        &#x27; Check if the point is on a vertex        If X = poly(2 * i) And Y = poly(2 * i + 1) Then            IsPointInPolygon = True            Exit Function        End If        &#x27; Check if the point is on an edge        If ((poly(2 * i + 1) &lt;= Y And Y &lt;= poly(2 * j + 1)) Or (poly(2 * j + 1) &lt;= Y And Y &lt;= poly(2 * i + 1))) And _           (X &lt;= myMax(poly(2 * i), poly(2 * j))) And (poly(2 * j + 1) - poly(2 * i + 1) &lt;&gt; 0) Then            If X = (poly(2 * j) - poly(2 * i)) * (Y - poly(2 * i + 1)) / (poly(2 * j + 1) - poly(2 * i + 1)) + poly(2 * i) Then                IsPointInPolygon = True                Exit Function            End If        End If    Next i    IsPointInPolygon = oddNodesEnd Function\r\nåˆ¤æ–·å¤šé‚Šå½¢çš„ä½ç½®é—œä¿‚\r\nFunction PolygonsRelation(poly1() As Double, poly2() As Double) As String    &#x27; Check relation between two closed polygons.    &#x27; Args:    &#x27;   poly1: An array representing the vertices of the first closed polygon.    &#x27;   poly2: An array representing the vertices of the second closed polygon.    &#x27; Returns:    &#x27;   String indicating the relation between two polygons:    &#x27;     - &quot;Disjoint&quot;: If polygons are disjoint.    &#x27;     - &quot;Contains&quot;: If poly1 contains poly2.    &#x27;     - &quot;Contained By&quot;: If poly2 contains poly1.    &#x27;     - &quot;Overlap&quot;: If polygons overlap.        Dim i As Integer, j As Integer    Dim numVertices1 As Integer, numVertices2 As Integer    Dim containsPoly1 As Boolean, containsPoly2 As Boolean    Dim intersects As Boolean    Dim X As Double    Dim Y As Double    numVertices1 = UBound(poly1) \\ 2 + 1    numVertices2 = UBound(poly2) \\ 2 + 1        &#x27; Check if one polygon is completely contained in the other    containsPoly1 = False    containsPoly2 = False    For i = 0 To numVertices1 - 1 &#x27;æª¢æŸ¥é»è³‡æ–™æ˜¯å¦åœ¨poly2è£¡é¢        If IsPointInPolygon(poly1(2 * i), poly1(2 * i + 1), poly2) Then            containsPoly1 = True            Exit For        End If            Next i        For j = 0 To numVertices2 - 1 &#x27;æª¢æŸ¥é»è³‡æ–™æ˜¯å¦åœ¨poly1è£¡é¢        If IsPointInPolygon(poly2(2 * j), poly2(2 * j + 1), poly1) Then            containsPoly2 = True            Exit For        End If    Next j        &#x27; Check if polygons are disjoint    If Not containsPoly1 And Not containsPoly2 Then        intersects = False        For i = 0 To numVertices1 - 1            For j = 0 To numVertices2 - 1                If DoIntersect(poly1(2 * i), poly1(2 * i + 1), poly1((2 * ((i + 1) Mod numVertices1))), poly1((2 * ((i + 1) Mod numVertices1)) + 1), _                               poly2(2 * j), poly2(2 * j + 1), poly2((2 * ((j + 1) Mod numVertices2))), poly2((2 * ((j + 1) Mod numVertices2)) + 1)) Then                    intersects = True                    Exit For                End If            Next j            If intersects Then Exit For        Next i        If Not intersects Then            PolygonsRelation = &quot;Disjoint&quot;            Exit Function        End If    End If        &#x27; Check for containment    If containsPoly1 And containsPoly2 Then        PolygonsRelation = &quot;Overlap&quot;    ElseIf containsPoly1 Then        PolygonsRelation = &quot;Contains&quot;    ElseIf containsPoly2 Then        PolygonsRelation = &quot;Contained By&quot;    Else        PolygonsRelation = &quot;Overlap&quot;    End IfEnd Function\r\nğŸ¯é–‹ç™¼å°çµ\r\n\r\né€²è¡ŒIDWæœƒéœ€è¦è¨ˆç®—è·é›¢ï¼Œå»ºè­°é€éå…§å»ºå‡½æ•¸å»åŸ·è¡Œï¼Œä¸è¦å¾VBAç®—å®ŒLengthä¹‹å¾Œå†å¡«å„²å­˜æ ¼ï¼Œæ•ˆèƒ½å·®å¾ˆå¤šã€‚\r\nåˆ¤å®šå¤šé‚Šå½¢å¹¾ä½•é—œä¿‚æ™‚ï¼Œéœ€è¦é¡å¤–è€ƒé‡å››å€‹é ‚é»éƒ½åœ¨è¨ˆç•«ç¯„åœå¤–ä½†æ˜¯è¨ˆç•«ç¯„åœæœ‰å‡¸å¤šé‚Šå½¢æ’åœ¨æ–¹æ ¼ä¸­çš„æƒ…å½¢ã€‚\r\né›»è…¦è¨ˆç®—èƒ½åŠ›å¾ˆå¼·çš„å¯ä»¥å°‡è¨ˆç•«ç¯„åœåˆ‡æˆ5*5çš„æ–¹æ ¼ï¼Œä½†æ˜¯é‚„æ˜¯è¦è€ƒé‡é»è³‡æ–™çš„å¯†åº¦æ˜¯å¦è¶³å¤ ï¼Œå¯†åº¦ä¸è¶³æœƒå°è‡´å¾ˆå¤šé ‚é»éƒ½æ˜¯ä¸åˆç†çš„ï¼Œç¨‹å¼æœƒè‡ªå‹•åˆ¤é‡‹ç‚º0\r\nIDWè¨ˆç®—æ™‚å¯ä»¥é€éCross\r\nValidationçš„æ–¹å¼åˆ¤æ–·ç›®å‰æ¨¡å‹çš„åˆç†ç¨‹åº¦ï¼Œå½±éŸ¿IDWæœ‰æœå°‹åŠå¾‘ã€è¨ˆç®—æœ€å°‘é»æ•¸ã€è·é›¢å€’æ•¸çš„å¹•æ¬¡ã€‚\r\n\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["AutoCAD VBA","Excel VBA","åœŸæ–¹è¨ˆç®—"]},{"title":"CADVBAæ•™å­¸(ä¸€)","url":"/posts/558703190/","content":"å‰è¨€\r\nä¸€èˆ¬æåˆ°CADå¤§å¤šæ•¸éƒ½ä»¥ç‚ºæ˜¯AutoCADï¼Œä½†å…¶å¯¦CADç‰ˆæœ¬æœ‰å¥½å¤šå¥½å¤šç¨®ï¼Œåªæ˜¯å› ç‚ºå­¸æ ¡é€šå¸¸éƒ½å…ˆæ•™AutoCADé€²è¡Œä½¿ç”¨ï¼Œé€éæ•™è‚²ç‰ˆçš„å…è²»åˆ¶åº¦åŸ¹é¤Šä¸€ç¥¨AutoCADçš„ç²‰çµ²ï¼Œåœ¨ç¿’æ…£ä»‹é¢ä¹‹å¾Œè·³å¾€å…¶ä»–ç‰ˆæœ¬çš„CADæœƒæœ‰é»éšœç¤™ï¼Œä½†å› ç‚ºAutoCADåœ¨å¾ŒæœŸå¤§å¤šæ”¹æˆè¨‚é–±åˆ¶ï¼Œå°è‡´å¾ˆå¤šå…¬å¸è¡Œè™Ÿè½‰å¾€å…¶ä»–ç®¡é“ä½¿ç”¨ï¼Œç­†è€…æ‰€åœ¨çš„æ©Ÿé—œç›®å‰ä¹Ÿæ˜¯ä½¿ç”¨ProgeCADä½œç‚ºä¸»åŠ›ä½¿ç”¨ã€‚\r\né—œæ–¼CADçš„ç‰ˆæœ¬:\r\n\r\nAutoCAD(è¨‚é–±åˆ¶)\r\nZWCAD(ä¸­è³‡æˆåˆ†è¢«ç¦ç”¨)\r\nProgeCAD(è²·æ–·åˆ¶)\r\n\r\nå¦‚æœåŸºæœ¬çš„æ“ä½œåŠŸèƒ½ä¸æ•·ä½¿ç”¨å°è‡´æ•ˆç‡ä½è½æ™‚ï¼Œå¯ä»¥é€éCADæœ¬èº«æä¾›çš„å¥—ä»¶é€²è¡Œé¡å¤–å¼·åŒ–ï¼Œè€ŒVBAå‰‡æ˜¯æä¾›å¥—ä»¶ä¹‹ä¸€ï¼Œç­†è€…è‡ª2018å¹´èµ·ä¾¿é–‹å§‹é€²è¡ŒAutoCADVBAç›¸é—œé–‹ç™¼ï¼Œç‰¹åˆ¥ä»‹ç´¹å•Ÿè’™å°å¸«ç‚ºé¦¬å…‹çš„ç‡Ÿå»ºèˆ‡é›»è…¦ï¼Œç•¶åˆå°±æ˜¯è¢«ä»–çš„Excelè‡ªå‹•ç¹ªè£½ç¸±å¡åœ–è¡¨å¸å¼•åˆ°ï¼Œè€Œé–‹å§‹ä¸€ç³»åˆ—çš„ç ”ç©¶ä¹‹è·¯ã€‚\r\næœ¬ç³»åˆ—æ–‡ä¸»è¦æ˜¯ä»‹ç´¹ç­†è€…åœ¨CADVBAä¸Šçš„å¿ƒè·¯æ­·ç¨‹ï¼Œå¸Œæœ›èƒ½å¤ ç”±æ·ºå…¥æ·±ï¼ŒæœŸå¾…å„ä½è®€è€…å¸æ”¶å¾Œä¹Ÿèƒ½å…·å‚™ä¿®æ”¹VBAç¨‹å¼ç¢¼çš„èƒ½åŠ›ï¼Œå„ªåŒ–è‡ªèº«å·¥ä½œæµç¨‹ï¼Œè—‰ç”±ç¯€çœä¸‹ä¾†çš„æ™‚é–“ä¾†é–‹ç™¼æ›´å¤šå¥½ç”¨çš„å·¥å…·ï¼Œè‰¯æ€§å¾ªç’°ã€‚\r\n\r\nVBAç’°å¢ƒå»ºç«‹\r\nAutoCAD\r\nè‡ª2012å¹´èµ·ï¼Œä¸å†é è¨­å®‰è£æ–¼AutoCADï¼Œå¦‚æœéœ€è¦ä½¿ç”¨æ™‚è¦åˆ°å®˜ç¶²ä¸‹è¼‰å®‰è£ã€‚\r\nå®˜æ–¹VBAä¸‹è¼‰é»\r\nProgeCAD\r\nå…§å»ºæ–¼è£¡é¢ï¼Œä½†å±¬æ€§åŠæ–¹æ³•ä»ä¸åƒAutoCADé‚£éº¼å®Œæ•´ï¼Œæœ‰æ™‚å€™è«‹åŸå» ä¿®å¾©æ™‚ä¹Ÿæ¯”è¼ƒæœƒæ‹–ï¼Œéœ€è¦é€éä¿®æ”¹æ¼”ç®—æ³•é€²è¡Œå•é¡Œæ’é™¤ã€‚\r\nä¸åŒç‰ˆæœ¬é–“çš„CADé–‹ç™¼\r\nExcelèˆ‡CADé€£æ¥æ–¹æ³•\r\nExcelæ˜¯å¤§éƒ¨åˆ†å·¥ç¨‹äººå“¡æœ€å¸¸æ¥è§¸çš„å·¥å…·ï¼ŒExcelä½œç‚ºè³‡æ–™é€²å‡ºçš„ä¸»è¦æ“ä½œåª’ä»‹ï¼ŒåŒæ™‚ä¹Ÿå…·å‚™VBAçš„åŠŸèƒ½ï¼Œèƒ½å¤ å°‡CADä½œç‚ºå¼•ç”¨é …ç›®é€²è¡Œé€£å‹•ï¼Œè³‡æ–™å°±èƒ½é€éExcelèˆ‡CADé€£æ¥ï¼Œé©…å‹•CADé€²è¡Œåœ–èªªç¹ªè£½ã€‚\r\nå…ˆæœŸå¼•ç”¨\r\n\r\nExcel&gt;æª”æ¡ˆ&gt;é¸é …&gt;è‡ªè¨‚åŠŸèƒ½å€&gt;é–‹ç™¼äººå“¡å‹¾é¸\r\n\r\n\r\n\r\nFig1. é–‹ç™¼äººå“¡é¸å–®\r\n\r\n\r\né–‹ç™¼äººå“¡&gt;æª¢è¦–ç¨‹å¼ç¢¼&gt;å·¥å…·&gt;è¨­å®šå¼•ç”¨é …ç›®&gt;æ‰¾åˆ°ç›¸é—œçš„å¥—ä»¶å‹¾é¸\r\n\r\n\r\n\r\nFig2. å¼•ç”¨é …ç›®å‹¾é¸\r\n\r\nè‹¥ä»¥ProgeCAD2021ç‰ˆç‚ºä¾‹ï¼Œæœƒæ‰¾åˆ°ProgeCAD 2021 Object\r\nLibraryï¼Œé€™å€‹å°±æ˜¯å¼•ç”¨å°è±¡ï¼Œä¸åŒå¹´ä»£ç‰ˆæœ¬å°æ‡‰åˆ°çš„åç¨±æœƒä¸åŒï¼Œé€™æ˜¯ä»–æ¯”è¼ƒéº»ç…©çš„åœ°æ–¹ã€‚\r\nå¾ŒæœŸå¼•ç”¨\r\né€éå‡½æ•¸çš„å¼•ç”¨å¯ä»¥ç›´æ¥æ“ä½œCADï¼Œé”æˆåœ¨VBAä¸­é€²è¡Œè³‡æ–™å‚³éåˆ°CADçš„ä½œç”¨ï¼Œä¸¦é©…å‹•CADæä¾›çš„å‡½æ•¸é€²è¡Œé»ã€ç·šã€é¢ã€æ–‡å­—ç­‰ç­‰åŸºæœ¬æ“ä½œã€‚\r\npublic mo &#x27;æ¨¡å‹ç©ºé–“public pa &#x27;é…ç½®ç©ºé–“public acadDoc &#x27;æ“ä½œå·¥å…·é¡å‡½æ•¸Sub CADInit()On Error Resume NextSet acadApp = GetObject(, &quot;AutoCAD&quot;) If Err &lt;&gt; 0 Then Set acadApp = CreateObject(&quot;AutoCAD&quot;)acadApp.Visible = TrueOn Error GoTo 0Set mo = acadApp.ActiveDocument.ModelSpaceSet pa = acadApp.ActiveDocument.PaperSpaceSet acadDoc = acadApp.ActiveDocumentEnd Sub\r\nè¸©é›·éç¨‹\r\n\r\nAutoCADç”¨å…ˆæœŸå¼•ç”¨æ™‚ï¼Œæœƒå› ç‚ºå„ä¸»æ©Ÿå®‰è£ç‰ˆæœ¬ä¸åŒå°è‡´å‡ºç¾éŒ¯èª¤ï¼Œéœ€è¦é€²å…¥ç¨‹å¼ç¢¼ç·¨è¼¯å™¨ä¸­å‹¾é¸æ­£ç¢ºç‰ˆæœ¬çš„å¼•ç”¨é …ç›®ï¼Œä¸¦å–æ¶ˆéºæ¼çš„å¼•ç”¨é …ç›®ï¼Œä¸ç„¶æœƒå°è‡´ç¨‹å¼ç¢¼å‡ºç¾ä¸å¯è§£é‡‹çš„éŒ¯èª¤è¡Œç‚ºã€‚\r\nProgeCADåªèƒ½é€éå…ˆæœŸå¼•ç”¨ï¼Œå¾ŒæœŸå¼•ç”¨æœƒå¤±æ•ˆï¼Œæ“ä½œéƒ¨åˆ†ç‰©ä»¶å…§å®¹æ™‚æœƒå¤±æ•ˆï¼Œæˆ‘é‡åˆ°çš„æ˜¯Libraryç‰©ä»¶çš„æ“ä½œæœƒå‡ºç¾å•é¡Œï¼ŒLibraryç‰©ä»¶çš„CreatePointæ–¹æ³•èˆ‡é»è³‡æ–™å¯†åˆ‡é—œé€£ï¼Œä¸å¯é¿å…ï¼Œå¾Œä¾†é€éæ˜ç¢ºçš„å…ˆæœŸå¼•ç”¨å¼•å…¥å°±å¯ä»¥äº†ã€‚\r\nç‰©ä»¶ç€è¦½æ˜¯åœ¨æŸ¥è©¢å°è±¡çš„å±¬æ€§åŠæ–¹æ³•å¿…å‚™å·¥å…·ï¼Œéœ€è¦æœ‰å¼•ç”¨æ‰æœ‰è¾¦æ³•é¡¯ç¤ºProgeCADç›¸é—œç‰©ä»¶ï¼Œå¼•ç”¨çš„åç¨±å«åšIntelliCADï¼Œå¦‚è¦æ¡ç”¨å¾ŒæœŸå¼•ç”¨æ™‚ï¼Œå‚³é€çµ¦å…¶ä»–äººæ™‚è¦è¨˜å¾—å–æ¶ˆå‹¾é¸ã€‚\r\n\r\nç›¸é—œæ–‡ç« \r\n\r\nAutoCADVBAå­¸ç¿’è³‡æº\r\nVBAå¼•ç”¨é …ç›®å•é¡Œ\r\n\r\n","categories":["åŸºæœ¬åŸç†"],"tags":["AutoCAD VBA","ProgeCAD VBA"]},{"title":"PCCES XML å¾Œè™•ç†å·¥å…·ç·šä¸Šç‰ˆ","url":"/posts/375550287/","content":"å‰è¨€\r\nå…¬å…±å·¥ç¨‹çš„é ç®—æ›¸ç·¨åˆ¶æµç¨‹ä¸­ï¼ŒPCCESï¼ˆå…¬å…±å·¥ç¨‹é ç®—ç·¨åˆ¶ç³»çµ±ï¼‰æ‰€ç”¢å‡ºçš„æˆæœæœ‰Excelæˆ–XMLï¼ŒExcelæª”æ¡ˆæœ€å¸¸ä»¤äººé ­ç—›çš„å•é¡Œå°±æ˜¯é …ç›®åç¨±éé•·æ™‚å®¹æ˜“æœ‰æ–‡å­—ä¸é€£çºŒçš„å•é¡Œï¼Œè¦è½‰ç§»è‡³å…¶ä»–è‡ªå·±ç·¨å¯«çš„å°å·¥å…·é€²è¡Œåˆ©ç”¨æ™‚éœ€è¦å…ˆå°‡é€™å€‹æ–‡å­—éƒ¨åˆ†æ•´ç†å¾Œæ‰èƒ½é€²è¡Œã€‚ä»¥å‰ç­†è€…æ›¾ç¶“æ’°å¯«é\r\nExcel\r\nç‰ˆæœ¬çš„ XML å¾Œè™•ç†å·¥å…·ï¼Œä½†è€ƒé‡åˆ°éƒ¨åˆ†ä½¿ç”¨è€…å¯èƒ½æ²’æœ‰å®‰è£\r\nExcelï¼Œæˆ–æ˜¯å…¬å¸è³‡è¨Šéƒ¨é–€å°é–äº† Excel VBA\r\nçš„ç›¸é—œåŠŸèƒ½ï¼Œå› æ­¤ç­†è€…æ±ºå®šé–‹ç™¼ä¸€å€‹ç·šä¸Šç‰ˆçš„å·¥å…·ä¾›å¤§å®¶ä½¿ç”¨ã€‚\r\næ­¤å¤–ï¼Œé€™æ¬¡çš„é–‹ç™¼éç¨‹ï¼Œæˆ‘ä¹Ÿé †é“åˆ©ç”¨ ChatGPT\r\nä¾†å¯¦ä½œæ•´å€‹å°ˆæ¡ˆï¼Œä¸¦æ ¹æ“š AI ç”¢å‡ºçš„æ¶æ§‹é€æ­¥èª¿æ•´èˆ‡å„ªåŒ–ï¼Œæ¸¬è©¦ä¸€ä¸‹ AI\r\nåœ¨ç¨‹å¼é–‹ç™¼ä¸Šçš„èƒ½åŠ›ã€‚\r\n\r\nAI é–‹ç™¼çš„é«”é©—èˆ‡è§€å¯Ÿ\r\nåœ¨é–‹ç™¼éç¨‹ä¸­ï¼Œæˆ‘å°‡åŸæœ¬çš„ Excel VBA ç¨‹å¼ç¢¼ é€æ­¥æä¾›çµ¦\r\nChatGPTï¼Œä¸¦è«‹å®ƒè½‰æ›æˆ\r\nPythonçš„streamlitå¥—ä»¶å…§å®¹ã€‚éç¨‹ä¸­ï¼Œæˆ‘ç™¼ç¾ AI\r\nçœŸçš„ç™¼å±•å¾—ç›¸ç•¶è¿…é€Ÿï¼Œä½†å®ƒåœ¨é–‹ç™¼é ˜åŸŸä»æœ‰ä¸€äº›é™åˆ¶ï¼š\r\n\r\néœ€æ±‚æè¿°ä»éœ€äººé¡ä»‹å…¥ï¼šAI\r\nå¯ä»¥å¹«åŠ©æ’°å¯«åŸºæœ¬ç¨‹å¼ï¼Œä½†éœ€æ±‚æè¿°ä¸æ˜ç¢ºæ™‚æœƒå·®é‚£éº¼ä¸€é»å…’ã€‚\r\n\r\néŒ¯èª¤æ’é™¤ä»éœ€äººé¡åˆ¤æ–·ï¼šAI\r\nå¯ä»¥æä¾›éŒ¯èª¤ä¿®æ­£å»ºè­°ï¼Œä½†æ˜¯å¦å®Œå…¨ä¿®æ­£å¾ˆé é‹æ°£ï¼Œæœ‰æ™‚æœƒç¹äº†ä¸€é™£å­åˆå›åˆ°åŸæœ¬çš„ç‹€æ³ï¼Œé€™æ™‚ä»ç„¶æœƒéœ€è¦æ‡‚ä¸€äº›åŸºæœ¬èªæ³•æœƒæ¯”è¼ƒå¿«è§£æ±ºå•é¡Œã€‚\r\n\r\nAI\r\nå¯ä»¥æ˜¯å¯«ç¨‹å¼çš„å¥½å¤¥ä¼´ï¼Œä½†è¦è®“å®ƒå®Œå…¨å–ä»£äººé¡çš„é€™å€‹æ­¥é©Ÿï¼Œæˆ‘æƒ³é‚„æœ‰ä¸€æ®µè·¯è¦èµ°ï¼Œå¥½å¥½æŠŠæ¡AIèƒ½å¤ è§£æ±ºåŸºæœ¬å•é¡Œçš„èƒ½åŠ›ï¼Œå¾ä¸­åŠ é€Ÿè¿­ä»£é–‹ç™¼ç‰ˆæ¬¡æœƒæ˜¯æ¯”è¼ƒç†æƒ³çš„åšæ³•ï¼Œç•¶ç„¶ä¹Ÿä¸å»ºè­°ä¸€æ¬¡å°±è®“AIæ”¹å¥½æ”¹æ»¿ï¼Œæ”¹åˆ°æœ€å¾Œä½ å¯èƒ½æœƒä¸çŸ¥é“ä»–åˆ°åº•æ”¹äº†ä»€éº¼ï¼Œåè€ŒæŠŠå°ˆæ¡ˆå¼„å£äº†ã€‚\r\næ“ä½œæ–¹å¼\r\n\r\né–‹å•Ÿç¶²ç«™ ğŸ‘‰ PCCES\r\nå¾Œè™•ç†å·¥å…· V1.0\r\n\r\nä¸Šå‚³ PCCES ç”¢å‡ºçš„ XML æª”æ¡ˆ\r\né¡¯ç¤ºç¸½è¡¨ã€è©³ç´°åƒ¹ç›®è¡¨ã€å–®åƒ¹åˆ†æè¡¨ç›¸é—œåˆ†é \r\næ–¼è©³ç´°åƒ¹ç›®è¡¨åˆ†é å¯ä¸‹è¼‰ CSV æª”æ¡ˆ\r\n\r\nç›¸é—œç•«é¢\r\n\r\n\r\nFig1.ç¸½è¡¨\r\n\r\næœªä¸Šå‚³XMLæ™‚ï¼Œæœƒæé†’éœ€è¦å…ˆè¡Œä¸Šå‚³æ‰èƒ½çœ‹åˆ°åˆ†é \r\n\r\n\r\nFig2.è©³ç´°åƒ¹ç›®è¡¨\r\n\r\næ­¤ç‚ºç›£é€ å ±è¡¨æˆ–æ–½å·¥æ—¥èªŒä¸»è¦å¡«å¯«çš„å…§å®¹ä¾æ“šï¼Œä¸‹è¼‰CSVå¾Œå¯ä»¥å°å…¥åˆ°è‡ªå·±æ’°å¯«çš„å°å·¥å…·\r\n\r\n\r\nFig3.å–®åƒ¹åˆ†æè¡¨\r\n\r\nå¦‚è¦æŸ¥é–±å–®åƒ¹åˆ†æå…§å®¹å¯ä»¥é€²è¡Œé …ç›®æœå°‹ï¼Œå¦‚è¦é¡¯ç¤ºå…¨éƒ¨å‰‡ç•™ç™½\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Python","PCCES"]},{"title":"LINEæ©Ÿå™¨äººè‡ªå‹•å‚™ä»½ç¾¤çµ„ç…§ç‰‡","url":"/posts/3782846762/","content":"å‰è¨€\r\nåœ¨åŸ·è¡Œå·¥ç¨‹æ™‚ï¼Œç¶“å¸¸æœƒç‚ºäº†è¯çµ¡ç›¸é—œäº‹å®œå»ºç«‹LINEç¾¤çµ„ä¾†é€²è¡Œäº¤è«‡ï¼Œé€šå¸¸æ–½å·¥ç…§ç‰‡ä¹Ÿæœƒåœ¨é€™å€‹ç¾¤è£¡é¢é€²è¡Œä¸Šå‚³è®“å¤§å®¶å¯ä»¥ç¢ºèªå…§å®¹ï¼Œä¸Šå‚³ç…§ç‰‡åˆ°LINEç¾¤çµ„çš„æ™‚å€™é™¤äº†ç›´æ¥ä¸Šå‚³å¤–ï¼Œä¹Ÿå¯ä»¥é€éå»ºç«‹ç›¸ç°¿å°‡ç…§ç‰‡æ°¸ä¹…ä¿å­˜ã€‚\r\nåœ¨LINEç¾¤çµ„çš„æª”æ¡ˆæ©Ÿåˆ¶ï¼Œç…§ç‰‡æˆ–æ–‡ä»¶æœƒæœ‰ä¸€å®šæ™‚é–“çš„å­˜æ´»æœŸï¼Œç•¶éäº†å­˜æ´»æœŸä¹‹å¾Œç…§ç‰‡å°±æœƒå‘ˆç¾ç„¡æ³•ä¸‹è¼‰çš„æƒ…å½¢ï¼Œå› æ­¤å°‡ç…§ç‰‡åšä¸€å€‹é¡å¤–å­˜æ”¾çš„å‹•ä½œç®—æ˜¯æ»¿é‡è¦çš„ä¸€å€‹æ‰‹æ®µï¼Œè€Œé€™ä»¶äº‹é™¤äº†ç¹ç‘£ä¹Ÿå¾ˆå¯èƒ½æœƒå› ç‚ºå†æ¬¡è«‹æ±‚ä¸Šå‚³çš„éç¨‹å¤šå­˜äº†ä¸å°‘å¼µé‡è¤‡çš„ç…§ç‰‡ï¼Œè€Œé€™å€‹éƒ¨åˆ†ç›¸ä¿¡å¤§å¤šæ•¸äººéƒ½æ˜¯é€éäººçœ¼ä¾†é€²è¡Œåˆ¤åˆ¥ï¼Œç«çœ¼é‡‘ç›ç”¨ä¹…ä¹Ÿæ˜¯æœƒç´¯çš„ã€‚\r\n\r\nå¸Œæœ›èƒ½å¤ æ‰“é€ ä¸€å€‹ç•¶ç¾¤çµ„å…§åˆ¤å®šåˆ°ç…§ç‰‡è³‡æ–™æ™‚ï¼Œèƒ½å¤ è‡ªå‹•å‚™ä»½åˆ°æŒ‡å®šç¡¬ç¢Ÿä¸¦æ±°é™¤é‡è¤‡ç…§ç‰‡çš„æ©Ÿå™¨äººï¼Œæ¸›å°‘é€™äº›ç‘£äº‹çš„ç™¼ç”Ÿã€‚\r\n\r\nè‡³æ–¼ç…§ç‰‡å¾ŒçºŒè¦é€²è¡Œè™•ç†å°±å¯ä»¥åˆ©ç”¨æ–½å·¥ç…§ç‰‡VBAé€²è¡Œè³‡æ–™æ’åºã€æ‰¹æ¬¡æ”¹åã€å ±è¡¨è¼¸å‡ºã€‚\r\n\r\næ“ä½œç•«é¢\r\n\r\n\r\nFig1.LINEç¾¤çµ„ç•«é¢\r\n\r\n\r\n\r\nFig2.æœ¬åœ°ç«¯å„²å­˜ç•«é¢\r\n\r\nåŸºæœ¬å·¥å…·\r\n\r\nLINEBOT\r\n\r\nMessengerAPI\r\n\r\nngrok\r\n\r\nä¸»è¦æ˜¯ç”¨ä¾†å»ºç«‹httpsé€£ç·šçµ¦LINEBOTçš„webhookä½¿ç”¨\r\n\r\npython\r\n\r\nflask\r\nlinebotsdk\r\n\r\n\r\nç›¸é—œé€£çµ\r\n\r\nLINEBOTåŸºæœ¬å»ºç«‹\r\nngrok\r\næœ¬åœ°ç«¯ä½¿ç”¨ngrok\r\n\r\nå¯¦ä½œé‚è¼¯\r\né å…ˆæº–å‚™å…§å®¹\r\n\r\nå»ºç«‹flaskä¸¦å•Ÿç”¨app\r\nå•Ÿç”¨ngrok\r\nè¤‡è£½å°‡ngrokä¸Šé¢çš„å°å¤–é€£ç·šIP\r\nè²¼åˆ°LINEBOTçš„webhook\r\n\r\nè¨Šæ¯æ¥æ”¶éç¨‹\r\n\r\nLINEBOTåœ¨æ¥å—åˆ°ç¾¤çµ„å…§çš„è¨Šæ¯æ™‚\r\nåˆ¤å®šè¨Šæ¯å±¬æ€§æ˜¯å¦ç‚ºImage\r\nåœ–ç‰‡å…§å®¹æœƒå…ˆæš«æ™‚æ”¾åœ¨LINEæ©Ÿæˆ¿ä¸¦ä¸”ç”Ÿæˆä¸€çµ„token\r\næ”¶åˆ°è¨Šæ¯çš„åŒæ™‚æœƒåŸ·è¡ŒAPI(Webhookæ©Ÿåˆ¶)\r\nAPIä¸­æœƒå°‡è¨Šæ¯åšéæ¿¾ï¼Œè—‰ç”±tokenå–å¾—ç…§ç‰‡åˆ°æœ¬åœ°ç«¯\r\næœ¬åœ°ç«¯è³‡æ–™åº«æœƒè¨˜éŒ„å·²ç¶“å­˜æ”¾çš„ç…§ç‰‡è·ŸImage_hash\r\nåˆ¤å®šæ˜¯å¦æœ‰é‡è¤‡çš„image_hashï¼Œå¦‚æœ‰å‰‡å›å‚³\"åœ–ç‰‡å·²å­˜åœ¨\"\r\né€šéé‡è¤‡æ±°é™¤æ©Ÿåˆ¶éæ¿¾å®Œæˆå¾Œå¯å°‡ç…§ç‰‡å­˜æ”¾åˆ°æŒ‡å®šä½ç½®\r\n\r\nç¨‹å¼ç¢¼\r\nwebhook\r\n\r\napp_local.py\r\n\r\n# å­˜æ”¾åœ¨æœ¬åœ°ç«¯sqlite+æœ¬åœ°ç«¯ç¡¬ç¢Ÿfrom flask import Flask, request, abortfrom linebot import LineBotApi, WebhookHandlerfrom linebot.exceptions import InvalidSignatureErrorfrom linebot.models import MessageEvent, ImageMessage, TextSendMessageimport osimport uuidimport hashlibfrom sql_utils import get_db, save_photo_to_db, is_image_hash_existapp = Flask(__name__)# è¨­å®šä½ çš„ Channel Access Token å’Œ Channel SecretCHANNEL_ACCESS_TOKEN = &#x27;YOUR_CHANNEL_ACCESS_TOKEN&#x27;CHANNEL_SECRET = &#x27;YOUR_CHANNEL_SECRET&#x27;line_bot_api = LineBotApi(CHANNEL_ACCESS_TOKEN)handler = WebhookHandler(CHANNEL_SECRET)PHOTOS_DIR = &#x27;photos&#x27;if not os.path.exists(PHOTOS_DIR):    os.makedirs(PHOTOS_DIR)@app.route(&quot;/callback&quot;, methods=[&#x27;POST&#x27;])def callback():    # ç²å– X-Line-Signature header    signature = request.headers[&#x27;X-Line-Signature&#x27;]        # ç²å–è«‹æ±‚é«”    body = request.get_data(as_text=True)    try:        handler.handle(body, signature)    except InvalidSignatureError:        abort(400)    return &#x27;OK&#x27;@handler.add(MessageEvent, message=ImageMessage)def handle_image_message(event):    # ç²å–åœ–åƒå…§å®¹    message_content = line_bot_api.get_message_content(event.message.id)    image_data = message_content.content    image_hash = calculate_image_hash(image_data)    user_id = event.source.user_id    group_id = event.source.group_id    photo_properties = &#123;&quot;edit&quot;: &quot;false&quot;&#125;    photo_url=None    with next(get_db()) as db:        # æª¢æŸ¥åœ–ç‰‡æ˜¯å¦å·²å­˜åœ¨        if is_image_hash_exist(db, image_hash):            reply_text = &quot;åœ–ç‰‡å·²å­˜åœ¨ï¼Œæœªä¿å­˜ã€‚&quot;        else:            # ä¿å­˜åœ–ç‰‡åˆ°æœ¬åœ°è³‡æ–™å¤¾            file_name = str(uuid.uuid4()) + &#x27;.jpg&#x27;            file_path = os.path.join(PHOTOS_DIR, file_name)            with open(file_path, &#x27;wb&#x27;) as f:                for chunk in message_content.iter_content():                    f.write(chunk)            # ä¿å­˜åœ–ç‰‡åˆ°è³‡æ–™åº«            saved_photo = save_photo_to_db(db, user_id, group_id, file_name, photo_url, photo_properties, image_hash)            print(&quot;Photo saved successfully:&quot;, saved_photo)            reply_text = &quot;åœ–ç‰‡å·²ä¿å­˜åˆ°æœ¬åœ°ç«¯ï¼&quot;    line_bot_api.reply_message(        event.reply_token,        TextSendMessage(text=reply_text)    )def calculate_image_hash(image_data):    hasher = hashlib.sha256()    hasher.update(image_data)    return hasher.hexdigest()@handler.add(MessageEvent)def handle_message(event):    if not isinstance(event.message, ImageMessage):        reply_text = &quot;è«‹å‚³é€åœ–ç‰‡è¨Šæ¯ã€‚&quot;        line_bot_api.reply_message(            event.reply_token,            TextSendMessage(text=reply_text)        )if __name__ == &quot;__main__&quot;:    app.run(host=&quot;0.0.0.0&quot;, port=8000)\r\n\r\nsql_utils.py\r\n\r\nfrom sqlalchemy import create_engine, Column, Integer, String, DateTime, JSONfrom sqlalchemy.orm import sessionmaker,declarative_basefrom datetime import datetimefrom sqlalchemy.orm import SessionDATABASE_URL=&quot;sqlite:///photos.db&quot;engine = create_engine(DATABASE_URL)Base = declarative_base()SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)# å®šç¾©æ•¸æ“šåº«æ¨¡å‹class Photo(Base):    __tablename__ = &#x27;photos_backup&#x27;    id = Column(Integer, primary_key=True, index=True)    user_id = Column(String)    group_id = Column(String)    photo_name = Column(String)    photo_url = Column(String)    photo_thumbnail_url = Column(String)    created_time = Column(DateTime, default=datetime.utcnow)    photo_properties = Column(JSON)    photo_image_hash = Column(String)#, unique=True, nullable=False)Base.metadata.create_all(bind=engine)# ç²å–æ•¸æ“šåº«æœƒè©±def get_db():    db = SessionLocal()    try:        yield db    finally:        db.close()def save_photo_to_db(db, user_id,group_id, photo_name, photo_url, photo_properties,image_hash):    new_photo = Photo(        user_id=user_id,        group_id=group_id,        photo_name=photo_name,        photo_url=photo_url,        photo_properties=photo_properties,        photo_image_hash=image_hash    )    db.add(new_photo)    db.commit()    db.refresh(new_photo)    return new_photodef get_photo_by_id(db: Session, photo_id: int):    return db.query(Photo).filter(Photo.id == photo_id).first()def fetch_all_photos(db: Session):    return db.query(Photo).all()def delete_photo_from_db(db: Session, photo_id: int):    photo = db.query(Photo).filter(Photo.id == photo_id).first()    if photo:        db.delete(photo)        db.commit()        print(f&quot;Photo with ID &#123;photo_id&#125; deleted successfully from database.&quot;)    else:        print(f&quot;No photo found with ID &#123;photo_id&#125;.&quot;)def is_image_hash_exist(db, image_hash):    return db.query(Photo).filter(Photo.photo_image_hash == image_hash).first() is not None\r\nçµèª\r\nå¦‚æœæ‚¨æœ¬èº«åŸ·è¡Œå·¥ç¨‹å°ˆæ¡ˆæ™‚æœ‰å¤§é‡çš„ç…§ç‰‡éœ€è¦é€²è¡Œè‡ªå‹•å‚™ä»½ï¼ŒåŒæ™‚åˆæœ‰ä¸€å°é›»è…¦å¯ä»¥ä¸é—œæ©Ÿç•¶ä½œserverç”¨é€”ï¼Œå¯ä»¥å°‡ä»–å»ºç«‹å¥½pythonåŸ·è¡Œç’°å¢ƒä¸¦åƒè€ƒä¸Šè¿°çš„å…§å®¹æ­é…ä½¿ç”¨ï¼Œå¦‚æœ‰ä¸æ‡‚çš„å…§å®¹ä¹Ÿæ­¡è¿è¯ç¹«ä½œè€…ä¾†å”åŠ©æ¶è¨­LINEç¾¤çµ„æ©Ÿå™¨äººï¼Œè‡ªå‹•å‚™ä»½å·¥ç¨‹ç¾¤çµ„å…§éƒ¨ç…§ç‰‡çœæ™‚åˆçœåŠ›ã€‚\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["flask","LINEBOT"]},{"title":"Streamlitåšæ‰‹ç¹ªç°½å","url":"/posts/213685522/","content":"å‰è¨€\r\nå·¥ç¨‹åŸ·è¡Œéç¨‹å…ä¸äº†æœƒæœ‰å¾ˆå¤šå“ç®¡æ–‡ä»¶éœ€è¦è£½ä½œï¼Œç´™æœ¬æ–‡ä»¶çš„åŠ å€¼æ‡‰ç”¨ç›¸ç•¶å›°é›£ï¼Œé€šå¸¸éƒ½æœƒæ”¾ç½®æ–¼ä¸€å †åˆä¸€å †çš„è³‡æ–™å¤¾ä¸­ï¼Œæœ‰éœ€è¦å†å»ç›¸äº’åƒç…§ï¼Œå¤§å¤šæµæ–¼å½¢å¼ï¼Œå€˜è‹¥å·¥ç¨‹æ–‡ä»¶èƒ½å¤ æ•¸ä½åŒ–ï¼Œå°æ–¼æ•´å€‹å·¥ç¨‹è³‡æ–™çš„ä¿å­˜ã€æŸ¥è©¢æœƒæœ‰å¾ˆå¤šå¥½è™•ï¼Œä½†ç¶“éå¹¾æ¬¡æŸ¥æ ¸å§”å“¡çš„å»ºè­°ï¼Œé—œæ–¼ç°½åé€™ä»¶äº‹æƒ…ä»–å€‘æœ‰æ„è¦‹ï¼Œæ—¢ç„¶æ˜¯éœ€è¦åœ¨ç¾å ´é€²è¡Œæª¢æŸ¥çš„æ–‡ä»¶ï¼Œé‚£ç•¶ç„¶æœƒæ˜¯æ‰‹å¯«çš„æ‰æœ€é¦™ï¼Œæ®Šä¸çŸ¥å¾ˆå¤šå§”å“¡é‚„æ˜¯èªç‚ºé›»è…¦ç›´æ¥å‡ºçš„æ–‡ä»¶ä¸èƒ½ç”¨ï¼Œè‡³å°‘ç°½åçš„éƒ¨åˆ†è¦æ‰‹å¯«æ‰æ˜¯çœŸçš„ã€‚\r\nåŸºæ–¼é€™äº›ç†ç”±ï¼Œæˆ‘å¸Œæœ›èƒ½å¤ åšåˆ°ç”¨æ‰‹å¯«çš„è§¸æ„Ÿå»ç°½ç½²æ–‡ä»¶ï¼Œé€éStreamlitçš„å‰ç«¯åŠstreamlit-drawable-canvasä½œç‚ºç¹ªåœ–å™¨ï¼Œopencvä½œç‚ºèƒŒæ™¯å»èƒŒè™•ç†ï¼ŒåŠPyMuPDFä½œç‚ºè½‰æª”å·¥å…·ï¼Œä¾†é”æˆå§”å“¡çš„è¦æ±‚...\r\nå…¶å¯¦æˆ‘ä¸€ç›´ä¸èƒ½ç†è§£ï¼Œä¸­è¯é›»ä¿¡éƒ½å¯ä»¥ç”¨æ‰‹å¯«çš„è§¸æ§æ¿ä¾†è·Ÿå®¢æˆ¶ç°½ç´„äº†ï¼Œç‚ºä»€éº¼å…¬å…±å·¥ç¨‹ä¸€å®šè¦ç”¨ç´™+ç­†ï¼Œç¾åœ¨å…¶å¯¦å¹³æ¿é›»è…¦éƒ½å¾ˆæ–¹ä¾¿ï¼ŒæŠŠè¦æŠ½æŸ¥çš„PDFéƒ½å…ˆæ”¾å¥½åœ¨é›²ç«¯ï¼Œå¸¶å»å·¥åœ°ç¾å ´é¸å–è¦æŠ½æŸ¥çš„å°æ‡‰PDFå¾Œå¯«ç´€éŒ„è¡¨ï¼Œå¯«å®Œå¾Œå¯ä»¥å³æ™‚ä¸Šå‚³åˆ°é›²ç«¯ï¼Œè³‡è¨Šæµå‹•æ‰æœƒè¿…é€Ÿï¼Œä¹Ÿä¸ç”¨é€™æ¨£æµªè²»ä¸€å †ç´™ä¾†è¨˜éŒ„é€™äº›å…§å®¹ï¼Œæœªä¾†è¦ç¿»é–±å¾é›²ç«¯å»æ’ˆå–å‡ºä¾†å³å¯ã€‚\r\n\r\nğŸ¬å½±ç‰‡æ“ä½œ\r\n\r\n\r\nå®‰è£åŒ…\r\npip install streamlit streamlit-drawable-canvas numpy opencv-python-headless Pillow PyMuPDF\r\nåœ–ç‰‡ç°½åé è¦½\r\nimport streamlit as stfrom streamlit_drawable_canvas import st_canvasimport numpy as npimport cv2from PIL import Image# è¨­ç½® Streamlit ç•Œé¢st.title(&quot;åœ–ç‰‡ç°½åå·¥å…·&quot;)# ä¸Šå‚³åœ–ç‰‡uploaded_file = st.file_uploader(&quot;ä¸Šå‚³åœ–ç‰‡&quot;, type=[&quot;jpg&quot;, &quot;jpeg&quot;, &quot;png&quot;])# ç¹ªè£½ç°½åst.write(&quot;ç¹ªè£½ç°½å&quot;)canvas_result = st_canvas(    fill_color=&quot;rgba(0, 0, 0, 0)&quot;,  # èƒŒæ™¯å¡«å……è‰²    stroke_width=3,    stroke_color=&quot;black&quot;,    background_color=&quot;rgba(255, 255, 255, 0)&quot;,    height=150,    width=400,    drawing_mode=&quot;freedraw&quot;,    key=&quot;canvas&quot;,)if uploaded_file is not None and canvas_result.image_data is not None:    # è®€å–ä¸Šå‚³çš„åœ–ç‰‡    file_bytes = np.asarray(bytearray(uploaded_file.read()), dtype=np.uint8)    uploaded_image = cv2.imdecode(file_bytes, cv2.IMREAD_UNCHANGED)    # ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯    signature_data = canvas_result.image_data    signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)    # å°‡ç°½åå¤§å°èª¿æ•´ç‚ºåˆé©å¤§å°    sig_h, sig_w, _ = signature.shape    img_h, img_w, _ = uploaded_image.shape    x_offset = img_w - sig_w - 10    y_offset = img_h - sig_h - 10    # å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š    for c in range(0, 3):        uploaded_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] = \\            signature[:, :, c] * (signature[:, :, 3] / 255.0) + \\            uploaded_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] * (1.0 - signature[:, :, 3] / 255.0)    # é¡¯ç¤ºåˆä½µå¾Œçš„åœ–ç‰‡    st.image(uploaded_image, caption=&#x27;ç°½åå¾Œçš„åœ–ç‰‡&#x27;, use_column_width=True)\r\nç›´æ¥ç°½åœ¨åœ–ç‰‡ä¸Š\r\nimport streamlit as stfrom streamlit_drawable_canvas import st_canvasimport numpy as npimport cv2from PIL import Imageimport ioimport fitz  # PyMuPDF# è¨­ç½® Streamlit ç•Œé¢st.title(&quot;PDF ç°½åå·¥å…·&quot;)# ä¸Šå‚³ PDFuploaded_file = st.file_uploader(&quot;ä¸Šå‚³ PDF&quot;, type=[&quot;pdf&quot;])# å¦‚æœä¸Šå‚³äº†æ–‡ä»¶if uploaded_file is not None:    # è®€å–ä¸Šå‚³çš„ PDF    pdf_bytes = uploaded_file.read()    document = fitz.open(&quot;pdf&quot;, pdf_bytes)    page = document.load_page(0)    pix = page.get_pixmap()    background_image = Image.frombytes(&quot;RGB&quot;, [pix.width, pix.height], pix.samples)    # st.write(&quot;ç°½åèª¿æ•´&quot;)        # ç¹ªè£½ç°½å    # st.write(&quot;ç¹ªè£½ç°½å&quot;)    canvas_result = st_canvas(        fill_color=&quot;rgba(0, 0, 0, 0)&quot;,  # èƒŒæ™¯å¡«å……è‰²        stroke_width=3,        stroke_color=&quot;black&quot;,        background_image=background_image,        height=pix.height,        width=pix.width,        drawing_mode=&quot;freedraw&quot;,        key=&quot;canvas&quot;,    )    # æ»‘æ¡¿èª¿æ•´ç°½åä½ç½®    # st.write(&quot;èª¿æ•´ç°½åä½ç½®&quot;)    x_offset =0# st.slider(&quot;æ°´å¹³ä½ç½®&quot;, 0, pix.width, 0)    y_offset =0# st.slider(&quot;å‚ç›´ä½ç½®&quot;, 0, pix.height, 0)    if canvas_result.image_data is not None:        # ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯        signature_data = canvas_result.image_data        signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)        signed_images = []        for page_num in range(len(document)):            page = document.load_page(page_num)            pix = page.get_pixmap()            image = Image.frombytes(&quot;RGB&quot;, [pix.width, pix.height], pix.samples)            # å°‡ PIL åœ–åƒè½‰æ›ç‚º OpenCV åœ–åƒ            open_cv_image = np.array(image)            open_cv_image = cv2.cvtColor(open_cv_image, cv2.COLOR_RGB2BGRA)            # ç°½åä½ç½®            sig_h, sig_w, _ = signature.shape            img_h, img_w, _ = open_cv_image.shape            # ç¢ºä¿ç°½åä¸è¶…å‡ºé‚Šç•Œ            if y_offset + sig_h &gt; img_h:                sig_h = img_h - y_offset            if x_offset + sig_w &gt; img_w:                sig_w = img_w - x_offset            # ç°½åå½¢ç‹€åŒ¹é…            resized_signature = cv2.resize(signature, (sig_w, sig_h))            # å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š            for c in range(0, 3):                open_cv_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] = \\                    resized_signature[:, :, c] * (resized_signature[:, :, 3] / 255.0) + \\                    open_cv_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] * (1.0 - resized_signature[:, :, 3] / 255.0)            # å°‡ OpenCV åœ–åƒè½‰æ›å› PIL åœ–åƒ            signed_image = Image.fromarray(cv2.cvtColor(open_cv_image, cv2.COLOR_BGRA2RGBA))            signed_images.append(signed_image)        # é è¦½ç°½åå¾Œçš„ç¬¬ä¸€é         # st.image(signed_images[0], caption=&#x27;ç°½åå¾Œçš„ PDF é é¢é è¦½&#x27;, use_column_width=True)        # å°‡ç°½åå¾Œçš„åœ–åƒä¿å­˜å› PDF        pdf_output = io.BytesIO()        signed_images[0].save(pdf_output, &quot;PDF&quot;, resolution=100.0, save_all=True, append_images=signed_images[1:])        pdf_output.seek(0)        # æä¾›ä¸‹è¼‰éˆæ¥        st.download_button(            label=&quot;ä¸‹è¼‰ç°½åå¾Œçš„ PDF&quot;,            data=pdf_output,            file_name=&quot;signed_document.pdf&quot;,            mime=&quot;application/pdf&quot;        )\r\næ¯”è¼ƒå®Œæ•´åšæ³•\r\nimport streamlit as stfrom streamlit_drawable_canvas import st_canvasimport numpy as npimport cv2from PIL import Imageimport ioimport fitz  # PyMuPDFimport osimport pandas as pdst.set_page_config(    layout=&quot;wide&quot;,)dict_pdf = &#123;    &quot;æ¸¬é‡å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;: &quot;6-27.pdf&quot;,    &quot;åœŸæ–¹å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;: &quot;6-29.pdf&quot;,    &quot;æ¨¡æ¿å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;: &quot;6-30.pdf&quot;,    &quot;é‹¼ç­‹å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;: &quot;6-31.pdf&quot;,    &quot;å…¶ä»–&quot;: &quot;&quot;&#125;st.sidebar.title(&quot;&#x270d; PDF ç°½åå·¥å…·&quot;)# é é¢å°èˆªpage = st.sidebar.selectbox(&quot;é¸æ“‡é é¢&quot;, [&quot;æ‰‹ç¹ªç°½å&quot;, &quot;æŸ¥çœ‹è¡¨å–®&quot;])# æ ¹æ“šé¸æ“‡çš„é é¢é¡¯ç¤ºå…§å®¹if page == &quot;æ‰‹ç¹ªç°½å&quot;:    # è¨­ç½® Streamlit ç•Œé¢    # st.title(&quot;PDF ç°½åå·¥å…·&quot;)    # æŒ‡å®šä¿å­˜çš„æ–‡ä»¶å¤¾è·¯å¾‘    save_folder = &quot;saved_pdfs&quot;    os.makedirs(save_folder, exist_ok=True)    form_selection = st.sidebar.selectbox(&quot;é¸æ“‡æŠ½æŸ¥è¡¨&quot;, list(dict_pdf.keys()))    file_name = &quot;./pdfs/&quot;+dict_pdf[form_selection]    # å¦‚æœé¸æ“‡äº†â€œå…¶ä»–â€ï¼Œè®“ç”¨æˆ¶ä¸Šå‚³ PDF æ–‡ä»¶    if form_selection == &quot;å…¶ä»–&quot;:        uploaded_file = st.file_uploader(&quot;ä¸Šå‚³ PDF&quot;, type=[&quot;pdf&quot;])    else:        # å¦å‰‡ï¼Œè®€å–é å®šç¾©çš„ PDF æ–‡ä»¶        with open(file_name, &quot;rb&quot;) as f:            uploaded_file = f.read()    if uploaded_file:        if form_selection == &quot;å…¶ä»–&quot;:            pdf_bytes = uploaded_file.read()        else:            pdf_bytes = uploaded_file        # è®€å– PDF        document = fitz.open(&quot;pdf&quot;, pdf_bytes)        page = document.load_page(0)        pix = page.get_pixmap(matrix=fitz.Matrix(2.0, 2.0))  # ä½¿ç”¨ matrix èª¿æ•´åˆ†è¾¨ç‡        original_width, original_height = pix.width, pix.height        background_image = Image.frombytes(&quot;RGB&quot;, [pix.width, pix.height], pix.samples)        # ç¹ªè£½ç°½å        canvas_result = st_canvas(            fill_color=&quot;rgba(0, 0, 0, 0)&quot;,  # èƒŒæ™¯å¡«å……è‰²            stroke_width=3,            stroke_color=&quot;black&quot;,            background_image=background_image,            height=pix.height,            width=pix.width,            drawing_mode=&quot;freedraw&quot;,            key=&quot;canvas&quot;,        )        if canvas_result.image_data is not None:            # ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯            signature_data = canvas_result.image_data            signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)            signed_images = []            # è¨­ç½®ç°½åä½ç½® (é è¨­å€¼ï¼Œå¯ä»¥æ ¹æ“šéœ€è¦èª¿æ•´)            y_offset, x_offset = 0,0            for page_num in range(len(document)):                page = document.load_page(page_num)                pix = page.get_pixmap(matrix=fitz.Matrix(2.0, 2.0))  # ä½¿ç”¨ç›¸åŒçš„ matrix èª¿æ•´åˆ†è¾¨ç‡                image = Image.frombytes(&quot;RGB&quot;, [pix.width, pix.height], pix.samples)                # å°‡ PIL åœ–åƒè½‰æ›ç‚º OpenCV åœ–åƒ                open_cv_image = np.array(image)                open_cv_image = cv2.cvtColor(open_cv_image, cv2.COLOR_RGB2BGRA)                # ç°½åä½ç½®                sig_h, sig_w, _ = signature.shape                img_h, img_w, _ = open_cv_image.shape                # èª¿æ•´ç°½åä½ç½®ä»¥åŒ¹é…æ–°çš„è§£æåº¦                adjusted_y_offset = int((y_offset / original_height) * img_h)                adjusted_x_offset = int((x_offset / original_width) * img_w)                # ç¢ºä¿ç°½åä¸è¶…å‡ºé‚Šç•Œ                if adjusted_y_offset + sig_h &gt; img_h:                    sig_h = img_h - adjusted_y_offset                if adjusted_x_offset + sig_w &gt; img_w:                    sig_w = img_w - adjusted_x_offset                # ç°½åå½¢ç‹€åŒ¹é…                resized_signature = cv2.resize(signature, (sig_w, sig_h))                # å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š                for c in range(0, 3):                    open_cv_image[adjusted_y_offset:adjusted_y_offset+sig_h, adjusted_x_offset:adjusted_x_offset+sig_w, c] = \\                        resized_signature[:, :, c] * (resized_signature[:, :, 3] / 255.0) + \\                        open_cv_image[adjusted_y_offset:adjusted_y_offset+sig_h, adjusted_x_offset:adjusted_x_offset+sig_w, c] * (1.0 - resized_signature[:, :, 3] / 255.0)                # å°‡ OpenCV åœ–åƒè½‰æ›å› PIL åœ—åƒ                signed_image = Image.fromarray(cv2.cvtColor(open_cv_image, cv2.COLOR_BGRA2RGBA))                signed_images.append(signed_image)            # å°‡ç°½åå¾Œçš„åœ–åƒä¿å­˜å› PDF            pdf_output = io.BytesIO()            signed_images[0].save(pdf_output, &quot;PDF&quot;, resolution=100.0, save_all=True, append_images=signed_images[1:])            pdf_output.seek(0)            # å¢åŠ â€œå„²å­˜â€æŒ‰éˆ•            if st.button(&quot;å„²å­˜&quot;, type=&#x27;primary&#x27;):                # ç”Ÿæˆä¿å­˜è·¯å¾‘å’Œæ–‡ä»¶å                base_file_name = form_selection if form_selection != &quot;å…¶ä»–&quot; else &quot;custom&quot;                existing_files = [f for f in os.listdir(save_folder) if f.startswith(base_file_name)]                file_count = len(existing_files) + 1                output_file_name = f&quot;&#123;base_file_name&#125;_&#123;file_count&#125;.pdf&quot;                save_path = os.path.join(save_folder, output_file_name)                # å°‡ç°½åå¾Œçš„ PDF æ–‡ä»¶ä¿å­˜åˆ°æŒ‡å®šè³‡æ–™å¤¾                with open(save_path, &quot;wb&quot;) as f:                    f.write(pdf_output.getbuffer())                st.success(f&quot;å·²å°‡ç°½åå¾Œçš„ PDF ä¿å­˜åˆ°: &#123;save_path&#125;&quot;)elif page == &quot;æŸ¥çœ‹è¡¨å–®&quot;:    # æŒ‡å®šä¿å­˜çš„æ–‡ä»¶å¤¾è·¯å¾‘    save_folder = &quot;saved_pdfs&quot;    os.makedirs(save_folder, exist_ok=True)    # ç²å–æ‰€æœ‰å·²ä¿å­˜çš„è¡¨å–®    saved_forms = os.listdir(save_folder)    # æ ¹æ“šæ–‡ä»¶ååˆ†é¡è¡¨å–®    classified_forms = &#123;&#125;    for form in saved_forms:        form_type = form.rsplit(&#x27;_&#x27;, 1)[0]        if form_type not in classified_forms:            classified_forms[form_type] = []        classified_forms[form_type].append(form)    # å°‡åˆ†é¡è¡¨å–®è½‰æ›ç‚º DataFrame    df = pd.DataFrame(        [(key, form) for key, forms in classified_forms.items() for form in forms],        columns=[&quot;è¡¨å–®é¡å‹&quot;, &quot;æ–‡ä»¶å&quot;]    )    # é¡¯ç¤º DataFrame ä¸¦å…è¨±ç”¨æˆ¶é¸æ“‡è¦é¡¯ç¤ºçš„è¡¨å–®    selected_forms = st.multiselect(&quot;é¸æ“‡è¦é¡¯ç¤ºçš„è¡¨å–®&quot;, df[&quot;æ–‡ä»¶å&quot;])    # é¡¯ç¤ºé¸æ“‡çš„è¡¨å–®    if selected_forms:        for form in selected_forms:            form_path = os.path.join(save_folder, form)                        st.markdown(f&quot;####  &#123;form&#125;&quot;)                        # ä½¿ç”¨ PyMuPDF åŠ è¼‰ PDF æ–‡ä»¶            pdf_doc = fitz.open(form_path)                        # é¡¯ç¤ºæ¯ä¸€é çš„åœ–åƒå…§å®¹            for page_num in range(len(pdf_doc)):                page = pdf_doc.load_page(page_num)                                # å°‡ PDF é é¢è½‰æ›ç‚ºåœ–åƒ                pix = page.get_pixmap(matrix=fitz.Matrix(2.0, 2.0))  # ä½¿ç”¨ç›¸åŒçš„ matrix èª¿æ•´åˆ†è¾¨ç‡                img = Image.frombytes(&quot;RGB&quot;, [pix.width, pix.height], pix.samples)                                st.image(img, caption=f&quot;ç¬¬ &#123;page_num + 1&#125; é &quot;)    else:        st.write(&quot;ç›®å‰æ²’æœ‰å·²ä¿å­˜çš„è¡¨å–®ã€‚&quot;)\r\nä»¥å‰åšçš„å°ˆæ¡ˆ\r\nExcel\r\nVBA@ç°½åæª”å°å·¥å…·\r\nå»å¹´æ›¾ç¶“æœ‰æŠŠç°½åæª”åšæˆå¾ˆå¤šä¸åŒç…§ç‰‡ä¾†èª¿æ•´å¤§å°åŠä½ç½®é€²è¡Œè²¼ä¸Šï¼Œä¸éç¶“å»£å¤§ç¶²å‹çš„æª¢è¦–å¾Œï¼Œç™¼ç¾é€™æ¨£å§”å“¡é‚„æ˜¯æœƒä¸å–œæ­¡ï¼Œé‚„æ˜¯å…ˆåšå€‹ç´€éŒ„çµ¦å¤§å®¶åƒè€ƒåƒè€ƒ...\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Streamlit"]},{"title":"Streamlitå·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–","url":"/posts/43562660/","content":"å‰è¨€\r\nå·¥ç¨‹é€²è¡ŒæœŸé–“æœƒæœ‰å¾ˆå¤šä¸åŒçš„ä»»å‹™ï¼Œæ¯å€‹ä»»å‹™æœƒæœ‰è‡ªå·±æ‰€éœ€è¦èŠ±è²»çš„é‡‘é¡ã€èµ·å§‹æ—¥æœŸã€æŒçºŒå¤©æ•¸ï¼Œè—‰ç”±é€™äº›ä»»å‹™çš„çµ„åˆå¯ä»¥çµ±æ•´å‡ºå·¥ç¨‹çš„é å®šé€²åº¦æƒ…æ³ï¼Œå°‡ä¸åŒä»»å‹™ç¹ªè£½åœ¨åŒä¸€å€‹æ™‚é–“è»¸ä¸Šå¯ä»¥æ¸…æ¥šçš„äº†è§£åˆ°ç¾éšæ®µæœ‰é‚£äº›ä»»å‹™æ‡‰è©²è¦è¢«å®Œæˆä»¥åŠæœªä¾†é‚„æœ‰å“ªäº›ä»»å‹™éœ€è¦å®Œæˆï¼Œå°æ–¼ä»»å‹™å–®ç´”çš„å·¥ç¨‹å¾ˆæœ‰å¤§çš„åŠ©ç›Šã€‚\r\nå‰é™£å­åœ¨é–‹ç™¼æ–½å·¥æ—¥èªŒçš„æ™‚å€™ï¼Œå¦‚æœæ¡ç”¨æ–½å·¥è¨ˆç•«æ›¸ä¸Šçš„æ¯15æ—¥ç´¯ç©é€²åº¦åšå…§å·®å–å€¼æœƒæ¯”è¼ƒå®¹æ˜“å¤±çœŸï¼Œå¾Œä¾†æƒ³æƒ³ï¼Œå…¶å¯¦é€™å€‹ç´¯ç©é€²åº¦çš„ä¾†æºä¹Ÿæ˜¯æŒ‰ç…§ç”˜ç‰¹åœ–çš„æ¯”ä¾‹æ‰€å¾—å‡ºçš„çµæœ?ä½†ç¸½æ­¸å¦‚ä½•ï¼Œé‚„æ˜¯èŠ±äº†ä¸€äº›æ™‚é–“ç†Ÿæ‚‰ä¸€ä¸‹matplotlibçš„åšåœ–å¥—ä»¶ï¼Œä¸¦ä¸”æ­é…streamlitå‰ç«¯ä»‹é¢åšä¸€å€‹é›²ç«¯æœå‹™ï¼Œç›®æ¨™æ˜¯å¸Œæœ›èƒ½å¤ ç”¢å‡ºå·¥ç¨‹ç”˜ç‰¹åœ–åŠæ¯æ—¥é€²åº¦çš„CSVæª”æ¡ˆï¼Œæœªä¾†å¯ä»¥åŒ¯å…¥å…¶ä»–çš„æ—¥å ±VBAå·¥å…·ã€‚\r\n\r\næ“ä½œä»‹é¢\r\n\r\n\r\næ“ä½œä»‹é¢\r\n\r\n\r\né€²å…¥ç³»çµ±ä¹‹å¾Œå·¦å´ç‚ºä»»å‹™ç·¨è¼¯å€å¡Šï¼Œå³å´ç‚ºç”˜ç‰¹åœ–\r\nä»»å‹™ç·¨è¼¯å€å¡Šå¯ä»¥é€²è¡Œæ–°å¢ã€åˆªé™¤ã€ç·¨è¼¯\r\næ¯æ¬¡çš„æ›´å‹•éƒ½æœƒé‡æ–°ç”Ÿæˆç”˜ç‰¹åœ–ï¼Œä¸‹è¼‰CSVä¹Ÿæœƒå³æ™‚æ›´æ–°\r\n\r\nå¦‚æœ‰çœ‹ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥é»é¸å½±ç‰‡æ“ä½œæ•™å­¸\r\nç¶²é é€£çµ\r\nğŸ”—\r\nå·¥ç¨‹é€²åº¦V0.1.0 ç¶²é é€£çµ\r\nå®Œæ•´åšæ³•\r\n\r\nGithubä¸Šé¢çš„æ˜¯å·²ç¶“ç²¾æŒ‘ç´°é¸éçš„ç¨‹å¼ç¢¼ï¼Œè£½ä½œæœŸé–“æœ‰é™¸é™¸çºŒçºŒç æ‰ä¸€äº›åŠŸèƒ½ï¼Œå¯ä»¥åƒç…§ä¸‹é¢çš„è¨»è§£è™•ã€‚\r\n\r\nimport streamlit as stimport pandas as pdimport matplotlib.pyplot as pltimport matplotlib.dates as mdatesimport numpy as npfrom matplotlib.font_manager import FontPropertiesimport matplotlib.ticker as tickerfrom io import BytesIOfrom datetime import date### Init ###def main_zh():    SYSTEM_VERSION=&quot;V1.0.0&quot;    # st.set_page_config(layout=&#x27;wide&#x27;)    font_prop = FontProperties(fname=&#x27;./NotoSansCJK-Regular.ttc&#x27;)    # åˆå§‹åŒ–æ•¸æ“šï¼Œå¦‚æœ st.session_state ä¸­æ²’æœ‰å­˜å„²æ•¸æ“š    # btn_sample = st.button(&quot;è¼‰å…¥æ¸¬è©¦æ¡ˆä¾‹&quot;)    if &#x27;data&#x27; not in st.session_state:        # df = pd.DataFrame(columns=[&#x27;é …ç›®åç¨±&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;, &#x27;èµ·å§‹æ—¥æœŸ&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;, &#x27;çµæŸæ—¥æœŸ&#x27;])    #     st.session_state[&#x27;data&#x27;]=[    #         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹A&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,    #         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹B&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,    #         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹C&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;    #         ]    # # st.json(st.session_state)    # if btn_sample:        # data = &#123;        #     &#x27;é …ç›®åç¨±&#x27;: [&#x27;åŸºç¤æ§‹é€ &#x27;, &#x27;çµæ§‹åŠ å›º&#x27;, &#x27;åœ°åŸºå·¥ç¨‹&#x27;, &#x27;å±‹é ‚ä¿®å¾©&#x27;, &#x27;å®¤å…§è£ä¿®&#x27;, &#x27;é›»åŠ›ç³»çµ±å‡ç´š&#x27;, &#x27;æ°´åˆ©è¨­æ–½å»ºè¨­&#x27;, &#x27;é“è·¯æ“´å»º&#x27;, &#x27;ç¶ åŒ–å·¥ç¨‹&#x27;, &#x27;æ¶ˆé˜²å®‰å…¨ç³»çµ±&#x27;],        #     &#x27;èŠ±è²»é‡‘é¡&#x27;: [50000, 120000, 80000, 100000, 60000, 70000, 90000, 110000, 80000, 90000],        #     &#x27;èµ·å§‹æ—¥æœŸ&#x27;: [&#x27;2024-07-01&#x27;, &#x27;2024-07-15&#x27;, &#x27;2024-08-01&#x27;, &#x27;2024-07-01&#x27;, &#x27;2024-07-05&#x27;, &#x27;2024-07-20&#x27;, &#x27;2024-07-25&#x27;, &#x27;2024-08-05&#x27;, &#x27;2024-08-10&#x27;, &#x27;2024-08-15&#x27;],        #     &#x27;æŒçºŒå¤©æ•¸&#x27;: [5, 12, 8, 10, 6, 7, 9, 11, 8, 9],        #     &#x27;çµæŸæ—¥æœŸ&#x27;: [&#x27;&#x27;] * 10        # &#125;        # st.session_state[&#x27;data&#x27;]=[]        sample_data = [        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;åŸºç¤æ§‹é€ &#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 50000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;çµæ§‹åŠ å›º&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 120000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-15&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 12, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;åœ°åŸºå·¥ç¨‹&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 80000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-08-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 8, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;å±‹é ‚ä¿®å¾©&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 100000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 10, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;å®¤å…§è£ä¿®&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 60000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-05&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 6, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é›»åŠ›ç³»çµ±å‡ç´š&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 70000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-20&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 7, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;æ°´åˆ©è¨­æ–½å»ºè¨­&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 90000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-25&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 9, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é“è·¯æ“´å»º&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 110000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-08-05&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 11, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;ç¶ åŒ–å·¥ç¨‹&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 80000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-08-10&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 8, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;æ¶ˆé˜²å®‰å…¨ç³»çµ±&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 90000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-08-15&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 9, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,        ]                # df = pd.DataFrame(data)        # df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] = pd.to_datetime(df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;])        # df[&#x27;çµæŸæ—¥æœŸ&#x27;] = df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] + pd.to_timedelta(df[&#x27;æŒçºŒå¤©æ•¸&#x27;], unit=&#x27;D&#x27;)        # st.session_state.data = df        st.session_state[&#x27;data&#x27;]=sample_data    # for item in st.session_state[&#x27;data&#x27;]:    #     st.write(item)    # å¾ st.session_state ä¸­ç²å– DataFrame    # df = st.session_state.data.dropna(subset=[&#x27;æŒçºŒå¤©æ•¸&#x27;])    col1, col2 = st.columns([1, 2])    with col1:        st.markdown(&quot;### :spiral_calendar_pad: å·¥ç¨‹é€²åº¦ &quot;+SYSTEM_VERSION)        st.info(&quot;ä½œè€…:**HankLin @202407**&quot;)        st.markdown(&quot;---&quot;)        # æ–°å¢æ–¹å¼ï¼Œå›é¥‹åˆ° st.session_state        # with st.form(&quot;C&quot;, True):        #     myitem = st.text_input(&quot;æ–½ä½œé …ç›®:&quot;)        #     mycost = st.number_input(&quot;èŠ±è²»é‡‘é¡:&quot;)        #     mystart_date = st.date_input(&quot;é–‹å§‹æ—¥æœŸ:&quot;)        #     mydays = st.number_input(&quot;æŒçºŒå¤©æ•¸&quot;)        #     # st.json(st.session_state[&#x27;data&#x27;])        #     if st.form_submit_button(&quot;æ–°å¢&quot;):        #         new_item = &#123;        #             # &#x27;é …ç›®ç·¨è™Ÿ&#x27;: max(df[&#x27;é …ç›®ç·¨è™Ÿ&#x27;], default=0) + 1,  # è‡ªå‹•åˆ†é…æ–°çš„é …ç›®ç·¨è™Ÿ        #             &#x27;é …ç›®åç¨±&#x27;: myitem,        #             &#x27;èŠ±è²»é‡‘é¡&#x27;: mycost,        #             &#x27;èµ·å§‹æ—¥æœŸ&#x27;: pd.to_datetime(mystart_date),        #             &#x27;æŒçºŒå¤©æ•¸&#x27;: mydays,        #             &#x27;çµæŸæ—¥æœŸ&#x27;: &quot;&quot;#pd.to_datetime(mystart_date) + pd.to_timedelta(mydays, unit=&#x27;D&#x27;)        #         &#125;        #         # df = pd.concat([df, pd.DataFrame([new_item])], ignore_index=True)        #         # new_items=st.session_state[&#x27;data&#x27;].append(new_item)        #         # st.json(st.session_state[&#x27;data&#x27;])        #         # st.session_state.data = df        #         st.session_state[&#x27;data&#x27;].append(new_item)        #         st.success(&quot;æˆåŠŸæ–°å¢æ–½å·¥é …ç›®ï¼&quot;)        # ç¸½è¡¨ï¼ˆç·¨è¼¯æ–¹å¼ï¼‰ï¼Œå›é¥‹åˆ° st.session_state        st.markdown(&quot;##### \t\t&#x1f447; æ–½å·¥é …ç›®å¡«å¯«&quot;)        # st.json(st.session_state)        df=pd.DataFrame(st.session_state[&#x27;data&#x27;])        # st.write(len(df))                df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] = pd.to_datetime(df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;])        edited_df = st.data_editor(df, use_container_width=True,num_rows=&#x27;dynamic&#x27;,                                column_config=&#123;                                    &quot;èµ·å§‹æ—¥æœŸ&quot;: st.column_config.DateColumn(                                        &quot;èµ·å§‹æ—¥æœŸ&quot;,                                        min_value=date(2024, 1, 1),                                        max_value=date(2030, 1, 1),                                        format=&quot;YYYY-MM-DD&quot;,                                        step=1,                                    )                                &#125;,                                hide_index=True, column_order=(&quot;é …ç›®åç¨±&quot;, &quot;èŠ±è²»é‡‘é¡&quot;, &quot;èµ·å§‹æ—¥æœŸ&quot;, &quot;æŒçºŒå¤©æ•¸&quot;))        edited_df[&#x27;çµæŸæ—¥æœŸ&#x27;] = edited_df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] + pd.to_timedelta(edited_df[&#x27;æŒçºŒå¤©æ•¸&#x27;], unit=&#x27;D&#x27;)        is_show_text=st.toggle(&quot;åœ–å¡Šæ–‡å­—&quot;)    ### è¨ˆç®—æµç¨‹ä»¥ä¸‹éƒ½æ²’å•é¡Œï¼Œå¯ä»¥å…ˆå¼•å…¥session_stateå¾Œé–‹å§‹    # final_df=st.session_state.data    final_df=edited_df    # final_df = edited_df.dropna(subset=[&#x27;æŒçºŒå¤©æ•¸&#x27;])    if len(final_df)==0:        exit()    else:        # è¨ˆç®—æ¯æ—¥è€—è²»æˆæœ¬        total_cost = final_df[&#x27;èŠ±è²»é‡‘é¡&#x27;].sum()        start_date = final_df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;].min()        end_date = final_df[&#x27;çµæŸæ—¥æœŸ&#x27;].max()        date_range = pd.date_range(start=start_date, end=end_date, freq=&#x27;D&#x27;)  # æ¯æ—¥é »ç‡        daily_cost = np.zeros(len(date_range))        for i, row in final_df.iterrows():            cost_per_day = row[&#x27;èŠ±è²»é‡‘é¡&#x27;] / row[&#x27;æŒçºŒå¤©æ•¸&#x27;]            daily_cost[(date_range &gt; row[&#x27;èµ·å§‹æ—¥æœŸ&#x27;]) &amp; (date_range &lt;= row[&#x27;çµæŸæ—¥æœŸ&#x27;])] += cost_per_day        # è¨ˆç®—ç´¯ç©èŠ±è²»é‡‘é¡å’Œæ¯æ—¥é€²åº¦ç™¾åˆ†æ¯”        cumulative_cost = np.cumsum(daily_cost)        daily_progress = (daily_cost / total_cost) * 100        cumulative_progress = (cumulative_cost / total_cost) * 100        csv_data = pd.DataFrame(&#123;            &#x27;æ—¥æœŸ&#x27;: date_range,            &#x27;ç•¶æ—¥è²»ç”¨&#x27;: daily_cost,            &#x27;ç´¯ç©è²»ç”¨&#x27;: cumulative_cost,            &#x27;ç•¶æ—¥é€²åº¦&#x27;: daily_progress,            &#x27;ç´¯ç©é€²åº¦&#x27;: cumulative_progress        &#125;)        # st.dataframe(csv_data)    with col2:        # plt.xticks(rotation=45)        fig, ax1 = plt.subplots(figsize=(14, 10))        # ax1=plt.xticks(rotation=45)        # ç•«ç”˜ç‰¹åœ–ï¼Œèª¿æ•´é¡è‰²å’Œé€æ˜åº¦ï¼ŒåŠ å…¥æ ¼ç·š        colors = plt.cm.Set3.colors  # ä½¿ç”¨å–®ä¸€è‰²ç³»        # st.json(final_df.to_json())        cnt=0        for i, row in final_df.iterrows():            if not pd.isna(row[&quot;æŒçºŒå¤©æ•¸&quot;]):                color = colors[i % len(colors)]                ax1.barh(row[&#x27;é …ç›®åç¨±&#x27;], row[&#x27;æŒçºŒå¤©æ•¸&#x27;], left=row[&#x27;èµ·å§‹æ—¥æœŸ&#x27;], height=0.3, color=color)                if is_show_text==True:                    ax1.text(row[&#x27;èµ·å§‹æ—¥æœŸ&#x27;], cnt, f&quot;&#123;row[&#x27;é …ç›®åç¨±&#x27;]&#125;: &#123;int(row[&#x27;æŒçºŒå¤©æ•¸&#x27;])&#125;å¤©&quot;, color=&#x27;black&#x27;, verticalalignment=&#x27;center&#x27;, fontsize=10, fontproperties=font_prop)                cnt=cnt+1        # è¨­ç½®æ¨™ç±¤å’Œæ¨™é¡Œ        ax1.set_xlabel(&#x27;æ—¥æœŸ&#x27;, fontproperties=font_prop)        ax1.set_title(&#x27;æ–½å·¥é€²åº¦ç”˜ç‰¹åœ–&#x27;, fontproperties=font_prop)        for label in ax1.get_yticklabels():            label.set_fontproperties(font_prop)        # åœ¨åŒä¸€å¼µåœ–ä¸Šç¹ªè£½æ¯æ—¥ç´¯ç©é€²åº¦åœ–ä¸¦æ¨™ç¤ºç¯€é»ç™¾åˆ†æ¯”        ax2 = ax1.twinx()        ax2.plot(date_range, cumulative_progress, marker=&#x27;o&#x27;, linestyle=&#x27;-&#x27;, color=&#x27;orange&#x27;)        for i, txt in enumerate(cumulative_progress):            if i % 5== 0 or txt==100:  # æ¯10%æ¨™ç¤ºä¸€æ¬¡                ax2.annotate(f&#x27;&#123;int(txt)&#125;%&#x27;, (date_range[i], cumulative_progress[i]), textcoords=&quot;offset points&quot;, xytext=(0,10), ha=&#x27;center&#x27;, fontproperties=font_prop)        ax2.set_ylabel(&#x27;ç´¯ç©é€²åº¦ç™¾åˆ†æ¯” (%)&#x27;, fontproperties=font_prop)        ax2.yaxis.set_major_locator(ticker.MultipleLocator(base=10))        # èª¿æ•´ x è»¸æ—¥æœŸé¡¯ç¤ºç‚ºæ¯åŠå€‹æœˆ        ax1.xaxis.set_major_locator(mdates.DayLocator(interval=10))  # æ¯10é¡¯ç¤ºä¸€æ¬¡æ—¥æœŸ        ax1.xaxis.set_minor_locator(mdates.DayLocator(interval=1))  # æ¯å¤©éƒ½é¡¯ç¤ºæ—¥æœŸ        ax1.xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y-%m-%d&#x27;))        # æ·»åŠ ç¶²æ ¼ç·š        ax2.grid(True, which=&#x27;both&#x27;, linestyle=&#x27;:&#x27;, linewidth=0.5)        # æ·»åŠ åœ–ä¾‹ï¼Œå°‡ä½ç½®èª¿æ•´åˆ°å³ä¸‹è§’        # ax1.legend([&#x27;å·¥ç¨‹é …ç›®&#x27;], loc=&#x27;upper left&#x27;, prop=font_prop)        ax2.legend([&#x27;ç´¯ç©é€²åº¦&#x27;], loc=&#x27;lower right&#x27;, prop=font_prop)        # èª¿æ•´åœ–å½¢æ’ç‰ˆ        fig.tight_layout()        ax1.set_xlim(start_date - pd.Timedelta(days=3), end_date + pd.Timedelta(days=3))        # é¡¯ç¤ºåœ–å½¢        st.pyplot(fig)    # ä¸‹è¼‰ CSV æŒ‰éˆ•    csv_data = pd.DataFrame(&#123;        &#x27;date&#x27;: date_range,        &#x27;progress(%)&#x27;: daily_progress/100,        &#x27;sum_progress(%)&#x27;: cumulative_progress/100    &#125;)    csv_data[&#x27;date&#x27;] = csv_data[&#x27;date&#x27;].dt.strftime(&#x27;%Y-%m-%d&#x27;)  # å°‡æ—¥æœŸè½‰æ›ç‚ºå­—ä¸²æ ¼å¼    csv_string = csv_data.to_csv(index=False, encoding=&#x27;utf-8-sig&#x27;)    # æä¾›ä¸‹è¼‰æŒ‰éˆ•    with col1:        st.download_button(            label=&quot;ä¸‹è¼‰ CSV æª”æ¡ˆ&quot;,            data=csv_string,            file_name=&#x27;progress_data.csv&#x27;,            mime=&#x27;text/csv&#x27;        )# def main_eng():#     ### Initialization ####     SYSTEM_VERSION = &quot;V1.0.0&quot;#     font_prop = FontProperties(fname=&#x27;./NotoSansCJK-Regular.ttc&#x27;)#     # Initialize data if not stored in st.session_state#     if &#x27;data&#x27; not in st.session_state:#         sample_data = [#             &#123;&#x27;project_name&#x27;: &#x27;Foundation Construction&#x27;, &#x27;cost&#x27;: 50000, &#x27;start_date&#x27;: &#x27;2024-07-01&#x27;, &#x27;duration_days&#x27;: 5, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Structural Reinforcement&#x27;, &#x27;cost&#x27;: 120000, &#x27;start_date&#x27;: &#x27;2024-07-15&#x27;, &#x27;duration_days&#x27;: 12, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Foundation Engineering&#x27;, &#x27;cost&#x27;: 80000, &#x27;start_date&#x27;: &#x27;2024-08-01&#x27;, &#x27;duration_days&#x27;: 8, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Roof Repair&#x27;, &#x27;cost&#x27;: 100000, &#x27;start_date&#x27;: &#x27;2024-07-01&#x27;, &#x27;duration_days&#x27;: 10, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Interior Decoration&#x27;, &#x27;cost&#x27;: 60000, &#x27;start_date&#x27;: &#x27;2024-07-05&#x27;, &#x27;duration_days&#x27;: 6, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Power System Upgrade&#x27;, &#x27;cost&#x27;: 70000, &#x27;start_date&#x27;: &#x27;2024-07-20&#x27;, &#x27;duration_days&#x27;: 7, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Water Facilities Construction&#x27;, &#x27;cost&#x27;: 90000, &#x27;start_date&#x27;: &#x27;2024-07-25&#x27;, &#x27;duration_days&#x27;: 9, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Road Expansion&#x27;, &#x27;cost&#x27;: 110000, &#x27;start_date&#x27;: &#x27;2024-08-05&#x27;, &#x27;duration_days&#x27;: 11, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Greening Project&#x27;, &#x27;cost&#x27;: 80000, &#x27;start_date&#x27;: &#x27;2024-08-10&#x27;, &#x27;duration_days&#x27;: 8, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#             &#123;&#x27;project_name&#x27;: &#x27;Fire Safety System&#x27;, &#x27;cost&#x27;: 90000, &#x27;start_date&#x27;: &#x27;2024-08-15&#x27;, &#x27;duration_days&#x27;: 9, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,#         ]        #         st.session_state[&#x27;data&#x27;] = sample_data#     # Display UI#     col1, col2 = st.columns([1, 2])#     with col1:#         st.markdown(&quot;### :spiral_calendar_pad: Project Progress &quot; + SYSTEM_VERSION)#         st.info(&quot;Author: **HankLin @202407**&quot;)#         st.markdown(&quot;---&quot;)#         st.markdown(&quot;##### &#x1f447; Edit Construction Projects&quot;)#         df = pd.DataFrame(st.session_state[&#x27;data&#x27;])#         edited_df = st.data_editor(df, use_container_width=True, num_rows=&#x27;dynamic&#x27;,#                                 column_config=&#123;#                                     &quot;start_date&quot;: st.column_config.DateColumn(#                                         &quot;Start Date&quot;,#                                         min_value=date(2024, 1, 1),#                                         max_value=date(2030, 1, 1),#                                         format=&quot;YYYY-MM-DD&quot;,#                                         step=1,#                                     )#                                 &#125;,#                                 hide_index=True, column_order=(&quot;project_name&quot;, &quot;cost&quot;, &quot;start_date&quot;, &quot;duration_days&quot;))#         edited_df[&#x27;end_date&#x27;] = edited_df[&#x27;start_date&#x27;] + pd.to_timedelta(edited_df[&#x27;duration_days&#x27;], unit=&#x27;D&#x27;)#         is_show_text = st.toggle(&quot;Show Block Text&quot;)#     with col2:#         fig, ax1 = plt.subplots(figsize=(14, 10))#         colors = plt.cm.Set3.colors#         cnt = 0#         for i, row in edited_df.iterrows():#             if not pd.isna(row[&quot;duration_days&quot;]):#                 color = colors[i % len(colors)]#                 ax1.barh(row[&#x27;project_name&#x27;], row[&#x27;duration_days&#x27;], left=row[&#x27;start_date&#x27;], height=0.3, color=color)#                 if is_show_text:#                     ax1.text(row[&#x27;start_date&#x27;], cnt, f&quot;&#123;row[&#x27;project_name&#x27;]&#125;: &#123;int(row[&#x27;duration_days&#x27;])&#125; days&quot;, color=&#x27;black&#x27;, verticalalignment=&#x27;center&#x27;, fontsize=10, fontproperties=font_prop)#                 cnt += 1#         ax1.set_xlabel(&#x27;Date&#x27;, fontproperties=font_prop)#         ax1.set_title(&#x27;Construction Progress Gantt Chart&#x27;, fontproperties=font_prop)#         for label in ax1.get_yticklabels():#             label.set_fontproperties(font_prop)#         ax2 = ax1.twinx()#         ax2.plot(date_range, cumulative_progress, marker=&#x27;o&#x27;, linestyle=&#x27;-&#x27;, color=&#x27;orange&#x27;)#         for i, txt in enumerate(cumulative_progress):#             if i % 5 == 0 or txt == 100:#                 ax2.annotate(f&#x27;&#123;int(txt)&#125;%&#x27;, (date_range[i], cumulative_progress[i]), textcoords=&quot;offset points&quot;, xytext=(0, 10), ha=&#x27;center&#x27;, fontproperties=font_prop)#         ax2.set_ylabel(&#x27;Cumulative Progress (%)&#x27;, fontproperties=font_prop)#         ax2.yaxis.set_major_locator(ticker.MultipleLocator(base=10))#         ax1.xaxis.set_major_locator(mdates.DayLocator(interval=10))#         ax1.xaxis.set_minor_locator(mdates.DayLocator(interval=1))#         ax1.xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y-%m-%d&#x27;))#         ax2.grid(True, which=&#x27;both&#x27;, linestyle=&#x27;:&#x27;, linewidth=0.5)#         ax2.legend([&#x27;Cumulative Progress&#x27;], loc=&#x27;lower right&#x27;, prop=font_prop)#         fig.tight_layout()#         ax1.set_xlim(start_date - pd.Timedelta(days=3), end_date + pd.Timedelta(days=3))#         st.pyplot(fig)#     # Download CSV button#     csv_data = pd.DataFrame(&#123;#         &#x27;date&#x27;: date_range,#         &#x27;progress(%)&#x27;: daily_progress/100,#         &#x27;sum_progress(%)&#x27;: cumulative_progress/100#     &#125;)#     csv_data[&#x27;date&#x27;] = csv_data[&#x27;date&#x27;].dt.strftime(&#x27;%Y-%m-%d&#x27;)#     csv_string = csv_data.to_csv(index=False, encoding=&#x27;utf-8-sig&#x27;)#     with col1:#         st.download_button(#             label=&quot;Download CSV File&quot;,#             data=csv_string,#             file_name=&#x27;progress_data.csv&#x27;,#             mime=&#x27;text/csv&#x27;#         )if __name__ == &quot;__main__&quot;:        st.set_page_config(layout=&#x27;wide&#x27;)    # language_check=st.checkbox(&quot;English&quot;)    # if language_check==True:        # main_eng()    # else:    main_zh()\r\né–‹ç™¼éç¨‹ç´€éŒ„\r\n\r\nåœ¨dataframeä¸­è™•ç†æ—¥æœŸè¦æŠŠå­—ä¸²é¡å‹çš„æ—¥æœŸé€é'pd.to_datetime'è½‰å‹æ‰èƒ½ç”¨\r\nä¸­æ–‡é¡¯ç¤ºæœƒæœ‰å•é¡Œçš„åœ°æ–¹è¦å…ˆä¸‹è¼‰å¥½å­—å‹æª”è®“'fontproperties'å¼•ç”¨\r\nç”˜ç‰¹åœ–èˆ‡ç´¯ç©é€²åº¦åœ–è¦äº¤ç–Šåœ¨åŒä¸€å¼µåœ–è¦é€é'ax2=ax1.twinx()'æ‰èƒ½é€£ä¸€èµ·\r\nèª¿æ•´Xè»¸åº§æ¨™é¡¯ç¤ºæ™‚ï¼Œå¯ä»¥ç”¨'ax1.set_xlim(start_date -\r\npd.Timedelta(days=3), end_date +\r\npd.Timedelta(days=3))'ä¾†å°‡å‰å¾Œå„å¾€å¤–æ“´ä¸€äº›\r\n\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Streamlit"]},{"title":"Streamlitå»ºç½®GoogleSheetç°¡æ˜“è³‡æ–™åº«","url":"/posts/639809757/","content":"ğŸ™Œå‰è¨€\r\nStreamlitæ˜¯ä½¿ç”¨pythonèªè¨€çš„å‰ç«¯å¥—ä»¶ï¼Œä»–æœ€å¤§çš„å¥½è™•æ˜¯å°±èƒ½é€éå¥—ä»¶æœ¬èº«ç¨‹å¼ç¢¼ç”Ÿæˆä¸€ç¯‡ç¯‡é‚„ç®—èƒ½çœ‹çš„ä½¿ç”¨è€…ä»‹é¢ï¼Œå°æ–¼Htmlã€CSSã€Javascriptç­‰å‰ç«¯èªè¨€æ„Ÿåˆ°ä¸èˆ’æœçš„é–‹ç™¼è€…å¯ä»¥å¦¥å–„åˆ©ç”¨ï¼Œåœ¨éƒ¨ç½²ä¸Šé›£åº¦ä¹Ÿä¸é«˜ï¼Œå¹¾ä¹å¯ä»¥ä¸€éµé”æˆã€‚\r\né™¤äº†pythonæœ¬èº«å…§éµå·²ç¶“æœ‰æœ¬åœ°ç«¯sqliteå¯ä»¥é€²è¡Œè³‡æ–™å­˜å„²ï¼Œå¦‚æœè³‡æ–™éœ€è¦ä¸Šé›²çš„è©±å°±æœƒéœ€è¦é¡å¤–æ‰¾å°‹é›²ç«¯è³‡æ–™åº«ä¾†é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œæ¨™æº–çš„é—œè¯å¼æœ‰MySQLã€postgreSQLã€SQLserverç­‰ç­‰æ¯”è¼ƒå¸¸è¦‹çš„å·¥å…·ã€éé—œè¯å¼è³‡æ–™åº«å‰‡å¯ä»¥é€émongoDBã€firestoreç­‰ç­‰å·¥å…·é€²è¡ŒæŒ‘é¸ã€‚\r\n\r\næœ¬ç¯‡è¦ä»‹ç´¹çš„å…§å®¹æ˜¯é‡å°æ¯”è¼ƒç°¡æ˜“çš„å‰ç«¯ä»‹é¢ï¼Œå¯ä»¥ç”¨Googleæä¾›çš„GoogleSheetä¾†é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œä¸¦ä¸”é€éGoogleAppScriptsä¾†åšå¾Œç«¯èªè¨€é€²è¡Œæ“ä½œã€‚\r\n\r\n\r\nåŸºæœ¬APIæ¦‚å¿µ\r\næ‰€è¬‚å‰ç«¯èˆ‡å¾Œç«¯åˆ†é›¢é–‹ç™¼ï¼Œå°±æ˜¯é€éAPIçš„æ–¹å¼é€²è¡Œè³‡æ–™äº¤æ›ï¼ŒAPIå°±æ˜¯ä¸€ä¸²ç¶²å€(URL)å¤–åŠ ä¸€äº›å¤¾å¸¶çš„åƒæ•¸ï¼Œåƒæ•¸å¯ä»¥æ˜¯ç´”æ–‡å­—ã€ä¹Ÿå¯ä»¥æ˜¯ç‰©ä»¶ï¼Œç„¶è€Œç‰©ä»¶çš„éƒ¨åˆ†åˆå¯åˆ†ç‚ºXMLæˆ–JSONï¼Œé€™å…©é …æ˜¯æœ€å¸¸è¢«æ‹¿ä¾†ä½¿ç”¨æ–¼APIçš„è³‡æ–™äº¤æ›ï¼ŒåŒ…å«è¼¸å…¥åˆ°å¾Œç«¯å­˜æ”¾è³‡æ–™æˆ–è€…æ˜¯å¾è³‡æ–™åº«å–å‡ºè³‡æ–™åˆ°å‰ç«¯é€²è¡Œæ¸²æŸ“ã€‚\r\nå…¬å…±å·¥ç¨‹å¸¸ç”¨çš„ä¼°åƒ¹ç³»çµ±(PCCES)ä¾¿æ˜¯ä»¥XMLé€²è¡Œè³‡æ–™äº¤æ›ï¼Œè©³æƒ…å¯è¦‹ExcelVBA@PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†ï¼Œåœ¨æ­¤ä¸å¤šåšèªªæ˜\r\nJSON\r\nå¤§å¤šæ•¸çš„ç¬¬ä¸‰æ–¹APIéƒ½æ˜¯æ¡ç”¨JSONæ ¼å¼é€²è¡Œå‚³è¼¸ï¼Œé€™ä¹Ÿæ˜¯æœ¬ç¯‡ä¸»è¦è³‡æ–™æ ¼å¼ï¼Œé—œæ–¼JSONçš„æ ¼å¼é€šå¸¸æ˜¯ä»¥éµ-å€¼å°çš„æ–¹å¼å„²å­˜ï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„key-valueï¼Œè¦é€²è¡Œè³‡æ–™å–ç”¨æˆ–çµ„è£æ™‚ç‰¹åˆ¥çš„æ–¹ä¾¿ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æœƒé¸ç”¨ä»–ä¾†åšç‚ºæˆ‘åœ¨streamlitåŠGASä¸­çš„äº¤æ›åª’ä»‹ã€‚\r\nJSONè³‡æ–™å¯ä»¥åˆ†ç‚ºGASå°è±¡ã€JSONå­—ä¸²ã€pythonå°è±¡ï¼Œæ¯å€‹è³‡æ–™éƒ½å¯ä»¥äº’ç›¸è½‰ç§»ï¼ŒJSONå­—ä¸²ä¸»è¦æ˜¯åœ¨APIä¸­æ‰€å¤¾å¸¶çš„å­—ä¸²ï¼Œå…¶é¤˜pythonå°è±¡ã€GASå°è±¡å‰‡æ˜¯ä¾ç…§ä¸åŒèªè¨€è§£ææˆç›¸å°æ‡‰çš„ç‰©ä»¶ã€‚\r\nè¬ä¸€é‡è¦‹è™•ç†å¤šå·¢éšå±¤çš„éç¨‹å¯ä»¥è—‰ç”±æ‰å¹³åŒ–(å°‡å·¢ç‹€éµå€¼å°è™•ç†åˆ°é ‚å±¤)çš„æ–¹æ³•æ–¹ä¾¿è³‡æ–™å–ç”¨ï¼Œä¹Ÿå¯ä»¥é€éåæ‰å¹³åŒ–çš„æ–¹æ³•å°‡åŸæœ¬çš„è³‡æ–™æ¢å¾©åŸç‹€ã€‚\r\nåœ¨GASä¸­é—œæ–¼JSONæ ¼å¼çš„è½‰æ›\r\nJSON.parse()\r\nJSON.parse() æ–¹æ³•ç”¨æ–¼å°‡ JSON å­—ä¸²è§£æç‚º JavaScript\r\nç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹åˆæ³•çš„ JSON å­—ä¸²ä¸¦è¿”å›è§£æå¾Œçš„ JavaScript å€¼ã€‚\r\nJSON.stringify()\r\nJSON.stringify() æ–¹æ³•ç”¨æ–¼å°‡ JavaScript ç‰©ä»¶è½‰æ›ç‚º JSON\r\nå­—ä¸²ã€‚å®ƒæ¥å—ä¸€å€‹ JavaScript ç‰©ä»¶ä¸¦è¿”å›ç›¸æ‡‰çš„ JSON æ ¼å¼å­—ä¸²ã€‚\r\nåœ¨Pythonä¸­é—œæ–¼JSONæ ¼å¼çš„è½‰æ›\r\njson.dumps()\r\njson.dumps() æ–¹æ³•ç”¨æ–¼å°‡ Python ç‰©ä»¶è½‰æ›ç‚º JSON\r\nå­—ä¸²ã€‚å®ƒæ¥å—ä¸€å€‹ Python ç‰©ä»¶ä¸¦è¿”å›ç›¸æ‡‰çš„ JSON æ ¼å¼å­—ä¸²ã€‚\r\njson.loads()\r\njson.loads() æ–¹æ³•ç”¨æ–¼å°‡ JSON å­—ä¸²è§£æç‚º Python\r\nç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹åˆæ³•çš„ JSON å­—ä¸²ä¸¦è¿”å›è§£æå¾Œçš„ Python å€¼ã€‚\r\njson.load()&gt;ç›®å‰æ²’ç”¨åˆ°\r\njson.load() æ–¹æ³•ç”¨æ–¼å¾æª”æ¡ˆä¸­è®€å– JSON è³‡æ–™ä¸¦å°‡å…¶è§£æç‚º\r\nPython ç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹å¯è®€å–çš„æª”æ¡ˆç‰©ä»¶ï¼Œä¸¦è¿”å›è§£æå¾Œçš„ Python å€¼ã€‚\r\nPythonå°è±¡æ“ä½œ\r\nå–®å±¤\r\ndata = json.loads(json_str)# å­˜å–ä¸€å±¤çµæ§‹name = data[&#x27;person&#x27;][&#x27;name&#x27;]age = data[&#x27;person&#x27;][&#x27;age&#x27;]# å­˜å–å¤šå±¤çµæ§‹city = data[&#x27;person&#x27;][&#x27;address&#x27;][&#x27;city&#x27;]zipcode = data[&#x27;person&#x27;][&#x27;address&#x27;][&#x27;zipcode&#x27;]print(name)     # Output: Johnprint(age)      # Output: 30print(city)     # Output: New Yorkprint(zipcode)  # Output: 10001\r\nå¤šå±¤\r\nimport jsonjson_str = &#x27;&#x27;&#x27;&#123;  &quot;person&quot;: &#123;    &quot;name&quot;: &quot;John&quot;,    &quot;age&quot;: 30,    &quot;address&quot;: &#123;      &quot;city&quot;: &quot;New York&quot;,      &quot;zipcode&quot;: &quot;10001&quot;    &#125;  &#125;&#125;&#x27;&#x27;&#x27;def process_json(data):    if isinstance(data, dict):        for key, value in data.items():            print(f&#x27;Key: &#123;key&#125;, Value: &#123;value&#125;&#x27;)            process_json(value)  # éè¿´è™•ç†å€¼    elif isinstance(data, list):        for item in data:            process_json(item)  # éè¿´è™•ç†åˆ—è¡¨ä¸­çš„å…ƒç´ data = json.loads(json_str)process_json(data)\r\nGASå°è±¡æ“ä½œ\r\nvar obj = &#123;name: &quot;John&quot;, age: 30&#125;;var jsonString = JSON.stringify(obj);//å–å€¼var name = obj.name;var age = obj[&#x27;age&#x27;];//è¨­ç½®obj.name = &#x27;Alice&#x27;;obj[&#x27;age&#x27;] = 25;//å¾ªç’°for (var key in obj) &#123;    if (obj.hasOwnProperty(key)) &#123;        Logger.log(key + &#x27;: &#x27; + obj[key]);    &#125;&#125;\r\nç¶œåˆæ“ä½œ\r\nstreamlit\r\nimport streamlit as stimport jsonfrom datetime import date, datetimeimport requests# æ¨¡æ‹Ÿä¸€äº› session state æ•°æ®st.session_state.current_page = &quot;render_page0&quot;st.session_state.submitted = Falsest.session_state.costs = &#123;    &quot;open_channel&quot;: &#123;&quot;name&quot;: &quot;æ¸ é“å·¥ç¨‹&quot;, &quot;unit_cost&quot;: 0, &quot;length&quot;: 0, &quot;total_cost&quot;: 0&#125;,    &quot;bridge&quot;: &#123;&quot;name&quot;: &quot;ç‰ˆæ©‹å·¥ç¨‹&quot;, &quot;unit_cost&quot;: 0, &quot;quantity&quot;: 0, &quot;total_cost&quot;: 0&#125;,    &quot;wall&quot;: &#123;&quot;name&quot;: &quot;æ“‹åœŸç‰†&quot;, &quot;unit_cost&quot;: 0, &quot;length&quot;: 0, &quot;total_cost&quot;: 0&#125;,    &quot;road&quot;: &#123;&quot;name&quot;: &quot;é“è·¯å·¥ç¨‹&quot;, &quot;unit_cost&quot;: 0, &quot;quantity&quot;: 0, &quot;total_cost&quot;: 0&#125;,    &quot;falsework&quot;: &#123;&quot;name&quot;: &quot;ç‰ˆæ¨å·¥ç¨‹&quot;, &quot;unit_cost&quot;: 0, &quot;quantity&quot;: 0, &quot;total_cost&quot;: 0&#125;,&#125;st.session_state.totalcost = 0st.session_state.inf = &#123;    &quot;work_place&quot;: &quot;&quot;,    &quot;work_place2&quot;: &quot;&quot;,    &quot;work_station&quot;: &quot;&quot;,    &quot;work_name&quot;: &quot;&quot;,    &quot;work_benefit&quot;: &quot;&quot;,    &quot;work_place_detail&quot;: &quot;&quot;,    &quot;work_water_check&quot;: False,    &quot;work_start_date&quot;: date.today(),    &quot;work_end_date&quot;: date.today(),&#125;# è‡ªå®šä¹‰ JSON åºåˆ—åŒ–å™¨ï¼Œç”¨äºå¤„ç†æ—¥æœŸå­—æ®µclass DateTimeEncoder(json.JSONEncoder):    def default(self, obj):        if isinstance(obj, (datetime, date)):            return obj.isoformat()        return super().default(obj)# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå°† st.session_state è½¬æ¢ä¸º JSONdef session_state_to_json():    selected_fields = [&quot;costs&quot;, &quot;inf&quot;] # æŒ‡å®šéœ€è¦è½¬æ¢çš„å­—æ®µ    session_state_dict = &#123;key: value for key, value in st.session_state.items()if key in selected_fields&#125;    json_data = json.dumps(session_state_dict, cls=DateTimeEncoder)    return json_data# ä½¿ç”¨å‡½æ•°å¹¶å±•ç¤ºç»“æœjson_result = session_state_to_json()st.write(st.session_state)st.write(json_result)if st.button(&quot;Submit&quot;):    # è¨­ç½® Google Apps Script Web æ‡‰ç”¨ç¨‹å¼çš„ URL    url = &quot;your_gas_url&quot;    # ç™¼é€ POST è«‹æ±‚ä¸¦å‚³é JSON è³‡æ–™    response = requests.post(url, data=json_result)    # æª¢æŸ¥è«‹æ±‚æ˜¯å¦æˆåŠŸ    if response.status_code == 200:        st.write(&quot;Request successful!&quot;)    else:        st.write(&quot;Error:&quot;, response.status_code)\r\nGAS\r\n// å®šä¹‰Google Sheetsçš„IDconst SHEET_ID = &#x27;your_sheet_id&#x27;; // æ›¿æ¢ä¸ºæ‚¨çš„Google Sheets IDfunction doPost(e) &#123;  // ä» POST è¯·æ±‚ä¸­è·å– JSON å­—ç¬¦ä¸²  var jsonString = e.postData.contents;    // è§£æ JSON å­—ç¬¦ä¸²ä¸ºå¯¹è±¡  var dataOrigin = JSON.parse(jsonString);    var data = flattenObject(dataOrigin);  // è·å–æ´»åŠ¨å·¥ä½œè¡¨  var ss = SpreadsheetApp.openById(SHEET_ID);  var sheet = ss.getActiveSheet();    // è·å–æœ€åä¸€è¡Œï¼Œä»¥ä¾¿åœ¨æœ«å°¾æ·»åŠ æ–°æ•°æ®  var lastRow = sheet.getLastRow();    // å°†æ•°æ®å†™å…¥å·¥ä½œè¡¨çš„ä¸‹ä¸€è¡Œ  for (var key in data) &#123;    var columnIndex = getColumnIndex(sheet, key);    if (columnIndex === -1) &#123; // å¦‚æœåˆ—ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°åˆ—      columnIndex = sheet.getLastColumn() + 1;      sheet.getRange(1, columnIndex).setValue(key);    &#125;    if (lastRow===0 )&#123;      sheet.getRange(lastRow + 2, columnIndex).setValue(data[key]);    &#125;else&#123;      sheet.getRange(lastRow + 1, columnIndex).setValue(data[key]);    &#125;  &#125;    // è¿”å›å›åº”ç»™å®¢æˆ·ç«¯ï¼Œè¿™æ˜¯å¯é€‰çš„  return ContentService.createTextOutput(&#x27;Success&#x27;).setMimeType(ContentService.MimeType.TEXT);&#125;// è·å–åˆ—çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1function getColumnIndex(sheet, columnName) &#123;  var maxColumns = sheet.getMaxColumns(); // è·å–å·¥ä½œè¡¨çš„æœ€å¤§åˆ—æ•°  if (maxColumns &lt; 1) &#123;    return -1; // å¦‚æœæ²¡æœ‰åˆ—å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å› -1  &#125;  var headersRange = sheet.getRange(1, 1, 1, maxColumns);  var headersValues = headersRange.getValues()[0]; // åªè·å–ç¬¬ä¸€è¡Œæ•°æ®  for (var i = 0; i &lt; headersValues.length; i++) &#123;    if (headersValues[i] === columnName) &#123;      return i + 1;    &#125;  &#125;  return -1; // å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è¿”å› -1&#125;// å®šä¹‰ä¸€ä¸ªæ‰å¹³åŒ–åµŒå¥—å¯¹è±¡çš„å‡½æ•°function flattenObject(obj, parentKey = &#x27;&#x27;) &#123;  // æ£€æŸ¥ obj æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸º undefined æˆ– null  if (!obj || typeof obj !== &#x27;object&#x27;) &#123;    return &#123;&#125;;  &#125;    let result = &#123;&#125;;  for (const [key, value] of Object.entries(obj)) &#123;    const newKey = parentKey ? `$&#123;parentKey&#125;.$&#123;key&#125;` : key;    if (typeof value === &#x27;object&#x27; &amp;&amp; value !== null) &#123;      const flattened = flattenObject(value, newKey);      result = &#123; ...result, ...flattened &#125;;    &#125; else &#123;      result[newKey] = value;    &#125;  &#125;  return result;&#125;\r\nJSONç‰©ä»¶ç‰¹æ®Šè™•ç†\r\nè³‡æ–™æ‰å¹³åŒ–\r\nfunction doPost(e) &#123;  const jsonData = &#123;&quot;name&quot;:&quot;John&quot;,&quot;age&quot;:30,&quot;address&quot;:&#123;&quot;city&quot;:&quot;New York&quot;,&quot;country&quot;:&quot;USA&quot;&#125;&#125;;  // æ‰å¹³åŒ–å¯¹è±¡  const flattenedObject = flattenObject(jsonData);    // å°†æ‰å¹³åŒ–åçš„å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²  const jsonString = JSON.stringify(flattenedObject);    // è¿”å› JSON æ ¼å¼çš„æ•°æ®  return ContentService.createTextOutput(jsonString).setMimeType(ContentService.MimeType.JSON);&#125;// å®šä¹‰ä¸€ä¸ªæ‰å¹³åŒ–åµŒå¥—å¯¹è±¡çš„å‡½æ•°function flattenObject(obj, parentKey = &#x27;&#x27;) &#123;  // æ£€æŸ¥ obj æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸º undefined æˆ– null  if (!obj || typeof obj !== &#x27;object&#x27;) &#123;    return &#123;&#125;;  &#125;    let result = &#123;&#125;;  for (const [key, value] of Object.entries(obj)) &#123;    const newKey = parentKey ? `$&#123;parentKey&#125;.$&#123;key&#125;` : key;    if (typeof value === &#x27;object&#x27; &amp;&amp; value !== null) &#123;      const flattened = flattenObject(value, newKey);      result = &#123; ...result, ...flattened &#125;;    &#125; else &#123;      result[newKey] = value;    &#125;  &#125;  return result;&#125;// ä½¿ç”¨ç¤ºä¾‹const nestedObject = &#123;  name: &quot;John&quot;,  age: 30,  address: &#123;    city: &quot;New York&quot;,    country: &quot;USA&quot;  &#125;&#125;;const flattenedObject = flattenObject(nestedObject);console.log(flattenedObject);console.log(Object.keys(flattenedObject))console.log(Object.values(flattenedObject))//[name,age,address.city,address.country]//[John,30,New York,USA]\r\nè³‡æ–™æ‰å¹³åŒ–å›å¾©\r\nfunction unflattenObject(obj) &#123;  // åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥å­˜å‚¨æ¢å¤åçš„æ•°æ®  let result = &#123;&#125;;  // éå†æ‰å¹³åŒ–åçš„å¯¹è±¡  for (const key in obj) &#123;    if (Object.hasOwnProperty.call(obj, key)) &#123;      // å°†é”®åæ‹†åˆ†æˆå„çº§åˆ«çš„åµŒå¥—é”®å      const keys = key.split(&#x27;.&#x27;);      let nestedObj = result;      // è¿­ä»£åµŒå¥—é”®åï¼Œå¹¶åœ¨æ–°å¯¹è±¡ä¸­é‡æ–°åˆ›å»ºåµŒå¥—ç»“æ„      for (let i = 0; i &lt; keys.length; i++) &#123;        const nestedKey = keys[i];        if (i === keys.length - 1) &#123;          // å¦‚æœæ˜¯æœ€åä¸€çº§é”®åï¼Œç›´æ¥å°†å€¼èµ‹ç»™æœ€åä¸€çº§é”®          nestedObj[nestedKey] = obj[key];        &#125; else &#123;          // å¦‚æœä¸æ˜¯æœ€åä¸€çº§é”®åï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦åˆ›å»ºåµŒå¥—å¯¹è±¡          nestedObj[nestedKey] = nestedObj[nestedKey] || &#123;&#125;;          nestedObj = nestedObj[nestedKey];        &#125;      &#125;    &#125;  &#125;  return result;&#125;\r\nVBAéƒ¨åˆ†\r\n\r\nåªæ˜¯å…ˆåšç´€éŒ„ï¼Œä¹‹å¾Œå†è·Ÿcollectionçš„è³‡æ–™æ ¼å¼ä¸€èµ·ä»‹ç´¹\r\n\r\nSub TestDictionary()    Dim jsonData As Object    Set jsonData = CreateObject(&quot;Scripting.Dictionary&quot;)        &#x27; æ·»åŠ ?å€¼?    jsonData(&quot;name&quot;) = &quot;John&quot;    jsonData(&quot;age&quot;) = 30        &#x27; æ·»åŠ åµŒå¥—çš„å­—å…¸?è±¡    Dim address As Object    Set address = CreateObject(&quot;Scripting.Dictionary&quot;)    address(&quot;city&quot;) = &quot;New York&quot;    address(&quot;country&quot;) = &quot;USA&quot;    Set jsonData(&quot;address&quot;) = address        &#x27; ???å€¼?    Debug.Print &quot;Name: &quot; &amp; jsonData(&quot;name&quot;)    Debug.Print &quot;Age: &quot; &amp; jsonData(&quot;age&quot;)    Debug.Print &quot;City: &quot; &amp; jsonData(&quot;address&quot;)(&quot;city&quot;)    Debug.Print &quot;Country: &quot; &amp; jsonData(&quot;address&quot;)(&quot;country&quot;)End Sub\r\nVBA-JSON\r\nåƒè€ƒ\r\nç¸½çµ\r\n\r\nä½¿ç”¨Streamlitå’ŒGoogle Sheetsï¼š\r\n\r\nStreamlitèƒ½å¿«é€Ÿç”Ÿæˆå‰ç«¯ä»‹é¢ï¼Œå°ä¸ç†Ÿæ‚‰å‰ç«¯æŠ€è¡“çš„é–‹ç™¼è€…å‹å¥½ã€‚\r\nGoogle Sheetsä½œç‚ºé›²ç«¯è³‡æ–™åº«ï¼ŒçµåˆGoogle Apps Script\r\n(GAS)å¯¦ç¾è³‡æ–™æ“ä½œã€‚\r\n\r\nJSONæ ¼å¼çš„å„ªå‹¢ï¼š\r\n\r\nJSONæ˜¯APIè³‡æ–™äº¤æ›ä¸­å¸¸ç”¨çš„æ ¼å¼ï¼Œæ–¹ä¾¿è³‡æ–™å–ç”¨å’Œçµ„è£ã€‚\r\næ–‡ç« ä»‹ç´¹äº†åœ¨Pythonå’ŒGASä¸­å¦‚ä½•é€²è¡ŒJSONè³‡æ–™çš„è§£æå’Œç”Ÿæˆã€‚\r\n\r\nå¤šå±¤è³‡æ–™çµæ§‹è™•ç†æŠ€è¡“ï¼š\r\n\r\nä½¿ç”¨æ‰å¹³åŒ–å’Œåæ‰å¹³åŒ–æŠ€è¡“ï¼Œæ–¹ä¾¿è™•ç†å’Œé‚„åŸå¤šå±¤åµŒå¥—çš„è³‡æ–™çµæ§‹ã€‚\r\næä¾›äº†Pythonå’ŒGASä¸­è™•ç†å¤šå±¤è³‡æ–™çµæ§‹çš„ç¯„ä¾‹ã€‚\r\n\r\nå¯¦éš›æ‡‰ç”¨ç¯„ä¾‹ï¼š\r\n\r\nå±•ç¤ºäº†å¦‚ä½•åœ¨Streamlitæ‡‰ç”¨ä¸­å°‡è³‡æ–™è½‰æ›ç‚ºJSONæ ¼å¼ï¼Œä¸¦é€šéHTTP\r\nPOSTè«‹æ±‚ç™¼é€åˆ°GASå¾Œç«¯ã€‚\r\nåœ¨GASå¾Œç«¯æ¥æ”¶ä¸¦è§£æJSONè³‡æ–™ï¼Œå°‡å…¶å¯«å…¥Google Sheetsçš„å…·é«”æ­¥é©Ÿã€‚\r\n\r\nPythonå’ŒGASä¸­çš„JSONæ“ä½œæ–¹æ³•ï¼š\r\n\r\nè©³è¿°äº†åœ¨Pythonä¸­ä½¿ç”¨json.dumps()å’Œjson.loads()é€²è¡ŒJSONæ ¼å¼è½‰æ›ã€‚\r\nèªªæ˜äº†åœ¨GASä¸­ä½¿ç”¨JSON.stringify()å’ŒJSON.parse()è™•ç†JSONè³‡æ–™ã€‚\r\n\r\n\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["Streamlit","GAS"]},{"title":"Streamlitå»ºç«‹æ¬Šé™æ§ç®¡æ©Ÿåˆ¶","url":"/posts/777227760/","content":"å‰è¨€\r\n\r\næ¬Šé™æ§ç®¡é¡§åæ€ç¾©å‰‡æ˜¯è®“æœ‰ç™»è¨˜çš„äººå¯ä»¥é€²ä¾†é›²ç«¯ç¶²é ä¸­æ“ä½œä»‹é¢ï¼Œé€™å°æ–¼ä¸€äº›å…¬å¸å…§éƒ¨æ‰èƒ½æ“ä½œçš„å…§å®¹æœ‰å¾ˆå¤§çš„å¹«åŠ©ã€‚\r\n\r\næ¬Šé™æ§ç®¡åŸºæœ¬åŠŸèƒ½:\r\n\r\nè¨»å†Š\r\nç™»å…¥\r\nå¿˜è¨˜å¯†ç¢¼\r\né‡ç½®å¯†ç¢¼\r\n\r\nç™¼é€é‡ç½®å¯†ç¢¼æ™‚æœƒéš¨æ„ç”¢ç”Ÿä¸€çµ„tokenï¼Œå…§å®¹æœƒåŒ…åœ¨é›»å­éƒµä»¶ä¸­å¯„é€ï¼Œé€™ä¹Ÿç®—æ˜¯ä¸€ç¨®å¤šå› ç´ èªè­‰çš„æ©Ÿåˆ¶ã€‚\r\næœ¬ç¯‡æ–‡ç« å‰ç«¯ä»‹é¢æ¡ç”¨Pythonçš„Streamlitå¥—ä»¶å¯¦ä½œï¼Œå¾Œç«¯é‚è¼¯å‰‡æ¡ç”¨GASå¯¦ä½œï¼Œè³‡æ–™åº«å‰‡æ¡ç”¨GoogleSpreadSheetå„²å­˜ã€‚\r\næ­£å¸¸çš„å¸³è™Ÿå¯†ç¢¼å¯¦ä½œæµç¨‹ä¸å»ºè­°æ¡ç”¨æ˜ç¢¼å„²å­˜ï¼Œé€™è£¡åªæ˜¯ä¸€å€‹å¯¦ä½œçš„ç¶“é©—ï¼Œçœ‹ä¹‹å¾Œå¯†ç¢¼çš„éƒ¨åˆ†è¦åŠ é¹½é‚„æ˜¯åšå“ˆå¸ŒåŠ å¯†éƒ½å¯ä»¥å†è¿½åŠ é€²å»ã€‚\r\n\r\n\r\nGASç«¯\r\nå…ˆæ–°å¢ä¸€å€‹SpreadSheetä¸¦ä¸”å°‡å·¥ä½œè¡¨è¨­å®šå¦‚ä¸‹:\r\nUsers\r\n\r\n\r\n\r\nemail\r\nusername\r\npassword\r\n\r\n\r\n\r\n\r\n...\r\n...\r\n...\r\n\r\n\r\n\r\nResetTokens\r\n\r\n\r\n\r\nemail\r\ntoken\r\ntimestamp\r\n\r\n\r\n\r\n\r\n...\r\n...\r\n...\r\n\r\n\r\n\r\ntimestampåœ¨GASä¸­çš„ç›®çš„æ˜¯ç‚ºäº†è¦å–å¾—24å°æ™‚å…§çš„tokenæ‰èƒ½æœ‰æ•ˆæ›´æ”¹æ–°å¯†ç¢¼\r\nfunction doPost(e) &#123;  var action = e.parameter.action;  var email = e.parameter.email;  var username = e.parameter.username;  var password = e.parameter.password;  var newPassword = e.parameter.newPassword;  var token=e.parameter.token;  try &#123;    if (action == &quot;register&quot;) &#123;      return registerUser(email, username, password);    &#125; else if (action == &quot;login&quot;) &#123;      return loginUser(username, password);    &#125; else if (action == &quot;forgotPassword&quot;) &#123;      return forgotPassword(email);    &#125; else if (action == &quot;updatePassword&quot;) &#123;      return updatePassword(username,token, newPassword);    &#125; else &#123;      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Invalid action&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125; catch (error) &#123;    return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: error.message &#125;)).setMimeType(ContentService.MimeType.JSON);  &#125;&#125;function registerUser(email, username, password) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);  var data = sheet.getDataRange().getValues();  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][0] == email) &#123;      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Email already registered&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125;  sheet.appendRow([email, username, password]);  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;User registered successfully&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function loginUser(username, password) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);  var data = sheet.getDataRange().getValues();  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][1] == username &amp;&amp; data[i][2] == password) &#123;      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;Login successful&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125;  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Invalid username or password&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function updatePassword(email, token, newPassword) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;ResetTokens&#x27;);  var data = sheet.getDataRange().getValues();  var now = new Date().getTime();  var tokenValid = false;  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][0] == email &amp;&amp; data[i][1] == token) &#123;      var timestamp = data[i][2];      if (now - timestamp &lt;= 24 * 60 * 60 * 1000) &#123;  // Token valid for 24 hours        tokenValid = true;        sheet.getRange(i+1, 3).setValue(0);        break;      &#125;    &#125;  &#125;  if (tokenValid) &#123;    var userSheet =SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);    var userData = userSheet.getDataRange().getValues();    for (var j = 0; j &lt; userData.length; j++) &#123;      if (userData[j][0] == email) &#123;        userSheet.getRange(j + 1, 3).setValue(newPassword);        return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;Password updated successfully&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);      &#125;    &#125;  &#125;  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Invalid token or email&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function forgotPassword(email) &#123;  var sheet =SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);  var data = sheet.getDataRange().getValues();  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][0] == email) &#123;      // Generate a random token for password reset      var token = generateToken();      // Store the token and timestamp in a separate sheet (or update the existing sheet structure)      storeResetToken(email, token);      // Send the reset email      sendResetEmail(email, token);      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;Password reset email sent&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125;  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Email not found&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function generateToken() &#123;  var charset = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;;  var token = &#x27;&#x27;;  for (var i = 0; i &lt; 20; i++) &#123;    var randomIndex = Math.floor(Math.random() * charset.length);    token += charset[randomIndex];  &#125;  return token;&#125;function storeResetToken(email, token) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;ResetTokens&#x27;);  // if (!sheet) &#123;    // sheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet(&#x27;ResetTokens&#x27;);    // sheet.appendRow([&#x27;Email&#x27;, &#x27;Token&#x27;, &#x27;Timestamp&#x27;]);  // &#125;  var timestamp = new Date().getTime();  sheet.appendRow([email, token, timestamp]);&#125;function sendResetEmail(email, resetUrl) &#123;  var subject = &#x27;Password Reset Request&#x27;;  var body = &#x27;You requested a password reset. Click the link below to reset your password:\\n\\n&#x27; + resetUrl + &#x27;\\n\\nIf you did not request a password reset, please ignore this email.&#x27;;  GmailApp.sendEmail(email, subject, body);&#125;\r\nå»ºç«‹å®Œæˆä¹‹å¾Œç™¼å¸ƒæˆç‚ºWebAppï¼Œæœƒå¾—åˆ°ä¸€ä¸²URLï¼Œæ­¤ç‚ºPythonä¸­éœ€è¦å¼•å…¥çš„BASE_URL\r\nPythonç«¯\r\napp.py\r\nimport streamlit as stimport requestsBASE_URL = &#x27;YOUR_GAS_WEB_APP_URL&#x27;def register_user(email, username, password):    response = requests.post(BASE_URL, data=&#123;        &#x27;action&#x27;: &#x27;register&#x27;,        &#x27;email&#x27;: email,        &#x27;username&#x27;: username,        &#x27;password&#x27;: password    &#125;)    return response.json()def login_user(username, password):    response = requests.post(BASE_URL, data=&#123;        &#x27;action&#x27;: &#x27;login&#x27;,        &#x27;username&#x27;: username,        &#x27;password&#x27;: password    &#125;)    return response.json()def forgot_password(email):    response = requests.post(BASE_URL, data=&#123;        &#x27;action&#x27;: &#x27;forgotPassword&#x27;,        &#x27;email&#x27;: email    &#125;)    return response.json()def update_password(username,token, new_password):    response = requests.post(BASE_URL, data=&#123;        &#x27;action&#x27;: &#x27;updatePassword&#x27;,        &#x27;username&#x27;: username,        &#x27;token&#x27;:token,        &#x27;newPassword&#x27;: new_password    &#125;)    return response.json()def main():    st.title(&quot;User Management System&quot;)    menu = [&quot;Home&quot;, &quot;Login&quot;, &quot;Register&quot;, &quot;Forgot Password&quot;, &quot;Update Password&quot;]    choice = st.sidebar.selectbox(&quot;Menu&quot;, menu)    if choice == &quot;Home&quot;:        st.subheader(&quot;Home&quot;)    elif choice == &quot;Login&quot;:        st.subheader(&quot;Login&quot;)        username = st.text_input(&quot;Username&quot;)        password = st.text_input(&quot;Password&quot;, type=&#x27;password&#x27;)        if st.button(&quot;Login&quot;):            result = login_user(username, password)            st.write(result)    elif choice == &quot;Register&quot;:        st.subheader(&quot;Register&quot;)        email = st.text_input(&quot;Email&quot;)        username = st.text_input(&quot;Username&quot;)        password = st.text_input(&quot;Password&quot;, type=&#x27;password&#x27;)        if st.button(&quot;Register&quot;):            result = register_user(email, username, password)            st.write(result)    elif choice == &quot;Forgot Password&quot;:        st.subheader(&quot;Forgot Password&quot;)        email = st.text_input(&quot;Email&quot;)        if st.button(&quot;Submit&quot;):            result = forgot_password(email)            st.write(result)    elif choice == &quot;Update Password&quot;:        st.subheader(&quot;Update Password&quot;)        username = st.text_input(&quot;Username&quot;)        token=st.text_input(&quot;Token&quot;)        new_password = st.text_input(&quot;New Password&quot;, type=&#x27;password&#x27;)        if st.button(&quot;Update&quot;):            result = update_password(username, token,new_password)            st.write(result)if __name__ == &#x27;__main__&#x27;:    main()\r\nå°‡é€™äº›å…§å®¹ç”¨Streamlit run app.py å³å¯çœ‹åˆ°ä½¿ç”¨ä»‹é¢\r\n\r\n\r\nimage\r\n\r\nå¾ŒçºŒè¦åˆ©ç”¨çš„æ™‚å€™å°±æŠŠç™»å…¥æˆåŠŸçš„å…§å®¹æ”¾ç½®æ–¼session_stateä¸­å…ˆå­˜èµ·ä¾†ï¼Œå†é¡¯ç¤ºä¸»è¦æ“ä½œçš„ä»‹é¢å°±å¯ä»¥äº†!\r\nå“ˆå¸ŒåŠ å¯†ç®—æ³•\r\nfunction hashPassword(password) &#123;  var rawHash = Utilities.computeDigest(Utilities.DigestAlgorithm.SHA_256, password);  var hash = rawHash.map(function(byte) &#123;    var v = (byte &lt; 0 ? byte + 256 : byte).toString(16);    return v.length == 1 ? &#x27;0&#x27; + v : v;  &#125;).join(&#x27;&#x27;);  return hash;&#125;function registerUser(email, username, password) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);  var data = sheet.getDataRange().getValues();  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][0] == email) &#123;      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Email already registered&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125;  var hashedPassword = hashPassword(password);  sheet.appendRow([email, username, hashedPassword]);  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;User registered successfully&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function loginUser(username, password) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);  var data = sheet.getDataRange().getValues();  var hashedPassword = hashPassword(password);  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][1] == username &amp;&amp; data[i][2] == hashedPassword) &#123;      return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;Login successful&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);    &#125;  &#125;  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Invalid username or password&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;function updatePassword(email, token, newPassword) &#123;  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;ResetTokens&#x27;);  var data = sheet.getDataRange().getValues();  var now = new Date().getTime();  var tokenValid = false;  for (var i = 0; i &lt; data.length; i++) &#123;    if (data[i][0] == email &amp;&amp; data[i][1] == token) &#123;      var timestamp = data[i][2];      if (now - timestamp &lt;= 24 * 60 * 60 * 1000) &#123;  // Token valid for 24 hours        tokenValid = true;        sheet.getRange(i + 1, 3).setValue(0);        break;      &#125;    &#125;  &#125;  if (tokenValid) &#123;    var userSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(&#x27;Users&#x27;);    var userData = userSheet.getDataRange().getValues();    var hashedPassword = hashPassword(newPassword);    for (var j = 0; j &lt; userData.length; j++) &#123;      if (userData[j][0] == email) &#123;        userSheet.getRange(j + 1, 3).setValue(hashedPassword);        return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;success&quot;, message: &quot;Password updated successfully&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);      &#125;    &#125;  &#125;  return ContentService.createTextOutput(JSON.stringify(&#123; status: &quot;error&quot;, message: &quot;Invalid token or email&quot; &#125;)).setMimeType(ContentService.MimeType.JSON);&#125;\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Streamlit"]},{"title":"VBAæ©«æ–·é¢æ³•é¢ç©æ‰¹æ¬¡è™•ç†","url":"/posts/2533511128/","content":"å‰è¨€\r\nå·¥ç¨‹ç‰¹æ€§å¦‚ç‚ºå¸¶ç‹€å·¥ç¨‹ï¼Œæ¯”å¦‚:æ°´æºã€é“è·¯ç­‰ç­‰ï¼Œé€šå¸¸æœƒä»¥æ©«æ–·é¢æ³•ä½œç‚ºåœŸæ–¹è¨ˆç®—çš„æ•¸é‡ä¾æ“šï¼Œæ­¤æŒ‡åœŸæ–¹è¨ˆç®—ä¸å¤–ä¹ç‚º:æŒ–æ–¹ã€å¡«æ–¹ã€å›å¡«æ–¹ã€CLSMä¹‹é¡ã€‚\r\nåœ¨ç¹ªè£½åœŸæ–¹åŸºæœ¬è³‡æ–™æ™‚ï¼Œé¢ç©çš„æ¡†é¸ä¾¿æœƒæ˜¯æ±ºå®šæ•¸é‡å¾ˆé‡è¦çš„éƒ¨åˆ†ï¼Œå¯¦å‹™ä¸Šçš„åœŸæ–¹è¨ˆç®—æµç¨‹ç‚º:\r\nåœ–å±¤è¨­å®š:\r\n\r\nåŸåœ°é¢ç·š\r\nçµæ§‹ç·š\r\né–‹æŒ–ç·š\r\nå¡«æ–¹ç·š\r\né–‹æŒ–é¢ç©\r\næŒ–æ–¹é¢ç©\r\n\r\n\r\nç¹ªè£½æŒ–æ–¹é¢ç©æ™‚ï¼Œå°‡åŸåœ°é¢ç·šèˆ‡é–‹æŒ–ç·šéš”é›¢é¡¯ç¤ºï¼Œé€éBOæˆ–HATCHç”Ÿæˆé¢ç©\r\nç¹ªè£½å¡«æ–¹é¢ç©æ™‚ï¼Œå°‡å›å¡«ç·šã€çµæ§‹ç·šã€é–‹æŒ–ç·šéš”é›¢é¡¯ç¤ºï¼Œé€éBOæˆ–HATCHç”Ÿæˆé¢ç©\r\n\r\n\r\nå°é–‰èšåˆç·š\r\n\r\nCADå…§å»ºæŒ‡ä»¤'BO'æœƒå‡ºç¾ä¸€å¼µä»‹é¢ï¼Œå¯ä»¥è—‰ç”±é»é¸å…§éƒ¨é»ç”Ÿæˆå°é–‰èšåˆç·šï¼ŒæŒ‡ä»¤'-BO'å‰‡å¯ä»¥ç•¥éä»‹é¢çš„ç¨‹åºç›´æ¥é»é¸ï¼Œæ­¤æ™‚å°é–‰èšåˆç·šæœƒæœ‰'é¢ç©'å±¬æ€§ã€‚\r\n\r\nå¡«å……ç·š\r\n\r\nCADå…§å»ºæŒ‡ä»¤'HATCH'å¯ä»¥é»é¸å…§éƒ¨é»ç”Ÿæˆå¡«å……ç·šï¼Œæ­¤æ™‚å¡«å……ç·šæœƒæœ‰'é¢ç©'å±¬æ€§ï¼Œé ˆæ³¨æ„ä¹‹å‰æ¸¬è©¦éHATCHå¯èƒ½æœƒæœ‰äº›è¨±çš„èª¤å·®ï¼Œé€™å€‹ä¹Ÿä¸æ¸…æ¥šåŸå› ç‚ºä½•...\r\n\r\nVBAæ‰¹æ¬¡è™•ç†æµç¨‹\r\næ­£å¸¸çš„ä½œæ¥­æµç¨‹æœƒå°‡æ¯ä¸€å€‹æ¨è™Ÿåº•ä¸‹çš„é¢ç©é€ç­†ç´€éŒ„ä½œåŠ ç¸½ï¼Œç®—å®Œçš„æ•¸æ“šæœƒä¿®æ”¹åˆ°æ©«æ–·é¢ä¸Šæ‰€è¨˜è¼‰çš„æŒ–æ–¹é¢ç©æ•¸å­—ã€å¡«æ–¹é¢ç©æ•¸å­—ï¼Œå¾ŒçºŒå†å°‡é€™äº›æ•¸å­—å¡«å ±åˆ°åœŸæ–¹è¨ˆç®—è¡¨ï¼Œç¨æœ‰æç¥å‰‡å®¹æ˜“å‡ºéŒ¯ï¼Œä¹Ÿå› æ­¤è‹¥é€™äº›å…§å®¹éƒ½å¯ä»¥ç”¨CADä¸­å°æ‡‰åœ–å…ƒçš„é¢ç©å±¬æ€§é€²è¡Œè™•ç†ï¼Œä¸¦ä¸”å°‡è³‡æ–™å‚³è¼¸åˆ°åœŸæ–¹è¨ˆç®—è¡¨åŠå›æ­¸åˆ°åœ–é¢ä¿®è¨‚è¨˜è¼‰æ•¸å­—ï¼Œé€™æœƒè®“æ•´å€‹åœŸæ–¹è¨ˆç®—ä½œæ¥­ç°¡å–®å¾ˆå¤šã€‚\r\n\r\nç›®æ¨™ç‚ºå¸Œæœ›èƒ½å¤ æ¡†é¸ä¸€æ¬¡ç¯„åœï¼Œå°±å°‡æ‰€æœ‰çš„é¢ç©è¨ˆç®—å®Œç•¢ä¸¦ä¸”æ”¾ç½®æ–¼å°æ‡‰çš„æ¨è™Ÿï¼Œçœä¸‹ä½œæ¥­æ™‚é–“!!!\r\n\r\nè¦å°‡åœ–é¢é€²è¡Œæ‰¹æ¬¡è™•ç†æ™‚ï¼Œæœƒéœ€è¦é€²è¡Œä¸‹åˆ—æ­¥é©Ÿæ­é…VBAåŸ·è¡Œä¾¿èƒ½é †åˆ©å®Œæˆ\r\nä¸»è¦ä»‹é¢\r\n\r\n\r\næ©«æ–·é¢åœ–ç¯„ä¾‹\r\n\r\n\r\n\r\nè³‡æ–™åº«ä»‹é¢\r\n\r\nå»ºç«‹æ¨è™Ÿå¤–æ¡†\r\næ¯ä¸€å€‹æ©«æ–·é¢åœ–éƒ½æœƒæœ‰å®ƒæ‰€ä»£è¡¨çš„æ¨è™Ÿåç¨±åŠæ©«æ–·é¢åœ–ç¯„åœ(æ­¤è™•æ˜¯æŒ‡BORDERæ¬„ä½)ï¼Œå°‡å¤–æ¡†å®Œæˆä¹‹å¾Œåšé©ç•¶çš„æ”¾å¤§ç¸®å°ï¼Œç›®æ¨™æ˜¯è®“æ‰€æœ‰èˆ‡è©²æ¨è™Ÿç›¸é—œçš„åœŸæ–¹é¢ç©'å½¢å¿ƒ'éƒ½èƒ½è¢«å®Œæ•´åŒ…è¦†åœ¨æ¡†æ¡†è£¡é¢ï¼Œå¾ŒçºŒè¦åˆ¤æ–·é¢ç©æ­¸å±¬æ™‚å¯ä»¥é †åˆ©åŸ·è¡Œã€‚\r\né»é¸é¢ç©\r\né¢ç©éƒ¨åˆ†æœ‰å…©ç¨®å¯¦ä½œæ–¹å¼\r\n\r\nå¦‚å‰è¨€æ‰€è¿°ç”¨ä¸åŒçš„åœ–å±¤ä¾†é å…ˆå®šç¾©é¢ç©æ­¸å±¬é …ç›®(æŒ–æ–¹ã€å¡«æ–¹)ä¸¦ä¸”é€éBOæˆ–HATCHä¾†é»æ“Š'å…§éƒ¨é»'ï¼Œä½†é€™æ¨£é‚„æ˜¯å…ä¸äº†æœƒæœ‰æ‰‹å‹•è™•ç†çš„éƒ¨åˆ†ã€‚\r\nç”¨å¹¾ä½•æ•¸å­¸æ–¹æ³•ä¾†è™•ç†ï¼ŒåŸåœ°é¢ç·šæ˜¯f(x)ï¼Œé–‹æŒ–ç·šæ˜¯g(x)ï¼Œé–‹æŒ–ç·šå…ˆå°‡å…©ç«¯ç”¨CADä¸­çš„IntersectWithåšå»¶ä¼¸å¾Œï¼Œåœ¨ç”¨f(x)èˆ‡g(x)çš„å¹¾ä½•é—œä¿‚è¨ˆç®—é¢ç©ï¼Œç›¸é—œVBAç¨‹å¼ç¢¼å¯¦ä½œå¦‚ä¸‹:\r\n\r\n&#x27;===Main Function===Sub plotDigLine(ByVal EG As Object, ByVal EGVertices)Dim IsIntersect As BooleanCall CAD.GetBoundingBox(buttomCONC, MinX, MinY, MaxX, MaxY)Dim vertices(4 * 2 - 1) As Doublevertices(0) = MinX - 300 - 30vertices(1) = MinY + 100vertices(2) = MinX - 300vertices(3) = MinYvertices(4) = MaxX + 300vertices(5) = MinYvertices(6) = MaxX + 300 + 30vertices(7) = MinY + 100Set DL = CAD.AddLWPolyLine(vertices)Call CAD.setLayer(DL, &quot;CAL&quot;)&#x27;DL.Layer = &quot;CAL&quot; &#x27; &quot;æ©«æ–·é¢-æŒ–æ–¹ç·š&quot;retpt = myFunc.SortPTArray(CAD.IntersectWith(DL, EG, 1, IsIntersect))If IsIntersect = False Then Exit Subvertices(0) = retpt(0, 0)vertices(1) = retpt(0, 1)vertices(6) = retpt(UBound(retpt, 1), 0) &#x27;- 3 + 1)vertices(7) = retpt(UBound(retpt, 1), 1) &#x27;- 3 + 2)&#x27;========ä»¥é‚Šç•Œç‚ºåŸºæº–================&#x27;vertices(0) = EGVertices(0)&#x27;vertices(1) = EGVertices(1)&#x27;vertices(6) = EGVertices(UBound(EGVertices) - 1)&#x27;vertices(7) = EGVertices(UBound(EGVertices))&#x27;====================================DL.DeleteSet DL2 = CAD.AddLWPolyLine(vertices)DL2.Layer = &quot;CAL&quot; &#x27;&quot;æ©«æ–·é¢-æŒ–æ–¹ç·š&quot;&#x27;============åŒ¯å…¥æŒ–æ–¹é¢ç©==================Dim stoneObj As New clsStoneDLArea = stoneObj.getDLArea(EG, DL2)With Sheets(&quot;ä¸­å¿ƒç·š&quot;)        Set rng = .Columns(1).Find(loc)        If Not rng Is Nothing Then        r = rng.Row    .Cells(r, 5) = DLArea        End IfEnd WithEnd Sub&#x27;====clsCAD===Function IntersectWith(ByVal PL1, ByVal PL2, ByVal mode As Byte, ByRef IsIntersect As Boolean)IsIntersect = FalseDim coll As New CollectionIf CADVer = &quot;ICAD&quot; Then        On Error GoTo ERRORHANDLE &#x27;20210901 éŒ¯èª¤åµæ¸¬    Set retpt = PL1.IntersectWith(PL2, mode) &#x27;acExtendThisEntity)        For Each it In retpt            coll.Add it.x        coll.Add it.y        coll.Add it.Z        Next        If coll Is Nothing ThenERRORHANDLE:        &#x27;intersectWith = &quot;EMPTY&quot;    Else        IntersectWith = myFunc.tranColl2Array(coll)        IsIntersect = True    End If    Else    retpt = PL1.IntersectWith(PL2, mode) &#x27;acExtendThisEntity)        If UBound(retpt) = -1 Then       &#x27; IntersectWith = &quot;EMPTY&quot;    Else        IntersectWith = retpt        IsIntersect = True    End IfEnd IfEnd Function&#x27;====clsStone===&#x27;TODO:&#x27;1.sort X coordinate&#x27;2.define border&#x27;3.decide X-valueFunction getDLArea(ByVal EG, ByVal DL)Set PLobj1 = RevisePL(EG)EG.DeletePL1_X = myFunc.tranColl2Array(getcoll(PLobj1, &quot;X&quot;))PL1_Y = myFunc.tranColl2Array(getcoll(PLobj1, &quot;Y&quot;))Set PLobj2 = RevisePL(DL)DL.DeletePL2_X = myFunc.tranColl2Array(getcoll(PLobj2, &quot;X&quot;))PL2_Y = myFunc.tranColl2Array(getcoll(PLobj2, &quot;Y&quot;))Call defineBorder(PL1_X, PL2_X, BL, BR)getDLArea = calculateArea_test(PL1_X, PL1_Y, PL2_X, PL2_Y, BL, BR)End FunctionFunction RevisePL(ByVal PLobj) &#x27;ç”±å·¦è‡³å³æ’åºDim coll As New Collectionco = 3If TypeName(PLobj) Like &quot;*LWPolyline&quot; Then co = 2  &#x27;IIcadLightWeightPolylinearr = CAD.tranIPoints(PLobj.coordinates)Debug.Print TypeName(PLobj)X1 = arr(0)Xn = arr(UBound(arr) - co + 1)If X1 &gt; Xn Then    Set RevisePL = CAD.ReverseLine(ByVal PLobj)Else    Set RevisePL = PLobjEnd IfFor i = 0 To UBound(arr) - co Step co    X1 = arr(i)    X2 = arr(i + co)        If X1 = X2 Then arr(i + co) = arr(i + co) + 0.001 &#x27;è‹¥ç‚ºå‚ç›´å‰‡å¾®èª¿å¾€å³åç§»NextSet RevisePL = CAD.AddLWPolyLine(arr)RevisePL.Layer = PLobj.LayerEnd FunctionFunction calculateArea_test(ByVal PL1_X, ByVal PL1_Y, ByVal PL2_X, ByVal PL2_Y, ByVal BL, ByVal BR)X_sort = myFunc.BubbleSort_array(myFunc.combineArray(PL1_X, PL2_X))For i = LBound(X_sort) To UBound(X_sort) - 1        X1 = X_sort(i)    X2 = X_sort(i + 1)        dx = X2 - X1        If X1 &gt;= BL And X2 &lt;= BR Then                Y1f = getYbyX(X1, PL1_X, PL1_Y)        Y2f = getYbyX(X1, PL2_X, PL2_Y)                dYf = Y1f - Y2f                Y1b = getYbyX(X2, PL1_X, PL1_Y)        Y2b = getYbyX(X2, PL2_X, PL2_Y)                dYb = Y1b - Y2b        If dYf &gt; 0 And dYb &lt; 0 Then &#x27;èˆ‡åŸºæº–ç·šäº¤å‰(æ­£åˆ°è² )                    X_intersect = getIntersectX(X1, X2, Y1f, Y1b, Y2f, Y2b)            dA = dYf * (X_intersect - X1) / 2            &#x27;Set lineObj = CAD.AddLineCO(X1, Y1f, X1, Y2f)                    ElseIf dYf &lt; 0 And dYb &gt; 0 Then &#x27;èˆ‡åŸºæº–ç·šäº¤å‰(è² åˆ°æ­£)                    X_intersect = getIntersectX(X1, X2, Y1f, Y1b, Y2f, Y2b)            dA = dYb * (X2 - X_intersect) / 2            &#x27;Set lineObj = CAD.AddLineCO(X2, Y1b, X2, Y2b)                    ElseIf dYf &gt;= 0 And dYb &gt;= 0 Then &#x27;çš†åœ¨åŸºæº–ç·šä¸‹æ–¹                    dA = (dYf + dYb) * dx / 2            &#x27;Set lineObj = CAD.AddLineCO(X1, Y1f, X1, Y2f)            &#x27;Set lineObj = CAD.AddLineCO(X2, Y1b, X2, Y2b)                Else            dA = 0                End If                &#x27;Debug.Print &quot;dYf=&quot; &amp; dYf &amp; &quot;,dYb=&quot; &amp; dYb &amp; &quot;,dA=&quot; &amp; dA        sA = sA + dA            End If    NextcalculateArea_test = Round(sA / 1000000, 2)End FunctionFunction getIntersectX(ByVal X1 As Double, ByVal X2 As Double, _                        ByVal Y1f As Double, ByVal Y1b As Double, _                        ByVal Y2f As Double, ByVal Y2b As Double)dx = X2 - X1y1_slope = (Y1b - Y1f) / dxy2_slope = (Y2b - Y2f) / dxslope_change = Abs(y1_slope - y2_slope)dY_f = Abs(Y1f - Y2f)getIntersectX = X1 + dY_f / slope_changeEnd FunctionFunction getYbyX(ByVal x As Double, ByVal PL_X, ByVal PL_Y)For i = LBound(PL_X) To UBound(PL_X) - 1        X1 = PL_X(i)    X2 = PL_X(i + 1)    Y1 = PL_Y(i)    Y2 = PL_Y(i + 1)        If X1 = X2 Then X2 = X2 + 0.001: Stop        If x &gt;= X1 And x &lt;= X2 Then                s1 = x - X1        s2 = X2 - x        getYbyX = (s1 * Y2 + s2 * Y1) / (s1 + s2)                Exit For          End If    NextEnd Function\r\nåˆ¤æ–·é¢ç©æ­¸å±¬\r\né¢ç©æ­¸å±¬çš„åˆ¤å®šæ–¹æ³•ç‚ºè©²å°é–‰èšåˆç·šçš„å½¢å¿ƒé»æˆ–å¡«å……ç·šçš„å½¢å¿ƒé»ä½æ–¼å“ªå€‹æ¨è™Ÿå¤–æ¡†ä¸­ï¼Œåˆ¤å®šå±¬æ–¼å“ªå€‹å¤–æ¡†å¾Œå–å‡ºé¢ç©ä¸¦åšæŒ–æ–¹åŠ ç¸½æˆ–å¡«æ–¹åŠ ç¸½(çœ‹å–å‡ºçš„åœ–å±¤æ˜¯å“ªä¸€ç¨®)ï¼Œé—œæ–¼é»èˆ‡å¤–æ¡†çš„ä½ç½®åˆ¤å®šé—œä¿‚è«‹åƒè€ƒä¸‹åˆ—ç¨‹å¼ç¢¼:\r\næ­¤è™•ç¯„ä¾‹æ˜¯ç”¨HATCHçš„é¢ç©å–å‡ºå…¶å€¼ï¼ŒssetAreaså…ˆåšå¥½Hatchçš„ç¯©é¸æ‰é€²è¡Œå¾ŒçºŒå…§å®¹ï¼Œæœ‰éœ€è¦è€…å¯ä»¥æ”¹ç”¨polyline\r\nSub CalcCABA() &#x27;20210720 updateSet ssetAreas = CAD.CreateSSET(&quot;HA&quot;, &quot;0&quot;, &quot;Hatch&quot;)For Each ssetArea In ssetAreas    &#x27;TODO:    &#x27;1.getMidPoint    &#x27;2.searchLoc    &#x27;3.getAreaCol    &#x27;4.keyinArea        r = getRowFromBorder(ssetArea)    c = getColFromLayerName(ssetArea)        If r &lt;&gt; &quot;&quot; And c &lt;&gt; &quot;&quot; Then shtCL.Cells(r, c) = ssetArea.area / 1000000NextEnd SubFunction getColFromLayerName(ByVal ha)With shtCL    CD = ha.Layer &#x27;æ©«æ–·é¢-æŒ–æ–¹        targetColName = Split(CD, &quot;-&quot;)(1)    Set rng = .Rows(2).Find(targetColName)        getColFromLayerName = rng.ColumnEnd WithEnd FunctionFunction getRowFromBorder(ByVal ha)    Call CAD.GetBoundingBox(ha, MinX, MinY, MaxX, MaxY)    midX = (MinX + MaxX) / 2    midY = (MinY + MaxY) / 2    With shtCL        lr = .Cells(.Rows.Count, 1).End(xlUp).Row            For r = 3 To lr                    BorderPTs = Split(.Cells(r, 3), &quot;,&quot;)                        If UBound(BorderPTs) = 3 Then                        Border_minX = CDbl(BorderPTs(0))                Border_minY = CDbl(BorderPTs(1))                Border_maxX = CDbl(BorderPTs(2))                Border_maxY = CDbl(BorderPTs(3))                                If midX &gt;= Border_minX And midX &lt;= Border_maxX And midY &gt;= Border_minY And midY &lt;= Border_maxY Then                                        getRowFromBorder = r                    Exit For                                    End If                        End If                    Next    End WithEnd Function\r\næ•¸æ“šå›æ­¸åœ–é¢\r\næˆ‘é€™è£¡æ˜¯æ¡ç”¨å±¬æ€§åœ–å¡Šæ–¹å¼è™•ç†ï¼Œå¦‚æœä¸è¦é‚£éº¼éº»ç…©ä¹Ÿå¯ä»¥ç”¨æœ€ç°¡å–®çš„textåˆ¤å®šæ¨è™Ÿçš„å½¢å¿ƒä½ç½®å¾Œï¼Œåšç›¸å°æ–‡å­—åç§»ä¸¦ä¸”åŠ å…¥æŒ–æ–¹å¡«æ–¹é¢ç©æ–‡å­—å°±å¯ä»¥äº†ï¼Œé€™æ¨£å¯ä»¥æœ‰æ•ˆé¿å…æ²’æœ‰åœ–å¡Šçš„å•é¡Œã€‚\r\nSub DrawCABA_Main() &#x27;å°‡æ©«æ–·é¢èªªæ˜çš„CLã€CAã€BAåˆªé™¤å¾Œé‡æ•´Set sset = CAD.CreateSSET(&quot;Title&quot;, &quot;8&quot;, &quot;TITLE&quot;)For Each it In sset            If TypeName(it) = &quot;IAcadBlockReference&quot; Then            myAttr = it.GetAttributes        HSecLoc = myAttr(0).TextString                s = returnCABA(HSecLoc)                tmp = Split(s, &quot;,&quot;)                myAttr(1).TextString = tmp(0)        myAttr(2).TextString = &quot;æŒ–æ–¹=&quot; &amp; Round(tmp(1), 2) &amp; &quot; m2&quot;        myAttr(3).TextString = &quot;å¡«æ–¹=&quot; &amp; Round(tmp(2), 2) &amp; &quot; m2&quot;        &#x27;myAttr(4).TextString = &quot;CLSM=&quot; &amp; Round(tmp(3), 2) &amp; &quot; m2&quot;                End IfERRORHANDLE:NextEnd SubPrivate Function returnCABA(ByVal HSecLoc As String)With shtCL    Set rng = .Cells.Find(HSecLoc)        r = rng.Row        deltaH = .Cells(r, 2 + 2)    CA = .Cells(r, 3 + 2)    BA = .Cells(r, 4 + 2)    RA = .Cells(r, 5 + 2)        returnCABA = deltaH &amp; &quot;,&quot; &amp; CA &amp; &quot;,&quot; &amp; BA &amp; &quot;,&quot; &amp; RAEnd WithEnd Function\r\nç”Ÿæˆå ±å‘Š\r\né€™è£¡å°±æ˜¯å–®ç´”çš„å°æ ¼å­å¡è³‡æ–™è¨ˆç®—ç¸½æ•¸è€Œå·²ï¼Œåƒ…æä¾›æˆæœä¾›åƒã€‚\r\n\r\n\r\nåœŸæ–¹å ±å‘Šæˆæœ\r\n\r\næ›´å¤šç´°ç¯€\r\næœ‰éœ€è¦æ›´å¤šæŠ€è¡“ç´°ç¯€å…§å®¹å†è«‹ä¾†ä¿¡è¨è«–æˆ–LINEé€²è¡Œè¯ç¹«ã€‚\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["AutoCAD VBA","Excel VBA"]},{"title":"VBAè‡ªå­¸å¿ƒå¾—","url":"/posts/3619695554/","content":"ğŸ™Œå‰è¨€\r\nå› ç‚ºå·¥ä½œçš„ç·£æ•…ï¼Œæ—¥å¸¸æœƒæ¥è§¸å¤§é‡çš„Excelæ“ä½œï¼Œéç¨‹ä¸å¤–ä¹éƒ½æ˜¯ä¸€äº›é‡è¤‡åˆç„¡è¶£çš„å‹•ä½œï¼Œä¹Ÿè®“æˆ‘èµ·å¿ƒå‹•å¿µè¦é€éç¨‹å¼ç¢¼çš„æ–¹æ³•ä¾†è§£æ±ºé€™äº›å•é¡Œï¼Œæˆ‘æ“ä½œçš„è»Ÿé«”æ˜¯Excelï¼Œé‚£ç›´æ¥æ¡ç”¨ExcelVBAçš„èªè¨€æœƒæ˜¯æœ€ä½³çš„ä¸€å€‹è·¯å¾‘ã€‚\r\nç¨‹å¼èªè¨€çµ‚ç©¶é‚„æ˜¯ä¸€ç¨®èˆ‡é›»è…¦æºé€šçš„å·¥å…·ï¼Œé‡é»æ˜¯ä½ æœ‰ä»€éº¼ç”Ÿæ´»ä¸­çš„å•é¡Œè¦é€²è¡Œå¯¦ä½œï¼Œèƒ½å¤ è§£æ±ºå•é¡Œçš„èªè¨€å°±æ˜¯å¥½èªè¨€ã€‚\r\nä»¥ä¸‹æ˜¯æˆ‘åœ¨è‡ªå­¸è·¯ä¸Šçš„ä¸€äº›å¿ƒå¾—ï¼Œèˆ‡å„ä½åšå€‹åˆ†äº«ã€‚\r\n\r\n\r\nğŸ’­è‡ªå­¸å¿ƒæ…‹\r\n\r\nè‡ªå­¸å¿…é ˆè¦æœ‰ç›®æ¨™ï¼Œé”æˆç›®æ¨™ä¹‹å¾Œæ‰æœƒæœ‰æˆå°±æ„Ÿã€‚\r\n\r\næƒ³ç•¶åˆåœ¨å­¸éšæ®µï¼Œå­¸ç¿’æ–°çš„äº‹ç‰©å…¶å¯¦ä¸¦ä¸äº†è§£æ˜¯ç‚ºäº†ä»€éº¼ï¼Œåƒ…èªçŸ¥åˆ°æ˜¯ç‚ºäº†è€ƒè©¦è€Œè®€æ›¸ï¼Œä¹Ÿå› æ­¤å­¸å®Œçš„æ±è¥¿æ²’æœ‰è¢«æ‡‰ç”¨ï¼Œä¹…è€Œä¹…ä¹‹å°±é‚„çµ¦è€å¸«äº†ã€‚\r\nå‡ºç¤¾æœƒçš„æ™‚å€™ï¼Œç”Ÿæ´»ä¸Šæœ‰å„å¼å„æ¨£çš„å•é¡Œç­‰å¾…è¢«è§£æ±ºï¼Œè€Œæ­¤æ™‚çš„ç›®æ¨™ä¾¿æ˜¯æ‰¾å‡ºè§£æ±ºå•é¡Œçš„ç­”æ¡ˆï¼Œç„¡è«–æ˜¯å¯¦é«”æ›¸ã€ç·šä¸Šèª²ç¨‹æˆ–ç¶²è·¯ä¸Šçš„è³‡æºï¼Œå­¸ç¿’è³‡æºä¸€ç›´éƒ½æœ‰ï¼Œæ­¤å¤–é‚„éœ€è¦å…·å‚™è¶³å¤ æ¢ç´¢çš„æ™‚é–“ï¼Œå¦å‰‡åœ¨äº¤å·æœŸç¨‹çš„å£“åŠ›ä¸‹ï¼Œä½ è‚¯å®šæœƒåœŸæ³•ç…‰é‹¼è¶•ç·Šäº¤å·®äº†äº‹ã€‚\r\n\r\næ‰¾å‡ºç”Ÿæ´»ä¸­çš„æ‡‰ç”¨ç›®æ¨™\r\nè¨­å®šè¶³å¤ æ‰¾ç­”æ¡ˆçš„æ™‚é–“\r\n\r\næ‰¾å°‹æ‡‰ç”¨ç›®æ¨™\r\nå¯ä»¥å…ˆæœè‘—å¾ˆå¸¸ç¢°åˆ°ã€æ¯æ¬¡éƒ½èŠ±å¾ˆå¤šæ™‚é–“çš„æ–¹å‘å»æ‰¾é¡Œç›®ï¼ŒVBAçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯ç°¡åŒ–æµç¨‹ã€è™•ç†å¤§é‡çš„é‡è¤‡æ€§å•é¡Œï¼ŒåŒ…å«è³‡æ–™çš„å»ºæª”ã€åŒ¯å…¥ã€è¼¸å‡ºå ±è¡¨...ç­‰ï¼Œä¸€å€‹å°ˆæ¡ˆåªè¦å¯ä»¥éµå¾ª20/80æ³•å‰‡ï¼Œå…ˆè™•ç†80%çš„éº»ç…©äº‹ï¼Œå°æ–¼æ•´å€‹å°ˆæ¡ˆçš„åŸ·è¡Œå°±æœƒè¼•é¬†å¾ˆå¤šäº†!\r\n\r\nğŸ¯åŸºæœ¬æŠ€å·§\r\nç¨‹å¼ç¢¼åªæ˜¯ä¸€ç¨®æºé€šèªè¨€ï¼Œä¸éœ€è¦æŠŠæ•´æœ¬å­—å…¸æ‹¿å‡ºä¾†ä¸€å­—ä¸€å¥å»èƒŒï¼Œåªéœ€è¦æŒ‘é¸å°ä½ æœ‰å¹«åŠ©çš„èªæ³•ä¾†çµ„æˆå‰›å¥½å¯ä»¥è§£æ±ºä½ çš„å•é¡Œçš„å…§å®¹å°±å¥½ï¼Œå°æ–¼VBAä¾†èªªå¤§éƒ¨åˆ†çš„å…§å®¹ç¶²è·¯ä¸Šéƒ½æœƒæœ‰èªªæ˜ï¼Œä»¥ä¸‹æœƒå»ºè­°å­¸ç¿’é †åºèˆ‡åƒè€ƒè³‡æ–™\r\nè³‡æ–™åº«æ¦‚å¿µ\r\nåœ¨æ­£çµ±è³‡æ–™åº«çš„è¨­è¨ˆä¸Šæœ‰æ‰€è¬‚æ­£è¦åŒ–çš„æ¦‚å¿µï¼Œç›®çš„æ˜¯å°‡è³‡æ–™åº«çš„å…§å®¹ä»¥æœ€å°å–®å…ƒçš„æ–¹å¼é€²è¡Œï¼Œé€šå¸¸æ˜¯è¨˜éŒ„æ–‡å­—å…§å®¹è€Œå·²ï¼Œå¦‚æœ‰åœ–ç‰‡æˆ–æª”æ¡ˆå‰‡ä»¥å¤–éƒ¨é€£çµé€²è¡Œæ›¿ä»£ã€‚\r\nExcelçš„å–®å…ƒåˆ†é¡\r\n\r\nå„²å­˜æ ¼(cell)\r\næ¬„(column)ã€åˆ—(row)\r\nå·¥ä½œè¡¨(sheet)\r\næ´»é ç°¿(workbook)\r\n\r\nå„²å­˜æ ¼ä»¥æ¯æ ¼å­˜æ”¾ä¸€å€‹è³‡æ–™ç‚ºåŸå‰‡ï¼Œé¿å…è·¨æ ¼åˆä½µçš„æ–¹å¼é€²è¡Œè³‡æ–™å­˜æ”¾ã€‚\r\né–‹ç™¼äººå“¡ç’°å¢ƒ\r\nExcelé è¨­æœƒæŠŠé–‹ç™¼ç’°å¢ƒé—œèµ·ä¾†ï¼Œå…ˆæŠŠé–‹ç™¼ç’°å¢ƒé–‹èµ·ä¾†æ‰æœ‰åœ°æ–¹å¯«ç¨‹å¼ç¢¼ã€‚\r\nVBAç’°å¢ƒè¨­å®š-GT\r\nWang\r\né–‹ç™¼å–®å…ƒ\r\nSubçš„æ¦‚å¿µå…¶å¯¦å°±æ˜¯è…³æœ¬åŸ·è¡Œçš„å–®å…ƒï¼Œå¯ä»¥é€éæŒ‰éˆ•æŒ‡å®šå·¨é›†åŸ·è¡Œï¼Œä¹Ÿå¯ä»¥é€éå…¶ä»–Subä¾†å‘¼å«(call)åŸ·è¡Œï¼Œæ­¤å¤–Functionä¹Ÿæ˜¯é¡ä¼¼çš„æ¦‚å¿µï¼Œä¸éå®ƒé‚„å¯ä»¥é¡å¤–å›å‚³çµæœã€‚\r\nSub\r\nvs Function-GT Wang\r\nè³‡æ–™å‹æ…‹\r\né›–ç„¶VBAæœ¬èº«ä¸å¤ªè¦æ±‚æ­£ç¢ºçš„è³‡æ–™å‹æ…‹ï¼Œç®—æ˜¯æ¯”è¼ƒä¸åš´è¬¹çš„èªè¨€ï¼Œä½†äº†è§£ä¸€ä¸‹doubleã€stringã€integerã€dateã€objectä¹‹é–“çš„å·®ç•°æœƒæ¯”è¼ƒå¥½åœ¨ç¨‹å¼ç¢¼æœ€ä¸Šå±¤å¯«ä¸‹Option\r\nExplicitï¼Œæœƒä½¿æ’°å¯«éç¨‹å¿…é ˆè¦å®£å‘Šåƒæ•¸çš„è³‡æ–™å‹æ…‹ï¼Œæœ‰åŠ©æ–¼é”æˆè‰¯å¥½çš„ç¨‹å¼å¯«ä½œç¿’æ…£(æœªä¾†è½‰æ›åˆ°åˆ¥çš„èªè¨€æ¯”è¼ƒä¸æœƒé‚£éº¼ç—›è‹¦)ã€‚\r\nVBAè³‡æ–™å‹æ…‹-GT\r\nWang\r\né‚è¼¯æ“ä½œ\r\nè…³æœ¬åŸ·è¡Œéç¨‹é€šå¸¸æœƒæœ‰æ¢ä»¶åˆ¤æ–·è·Ÿè¿´åœˆå¾ªç’°ï¼Œæ ¹æ“šå¯¦éš›éœ€æ±‚æ¼”ç®—ï¼Œçœ‹ç¯„ä¾‹æ‰æœƒæ¸…æ¥šï¼Œä¸å¤–ä¹å°±æ˜¯\r\nif elseã€for i=1 to nã€do loop ...\r\nç­‰ã€‚æ­¤å¤–é—œæ–¼å¦‚ä½•åŠ æ¸›ä¹˜é™¤ã€ç­‰æ–¼ä¸ç­‰æ–¼ä¹‹é¡çš„é‹ç®—å­ä¹Ÿæ˜¯æœƒè¢«åƒé›œåœ¨å…¶ä¸­ï¼Œé€™ä¹Ÿæ˜¯å¿…é ˆè¦çŸ¥é“çš„ã€‚\r\nVBAé‹ç®—å­-GT\r\nWang\r\nVBAæ¢ä»¶åˆ¤æ–·-GT\r\nWang\r\nVBAè¿´åœˆæ§åˆ¶-GT\r\nWang\r\né™¤éŒ¯æŠ€å·§\r\nç¨‹å¼æ’°å¯«éç¨‹å¿…é ˆè¦çŸ¥é“æ‰€è¨­å®šçš„åƒæ•¸æ˜¯ä¸æ˜¯æœ‰å¦‚æƒ³åƒä¸­çš„åŸ·è¡Œï¼Œå› æ­¤å­¸æœƒåˆ©ç”¨debug.printåŠæŸ¥çœ‹å€åŸŸè®Šæ•¸è¦–çª—æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œçˆ¾å¾Œå†å°å…¥å–®å…ƒæ¸¬è©¦çš„æ¦‚å¿µå³å¯ã€‚\r\nExcel\r\nVBAçš„çœ‰çœ‰è§’è§’-é™¤éŒ¯æŠ€å·§\r\nä»‹é¢æ“ä½œ\r\nå°æ–¼ä½¿ç”¨è€…è€Œè¨€ï¼Œé€éæŒ‰æŒ‰éˆ•ä¾†åŸ·è¡Œç¨‹å¼ç¢¼éå¸¸ç›´è§€ï¼Œç¶“éå¤šå¹´çš„ä½¿ç”¨ç¿’æ…£å¤§éƒ¨åˆ†çš„æ“ä½œä»‹é¢éƒ½æ˜¯å¦‚æ­¤ï¼Œè‹¥æ˜¯åœ¨æ¯”è¼ƒå¤è€çš„ç¨‹å¼ä¹Ÿè¨±æœƒä½¿ç”¨èœå–®é€²è¡Œã€‚\r\næŒ‰éˆ•å¯ä»¥å‡ºç¾åœ¨å·¥ä½œè¡¨ä¹Ÿå¯ä»¥åœ¨è¡¨å–®(Userform)ï¼Œå·¥ä½œè¡¨æœ¬èº«ä¹Ÿå¯ä»¥ç®—æ˜¯ä¸€å€‹ä»‹é¢ï¼Œå¾ˆå¤šäººä¹Ÿæœƒä½¿ç”¨é€™æ¨£çš„è¨­è¨ˆæ–¹æ³•ï¼Œåœ¨å·¥ä½œè¡¨ä¸Šé¢æŒ‰æŒ‰éˆ•å»åŸ·è¡Œç›¸å°æ‡‰æµç¨‹ï¼Œç„¶è€Œè¡¨å–®çš„ä½¿ç”¨æ¯”è¼ƒå¯ä»¥è®“ä½¿ç”¨è€…ç…§è‘—è‡ªå·±çš„æµç¨‹é€²è¡Œï¼Œä¸æœƒè·³ä¾†è·³å»\r\n\r\nè¡¨å–®å±¬æ–¼æ¯”è¼ƒé€²éšçš„éƒ¨åˆ†ï¼Œå…ˆè®“ç¨‹å¼å¯ä»¥æŒ‰æŒ‰éˆ•åŸ·è¡Œå°±å¥½\r\n\r\nVBAæŒ‰éˆ•åŸ·è¡Œ-GT\r\nWang\r\nç™¼å¸ƒæ–¹å¼\r\nç¨‹å¼å¯«å®Œä¹‹å¾Œï¼Œåœ¨æœ¬æ©Ÿå¯ä»¥ç›´æ¥é–‹å§‹ä½¿ç”¨é€šå¸¸æ²’æœ‰å•é¡Œï¼Œæ€•å°±æ˜¯æœƒé‡åˆ°å·¨é›†å°é–é€™é¡çš„å®‰å…¨æ€§ä¿è­·æ©Ÿåˆ¶ï¼Œå°æ–¼ä¸€èˆ¬ä½¿ç”¨è€…ä¾†èªªï¼Œçœ‹åˆ°é€™å€‹å°±æœƒå¿ƒç”Ÿç–‘æ…®ï¼Œå¦‚æœé–‹ç™¼è€…æ˜¯ä½ å¯ä¿¡ä»»çš„å°±å¯ä»¥è§£é™¤å°é–æˆ–è€…åŠ å…¥ç™½åå–®å°±å¥½ã€‚\r\nè§£é™¤å°é–å·¨é›†\r\nåŠ å…¥ç™½åå–®\r\nâš™ï¸æ‹†è§£å–®å…ƒ\r\nè§£æ±ºå•é¡Œçš„æ–¹æ³•è‹¥èƒ½å¤ é€²è¡Œè‰¯å¥½çš„æ‹†è§£å°æ–¼ç¨‹å¼ç¢¼çš„æ’°å¯«éç¨‹æœƒæœ‰æ¥µå¤§çš„å¹«åŠ©ï¼Œä¹Ÿæœ‰åŠ©æ–¼é‡æ¸…æ€ç·’ä¸¦åœ¨æ¬¡å–®å…ƒçš„å®Œæˆéç¨‹ä¸­ç²å¾—æ»¿æ»¿çš„æˆå°±æ„Ÿï¼Œæ¯å€‹æ¡ˆå­éƒ½æœƒæœ‰è‡ªå·±çš„å¿ƒæ™ºåœ–ï¼Œæ¯ä¸€å€‹åˆ†æ”¯éƒ½æœ‰è‡ªå·±è¦å®Œæˆçš„äº‹ï¼Œå…‰ä¸€å€‹ç”¢ç”Ÿå ±è¡¨çš„è¡Œç‚ºï¼Œå°±èƒ½æ‹†è§£æˆ\r\n\r\nå»å“ªè£¡æ‰¾è³‡æ–™\r\næ”¶åˆ°è³‡æ–™è¦å¦‚ä½•ç¯©é¸\r\nç¯©é¸è³‡æ–™è¦å¦‚ä½•æ’åº\r\næ’åºå®Œè¦æ”¾å…¥å ±è¡¨\r\nå ±è¡¨ç”¢å‡ºæ˜¯ä»€éº¼æ ¼å¼\r\n\r\n\r\nç¨‹å¼ç¢¼å°±æ˜¯ä¸€é€£ä¸²çš„å°æµç¨‹ï¼Œä¸æ–·çš„å †ç–Šè€Œæˆçš„å°ˆæ¡ˆ\r\n\r\nä¸è¦å¤ªè²ªå¿ƒä¸€æ¬¡æƒ³è¦å®Œæˆå…¨éƒ¨çš„åŠŸèƒ½ï¼Œé€ésubæˆ–è€…functionæŠŠæ¯å€‹éšæ®µè¦åšçš„äº‹æƒ…åšè‰¯å¥½çš„æ‹†è§£ä¸¦å®Œæˆï¼Œæ¯”è¼ƒä¸æœƒä¸­é€”æ”¾æ£„ï¼Œä¹‹å¾Œåœ¨åµéŒ¯éç¨‹æ¯”è¼ƒå¥½äº†è§£å“ªé‚Šæœ‰éŒ¯èª¤ã€‚\r\n\r\nğŸ”å°‹æ‰¾ç­”æ¡ˆ\r\n\r\nå°‹æ‰¾ç­”æ¡ˆæ™‚ï¼Œå¿…é ˆè¦äº†è§£å¦‚ä½•æ¸…æ¥šæè¿°å•é¡Œï¼Œæ²’æœ‰äººæœ‰è¾¦æ³•å›ç­”ä¸æ˜ç¢ºçš„å…§å®¹ã€‚\r\n\r\nè²·æ›¸çš„å¿…è¦?\r\nç•¶åˆæˆ‘ç‚ºäº†å­¸ç¿’é€™é …èªè¨€è²·äº†ä¸ä¸‹10æœ¬å·¥å…·æ›¸ï¼Œç™¼ç¾å…¶å¯¦éƒ½å¤§åŒå°ç•°ï¼Œåˆå­¸è€…å¯ä»¥å»åœ–æ›¸é¤¨æ‰¾ä¸€æœ¬é †çœ¼çš„ä¾†çœ‹åŸºæœ¬èªæ³•ï¼Œæœ‰ç¯„ä¾‹çš„é‚£ç¨®æœ€å¥½ã€‚é€™ä¸€æ­¥æ˜¯ç‚ºäº†è¦è®“ä½ ç¢ºå®šä½ å–œä¸å–œæ­¡VBAï¼Œä¸å»ºè­°ä¸€é–‹å§‹å°±èŠ±éŒ¢ã€‚\r\nè‹¥æ˜¯è¦ºå¾—è‡ªå·±çœŸçš„çœ‹å¾—æ‡‚çš„æ™‚å€™ï¼Œæˆ‘å»ºè­°è²·ä¸€æœ¬æ¯”è¼ƒæ–°çš„ä¾†ç•¶ä½œå·¥å…·æ›¸(ç•¢ç«Ÿæ›¸æ¯”è¼ƒä¾¿å®œ?)ï¼Œå·¥å…·æ›¸çš„æ„ç¾©å°±æ˜¯éœ€è¦çš„æ™‚å€™å†ä¾†æŸ¥ï¼ŒæŸ¥å€‹å¹¾æ¬¡åŸºæœ¬ä¸Šç†Ÿæ‚‰äº†ï¼Œæ­¤æ™‚ä¹Ÿæœƒæœ‰ä¸€äº›å¯¦ä½œç¨‹å¼ç¢¼ç¯„ä¾‹ç•™å­˜åœ¨é›»è…¦ä¸­ï¼Œç­‰ä¹‹å¾Œé‡åˆ°åŒæ¨£çš„å•é¡Œå°±æœƒçŸ¥é“å“ªé‚Šæœ‰å¯«éï¼Œç›´æ¥è¤‡è£½è²¼ä¸Š(?)ã€‚\r\nAIæ™‚ä»£ä¾†è‡¨\r\nAIæ™‚ä»£çš„é€²æ­¥è®“ä¸Šè¿°çš„æµç¨‹åˆèƒ½æ›´åŠ ç²¾ç°¡ï¼Œç•¶ç„¶ä¸Šç¶²googleæ‰¾ç­”æ¡ˆé‚„æ˜¯éœ€è¦çš„ï¼Œæœ‰æ™‚å•AIå•é¡Œè‹¥ä¸å¤ ç²¾ç¢ºæ™‚æœƒç”¢ç”Ÿå¹»è¦ºï¼Œè¤‡è£½è²¼ä¸Šçš„ç¨‹å¼ç¢¼å‹•ä¸èµ·ä¾†å°±æ˜¯å‹•ä¸èµ·ä¾†ï¼Œç•¢ç«Ÿ...ç¨‹å¼ç¢¼æœƒå¡ä½é‚£å°±æ˜¯ç„¡æ•ˆå…§å®¹ï¼Œç‚ºäº†è®“ä»–100%å¯ä»¥é‹ä½œæœ‰æ™‚å€™é‚„æ˜¯éœ€è¦äººå·¥ä»‹å…¥ã€‚\r\nå•å•é¡Œçš„æ–¹æ³•\r\nç•¶ä½ ç‚ºäº†é€™é …å•é¡ŒåŠªåŠ›è©¦è‘—å»æ‰¾ç­”æ¡ˆæ™‚ç™¼ç¾çœŸçš„ç„¡æ³•è§£æ±ºï¼Œåªè¦é¡˜æ„æŠŠä½ çš„ç¯„ä¾‹ã€æ“ä½œæ­¥é©Ÿã€çˆ¬æ–‡å…§å®¹çµ¦æè¿°æ¸…æ¥šï¼Œç›¸ä¿¡é‚„æ˜¯æœ‰é¡˜æ„å¹«åŠ©ä½ çš„äºº(ç•¢ç«Ÿåœ¨ç¤¾æœƒä¸Šæ²’æœ‰äººæœ‰ç¾©å‹™å›ç­”ä½ çš„å•é¡Œï¼Œä¸€åˆ‡éƒ½æ˜¯è‰¯å¿ƒé©…ä½¿)ã€‚\r\nç¯„ä¾‹\r\nå¯ä»¥æ˜¯æª”æ¡ˆã€æˆªåœ–ã€è¢å¹•éŒ„å½±\r\næ“ä½œæ­¥é©Ÿ\r\næè¿°å®Œæ•´çš„æ“ä½œéç¨‹ï¼Œæ¯ä¸€æ¬¡éç¨‹é æœŸæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Œä½†ç¾åœ¨ç™¼ç”Ÿä»€éº¼å•é¡Œ\r\nçˆ¬æ–‡å…§å®¹\r\næŠŠç›®å‰é‡åˆ°çš„å•é¡Œå•AIæˆ–Googleæœå°‹ï¼Œå˜—è©¦éå“ªäº›æ–¹æ³•?\r\nå¥½ç«™é€£çµ\r\nğŸ”—PAPAYAé›»è…¦æ•™å®¤-EXCELåŸºæœ¬æ•™å­¸\r\nğŸ”—ITé‚¦å¹«å¿™-ExcelVBAçš„çœ‰çœ‰è§’è§’\r\nğŸ”—VBAç¨‹å¼è¨­è¨ˆ-GT.Wang\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA"]},{"title":"VBAç·¨è¼¯å™¨ä¸Šçš„ç‰ˆæœ¬æ§åˆ¶","url":"/posts/3829840047/","content":"å‰è¨€\r\nåœ¨æ’°å¯«ç¨‹å¼ç¢¼æ™‚ï¼Œè¨±å¤šäººç¿’æ…£å°‡ç¨‹å¼èˆ‡æª”æ¡ˆç¶å®šï¼Œä¸¦åˆ©ç”¨æ–‡ä»¶åç¨±ä¾†æ¨™è¨˜æ¯æ¬¡ç‰ˆæœ¬çš„ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼Œå°‡ç•¶å¤©æ—¥æœŸåŠ åœ¨æª”æ¡ˆåç¨±å¾Œä¾†å€éš”ç‰ˆæœ¬ï¼Œå¦‚\r\nç¸±æ–·é¢ç¹ªåœ–20230622.xlsã€‚é€™æ˜¯æˆ‘éå»å°ç‰ˆæœ¬æ§åˆ¶çš„ç†è§£ï¼Œç„¶è€Œï¼Œé€™æ¨£åšçš„å•é¡Œæ˜¯æª”æ¡ˆæ•¸é‡å¿«é€Ÿå¢é•·ï¼Œä¸”æª”æ¡ˆåç¨±ç„¡æ³•æ¸…æ¥šæ¨™ç¤ºæ¯æ¬¡ä¿®æ”¹çš„å…·é«”å…§å®¹ã€‚\r\næ›´ç³Ÿçš„æ˜¯ï¼Œç•¶é€™äº›æª”æ¡ˆåˆ†æ•£æ–¼ä¸åŒçš„é›»è…¦å’Œè³‡æ–™å¤¾ä¸­ï¼Œè‹¥åŒåçš„æª”æ¡ˆæœ‰æ‰€ä¸åŒï¼Œå»ç„¡æ³•å¾—çŸ¥å…·é«”æ”¹å‹•äº†å“ªäº›éƒ¨åˆ†ã€‚é€™æ¨£çš„ç®¡ç†æ–¹å¼æœƒé€ æˆå¾ˆå¤§çš„å›°æ“¾ï¼Œä¹Ÿä¿ƒä½¿æˆ‘é–‹å§‹å°‹æ‰¾æ›´æœ‰æ•ˆçš„ç‰ˆæœ¬æ§åˆ¶æ–¹æ³•ã€‚\r\nå› æ­¤ï¼Œæˆ‘é–‹å§‹æ¢ç´¢å¦‚ä½•åœ¨ VBA ä¸­å¯¦ç¾ã€ŒçœŸã€ç‰ˆæœ¬æ§åˆ¶ï¼Œä¸¦çµåˆ\r\nGit ä¾†ç®¡ç†ç¨‹å¼ç¢¼ã€‚\r\næ›´æ–°è¨»è¨˜ (2024/05/19)\r\nç•¶æˆ‘å°‡ç¨‹å¼ä¸Šå‚³è‡³ GitHub æ™‚ï¼Œç™¼ç¾å› ç‚ºç­†è¨˜æœ¬çš„é è¨­ç·¨ç¢¼ç‚º\r\n\"ANSI\"ï¼Œä¸Šå‚³çš„ä¸­æ–‡éƒ¨åˆ†æœƒé¡¯ç¤ºç‚ºäº‚ç¢¼ã€‚ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å°‡ç·¨ç¢¼å¦å­˜ç‚º\r\n\"UTF-8\"ï¼Œé€™æ¨£å¯ä»¥æ­£å¸¸é¡¯ç¤ºã€‚ä½†æ˜¯ï¼Œè‹¥å°‡ \"UTF-8\" ç·¨ç¢¼åŒ¯å…¥ Excel VBA IDE\r\næ™‚ï¼Œç”±æ–¼ Excel é è¨­æ”¯æ´ ANSI ç·¨ç¢¼ï¼Œä¸­æ–‡æœƒå‡ºç¾éŒ¯èª¤ã€‚\r\n\r\nç·¨è¼¯å™¨é–‹ç™¼ç’°å¢ƒ\r\nåœ¨æ’°å¯« VBA ç¨‹å¼ç¢¼æ™‚ï¼Œä¸»è¦æœƒæœ‰ä»¥ä¸‹å¹¾å€‹å€åŸŸä¾†æ”¾ç½®ç¨‹å¼ç¢¼ï¼š\r\n\r\nExcel ç‰©ä»¶ï¼ˆå¦‚ ThisWorkbook, Worksheetï¼‰\r\næ¨¡çµ„ï¼ˆModuleï¼‰\r\nç‰©ä»¶é¡åˆ¥æ¨¡çµ„ï¼ˆClassï¼‰\r\nè¡¨å–®ï¼ˆFormï¼‰\r\n\r\nåœ¨é€™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å‡è¨­ç¨‹å¼ç¢¼ä¸¦æœªç›´æ¥å¯«åœ¨ Worksheet\r\nä¸­ï¼Œå› ç‚ºé€™æ¨£çš„ç¨‹å¼ç¢¼æœƒå¸¶ä¾†è¨±å¤šåŒ¯å…¥ä¸Šçš„éº»ç…©ã€‚è€Œ ThisWorkbook\r\né›–ç„¶å±¬æ–¼ doccls\r\né¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä½†å…¶ä¸­å¯èƒ½æœƒæœ‰éœ€è¦æ‰‹å‹•è™•ç†çš„ç‰¹æ®Šæƒ…æ³ï¼Œé–‹ç™¼è€…éœ€æ ¹æ“šéœ€è¦è‡ªè¡Œè™•ç†é€™äº›å…§å®¹ã€‚\r\nGIT åŸºæœ¬æ“ä½œ\r\nå°æ–¼ GIT\r\nçš„åŸºæœ¬æ“ä½œï¼Œç¶²è·¯ä¸Šæœ‰è¨±å¤šè³‡æºå¯ä»¥åƒè€ƒã€‚æ„Ÿè¬å…­è§’å­¸é™¢çš„Youtubeæ•™å­¸ã€‚\r\nå¸¸è¦‹çš„ GIT æ“ä½œå¦‚ä¸‹ï¼š\r\n\r\ngit initï¼šåˆå§‹åŒ–è³‡æ–™å¤¾\r\ngit addï¼šå°‡æª”æ¡ˆåŠ å…¥ç´¢å¼•\r\ngit commitï¼šæäº¤ç‰ˆæœ¬è¨»è¨˜\r\ngit pushï¼šå°‡ç¨‹å¼ç¢¼ä¸Šå‚³è‡³ GitHub\r\ngit cloneï¼šå¾ GitHub ä¸‹è¼‰ç¨‹å¼ç¢¼\r\ngit fetchï¼šå¾ GitHub ä¸‹è¼‰ä¸¦æ›´æ–°è‡³æœ¬åœ°è³‡æ–™å¤¾\r\ngit checkoutï¼šåˆ‡æ›åˆ†æ”¯æˆ–ç‰ˆæœ¬\r\n\r\næ“ä½œæ­¥é©Ÿ\r\n\r\nå•Ÿç”¨ VBA è¨­å®šï¼šåœ¨ Excel\r\nä¸­ï¼Œæ‰“é–‹ã€Œé–‹ç™¼è€…ã€é¸å–®ï¼Œä¸¦é¸æ“‡ã€Œä¿¡ä»»å­˜å– VBA å°ˆæ¡ˆç‰©ä»¶æ¨¡å‹ã€ã€‚\r\nåˆå§‹åŒ– Gitï¼šæ‰“é–‹ Git Bashï¼ŒæŒ‡å®šä¸€å€‹è³‡æ–™å¤¾ä¸¦åŸ·è¡Œ\r\ngit initã€‚\r\nåŒ¯å…¥ Git æ¨¡çµ„ï¼šåœ¨ç›®å‰çš„ VBA IDE ä¸­åŒ¯å…¥\r\nGIT.bas æ¨¡çµ„ã€‚\r\nå°å‡ºç¨‹å¼ç¢¼ï¼šåŸ·è¡Œå·¨é›†\r\nExportCodesToFolderï¼Œä¸¦é¸æ“‡ç¬¬äºŒæ­¥ä¸­æŒ‡å®šçš„è³‡æ–™å¤¾ã€‚\r\nç¢ºèªç‰ˆæœ¬ï¼šè‹¥ç¢ºå®šç„¡èª¤ï¼Œç¹¼çºŒä½¿ç”¨ Git\r\né€²è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚è‹¥æœ‰ä»»ä½•å•é¡Œï¼Œå›åˆ°ç¬¬ 4 æ­¥é‡æ–°æª¢æŸ¥ã€‚\r\né€²è¡Œ Git æ“ä½œï¼šä½¿ç”¨ Git Bash é€²è¡Œ\r\ngit addã€git commitã€git push\r\nç­‰æ“ä½œã€‚\r\n\r\nè™•ç†ç¨‹å¼ç¢¼ç‰ˆæœ¬å•é¡Œ\r\nè‹¥ç™¼ç¾é–‹å•Ÿç¨‹å¼ç¢¼å¾Œç™¼ç¾æœ‰å•é¡Œï¼Œå¯ä»¥åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š\r\n\r\nåœ¨ VBA IDE ä¸­åŒ¯å…¥ GIT æ¨¡çµ„ã€‚\r\nåŸ·è¡Œ DeleteCodes ä¾†åˆªé™¤èˆŠæœ‰çš„ç¨‹å¼ç¢¼ã€‚\r\nåŸ·è¡Œ\r\nImportCodesï¼Œä¸¦é¸æ“‡æŒ‡å®šçš„è³‡æ–™å¤¾ä¾†åŒ¯å…¥æœ€æ–°ç‰ˆæœ¬çš„ç¨‹å¼ç¢¼ã€‚\r\n\r\nVBA ç¨‹å¼ç¢¼ç¯„ä¾‹\r\nä»¥ä¸‹æ˜¯ä½¿ç”¨ Git æ§åˆ¶ VBA ç¨‹å¼ç¢¼ç‰ˆæœ¬çš„æ ¸å¿ƒç¨‹å¼ç¢¼ç¯„ä¾‹ï¼š\r\n&#x27;TODO:Export folder need to be killedSub ExportCodesToFolder()&#x27;Type: 1=bas,2=cls,3=frmmyFolder = getSavedFolderCall killFilesInFolder(myFolder)Set VBProj = ThisWorkbook.VBProjectFor Each VBComp In VBProj.VBComponents        Select Case VBComp.Type            Case 1: myExtension = &quot;.bas&quot;        Case 2: myExtension = &quot;.cls&quot;        Case 3: myExtension = &quot;.frm&quot;                Case 100: myExtension = &quot;.doccls&quot;        End Select        full_path = myFolder &amp; &quot;\\&quot; &amp; VBComp.Name &amp; myExtension        If myExtension &lt;&gt; &quot;&quot; Then            VBComp.Export (full_path)        End If        If myExtension = &quot;.doccls&quot; And CountFileLines(full_path) = 9 Then Kill full_path    Next VBComp    End SubSub killFilesInFolder(folderPath)Set coll_path = GetFilePathsInFolder(folderPath)For Each filePath In coll_path    Filename = mid(filePath, InStrRev(filePath, &quot;\\&quot;) + 1)    fileExtension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)        If fileExtension = &quot;frm&quot; Or fileExtension = &quot;bas&quot; Or fileExtension = &quot;cls&quot; Or fileExtension = &quot;doccls&quot; Then        Kill filePath    End IfNextEnd SubSub ImportCodes()myFolder = getSavedFolderSet coll_path = GetFilePathsInFolder(myFolder)Call DeleteCodesFor Each filePath In coll_path    Filename = mid(filePath, InStrRev(filePath, &quot;\\&quot;) + 1)    fileExtension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)        If fileExtension = &quot;frm&quot; Or fileExtension = &quot;bas&quot; Or fileExtension = &quot;cls&quot; Then        Call ImportCode(filePath, Filename)    End IfNextEnd SubSub ImportCode(ByVal filePath As String, ByVal Filename As String)extension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)CodeName = mid(Filename, 1, InStrRev(Filename, &quot;.&quot;) - 1)If CodeName = &quot;GIT&quot; Then Exit SubSet VBProj = ThisWorkbook.VBProject&#x27;If checkIfCodeExist(CodeName) = True Then&#x27;&#x27;    Set vbcomp = VBProj.VBComponents(CodeName)&#x27;    VBProj.VBComponents.Remove (vbcomp)&#x27;&#x27;End IfVBProj.VBComponents.Import (filePath)End SubSub DeleteCodes()&#x27;Type: 1=bas,2=cls,3=frmSet VBProj = ThisWorkbook.VBProjectFor Each VBComp In VBProj.VBComponents        Select Case VBComp.Type            Case 1: myExtension = &quot;.bas&quot;        Case 2: myExtension = &quot;.cls&quot;        Case 3: myExtension = &quot;.frm&quot;                Case 100: myExtension = &quot;.doccls&quot;        End Select        If VBComp.Type &lt;&gt; 100 And VBComp.Name &lt;&gt; &quot;GIT&quot; Then        VBProj.VBComponents.Remove (VBComp)            End If    Next VBCompEnd Sub&#x27;--------FUNCTION------------Function GetFilePathsInFolder(ByVal folderPath As String)    Dim coll As New Collection    Dim fso As Object    &#x27;Dim folderPath As String    Dim folder As Object    Dim file As Object    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)   &#x27; folderPath = getSavedFolder    Set folder = fso.GetFolder(folderPath)        For Each file In folder.Files        coll.Add file.Path            Next file        Set file = Nothing    Set folder = Nothing    Set fso = Nothing        Set GetFilePathsInFolder = coll    End FunctionFunction getSavedFolder()    Set fldr = Application.FileDialog(4)        With fldr        .Title = &quot;Select a Folder&quot;        .AllowMultiSelect = False        .InitialFileName = ThisWorkbook.Path        If .Show = -1 Then FolderName = .SelectedItems(1)    End WithgetSavedFolder = FolderNameEnd FunctionFunction checkIfCodeExist(ByVal checkName As String) &#x27;uselessSet VBProj = ThisWorkbook.VBProjectSet VBComps = VBProj.VBComponentscheckIfCodeExist = FalseFor Each it In VBComps    If it.Name = checkName Then                checkIfCodeExist = True: Exit Function            End IfNextEnd FunctionFunction CountFileLines(ByVal filePath)    Dim FileContent As String    Dim fileNumber As Integer    Dim lineCount As Long        &#x27; Open the text file    fileNumber = FreeFile    Open filePath For Input As fileNumber        &#x27; Read the file content line by line and count the lines    Do Until EOF(fileNumber)        Line Input #fileNumber, FileContent        lineCount = lineCount + 1    Loop        &#x27; Close the file    Close fileNumber        &#x27; Display the line count in cell A1    CountFileLines = lineCount    End Function&#x27;--------TMP_CODE-------------Function tmp_deleteCodes()Set VBProj = ThisWorkbook.VBProjectSet VBComps = VBProj.VBComponentsFor Each it In VBComps        If it.Name Like &quot;*2&quot; And it.Type &lt;&gt; 100 Then        CodeName = it.Name                Set VBComp = VBProj.VBComponents(CodeName)        VBProj.VBComponents.Remove (VBComp)            End If    NextEnd Function\r\n","categories":["åŸºæœ¬åŸç†"],"tags":["GIT","Github"]},{"title":"pythonè£½ä½œå·¥ç¨‹è¨­è¨ˆç°¡åœ–","url":"/posts/3601177192/","content":"å‰è¨€\r\nåœ–è¡¨è·Ÿåœ–ç‰‡éƒ½æ˜¯ç”¨ä¾†è®“ç¶²é å…ƒç´ æ›´ç‚ºè±å¯Œçš„æ‰‹æ®µï¼Œåœ–è¡¨ç‚ºæ•¸æ“šçµ±è¨ˆå¾Œçš„æˆæœã€åœ–ç‰‡å‰‡ç‚ºå°‡æŠ½è±¡çš„æ–‡å­—è½‰æ›æˆåœ–ç‰‡å½¢å¼é€²è¡Œè¼¸å‡º(æ¯”å¦‚æ¸ é“çš„é•·ç›¸)ï¼ŒæŠ½è±¡çš„æ–‡å­—å¾€å¾€ä¸æ¯”åœ–ç‰‡çš„ä»‹ç´¹ä¾†çš„å®¹æ˜“æ¥å—è¨±å¤šï¼Œè€Œé€™ä¹Ÿæ˜¯è³‡æ–™å¯è¦–åŒ–çš„ç›®æ¨™ä¹‹ä¸€ã€‚\r\nä½¿ç”¨æƒ…å¢ƒ\r\nåœ¨æå ±å·¥ç¨‹æ¦‚è¦è¡¨æ™‚ï¼Œæœƒéœ€è¦è®“ä¸Šé¢äº†è§£æœªä¾†è¦æ–½ä½œçš„å·¥ç¨‹å…§å®¹ï¼Œå› æ­¤æœƒæ‹æ”ç¾å ´çš„ç…§ç‰‡åŠé™„ä¸Šå·¥ç¨‹è¨­è¨ˆç°¡åœ–ï¼Œè€Œå·¥ç¨‹è¨­è¨ˆç°¡åœ–çš„è£½ä½œéç¨‹éå¸¸ç¹ç‘£ï¼Œæ“ä½œéç¨‹å¦‚ä¸‹:\r\n\r\né–‹å•ŸCAD\r\nç•«å‡ºæ¸ é“å½¢ç‹€ã€æ¨™ç¤ºæ–‡å­—å…§å®¹\r\né è¦½åˆ—å°\r\næˆªåœ–é è¦½åˆ—å°å…§å®¹å¦å­˜æˆåœ–ç‰‡æª”\r\nåœ–ç‰‡æª”è²¼é™„åˆ°Excelä¸Šé¢\r\n\r\nå› æ­¤æœ¬æ¬¡å°ˆæ¡ˆé æœŸæœƒè®“ä½¿ç”¨è€…è¼¸å…¥æ¸ é“çš„å°ºå¯¸ã€å‘¨é‚Šç’°å¢ƒé—œä¿‚ä¾†è£½ä½œä¸€å¼µç°¡åœ–ï¼Œæ”¾ç½®æ–¼\"å·¥ç¨‹æ¦‚è¦è¡¨\"è®“é•·å®˜äº†è§£æœªä¾†è¦æ–½ä½œçš„å·¥ç¨‹å…§å®¹ï¼Œåˆ©ç”¨pythonçš„PILå¥—ä»¶ç¸®çŸ­ç¹ªè£½å·¥ç¨‹è¨­è¨ˆç°¡åœ–çš„æµç¨‹ã€‚\r\n\r\nåŸºæœ¬æ¦‚å¿µ\r\nPILå…¨åç‚ºPillowï¼Œæ˜¯ç›®å‰åœ¨é–‹ç™¼pythonæ™‚å¸¸ç”¨çš„ä¸€é …ç¹ªåœ–å·¥å…·\r\n\r\nåº§æ¨™é—œä¿‚\r\n\r\nPILä»¥ç¬¬äºŒè±¡é™é–‹å§‹ï¼ŒXå¾€å³éå¢ï¼ŒYå¾€ä¸‹éå¢ã€‚\r\nCADä»¥ç¬¬ä¸€è±¡é™é–‹å§‹ï¼ŒXå¾€å³éå¢ï¼ŒYå¾€ä¸Šéå¢ã€‚\r\n\r\nå…ƒç´ ç”¨æ³•\r\n\r\nç•«ç·š\r\ndef draw_line(draw, start_point, end_point, fill=&#x27;black&#x27;, width=3):    draw.line([start_point, end_point], fill=fill, width=width)\r\nç•«å¤šæ®µç·š\r\ndef draw_polyline(draw, points, fill=&#x27;black&#x27;, width=3):    draw.line(points, fill=fill, width=width)\r\nå¯«æ–‡å­—\r\ndef draw_text(draw, text, position, font_size, font_path, fill=&#x27;black&#x27;):    font = ImageFont.truetype(font_path, font_size)    draw.text(position, text, font=font, fill=fill)\r\n\r\né€™è£¡çš„font_pathå¦‚æœæ˜¯ä¸­æ–‡ï¼Œå¯èƒ½æœƒæœ‰å‡ºç¾äº‚ç¢¼çš„å•é¡Œï¼Œå¯ä»¥å…ˆå»Google\r\nfontä¹‹é¡å…ˆä¸‹è¼‰ä¸‹ä¾†åˆ°é–‹ç™¼ç›®éŒ„è®“ä»–å¼•ç”¨ã€‚ç›®å‰ä¸­æ–‡çš„éƒ¨åˆ†æˆ‘ç”¨NotoSansTC-Regular.ttf\r\n\r\nå¡«å……ç·š\r\ndef draw_polygon(draw, points, outline=&#x27;black&#x27;, fill=None, width=3):    draw.polygon(points, outline=outline, fill=fill)    if fill:        draw.line(points + [points[0]], fill=outline, width=width)        def draw_gradient_polygon(draw, vertices, start_color, end_color):    &quot;&quot;&quot;    ç¹ªè£½æ¼¸å±¤é¡è‰²çš„å¤šé‚Šå½¢    :param draw: PIL.ImageDrawå°è±¡    :param vertices: å¤šé‚Šå½¢é ‚é»åº§æ¨™åˆ—è¡¨ [(x1, y1), (x2, y2), ...]    :param start_color: é–‹å§‹é¡è‰² (r, g, b)    :param end_color: çµæŸé¡è‰² (r, g, b)    &quot;&quot;&quot;    x_coords, y_coords = zip(*vertices)    min_y, max_y = min(y_coords), max(y_coords)    height = max_y - min_y    gradient_colors = create_gradient_color(start_color, end_color, height)    for i, color in enumerate(gradient_colors):        draw.line([(min(x_coords), min_y + i), (max(x_coords), min_y + i)], fill=color)        \r\næ¨™è¨»å°ºå¯¸\r\ndef draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path,dim_space=20,arrow_length=10):    text_color=&#x27;#e85fd6&#x27;    # font_size=30    if Y1_DIM==Y2_DIM:        dim_txt=str(int(X2_DIM-X1_DIM))        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/2-font_size/2,(Y1_DIM+Y2_DIM)/2-font_size*2.5-dim_space), font_size, font_path, fill=text_color)        draw_line(draw, (X1_DIM, Y1_DIM-dim_space), (X1_DIM, Y1_DIM-arrow_length-dim_space), fill=text_color, width=1)        draw_line(draw, (X2_DIM, Y2_DIM-dim_space), (X2_DIM, Y2_DIM-arrow_length-dim_space), fill=text_color, width=1)        draw_line(draw, (X1_DIM, Y1_DIM-arrow_length/2-dim_space), (X2_DIM, Y2_DIM-arrow_length/2-dim_space), fill=text_color, width=1)        elif X1_DIM==X2_DIM:        dim_txt=str(int(Y2_DIM-Y1_DIM))        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/2-dim_space-2.5*font_size,(Y1_DIM+Y2_DIM)/2-font_size), font_size, font_path, fill=text_color)        draw_line(draw, (X1_DIM-dim_space, Y1_DIM), (X1_DIM-arrow_length-dim_space, Y1_DIM), fill=text_color, width=1)        draw_line(draw, (X2_DIM-dim_space, Y2_DIM), (X2_DIM-arrow_length-dim_space, Y2_DIM), fill=text_color, width=1)        draw_line(draw, (X1_DIM-arrow_length/2-dim_space, Y1_DIM), (X2_DIM-arrow_length/2-dim_space, Y2_DIM), fill=text_color, width=1)\r\né æœŸæˆæœ\r\n\r\n\r\nFig1.å·¥ç¨‹è¨­è¨ˆç°¡åœ–\r\n\r\nå®Œæ•´åšæ³•\r\nfrom PIL import Image, ImageDraw, ImageFontdef draw_text(draw, text, position, font_size, font_path, fill=&#x27;black&#x27;):    font = ImageFont.truetype(font_path, font_size)    draw.text(position, text, font=font, fill=fill)def draw_line(draw, start_point, end_point, fill=&#x27;black&#x27;, width=3):    draw.line([start_point, end_point], fill=fill, width=width)def draw_polygon(draw, points, outline=&#x27;black&#x27;, fill=None, width=3):    draw.polygon(points, outline=outline, fill=fill)    if fill:        draw.line(points + [points[0]], fill=outline, width=width)def draw_polyline(draw, points, fill=&#x27;black&#x27;, width=3):    draw.line(points, fill=fill, width=width)def create_gradient_color(start_color, end_color, height):    &quot;&quot;&quot;    å‰µå»ºå‚ç›´æ¼¸å±¤é¡è‰²åˆ—è¡¨    :param start_color: é–‹å§‹é¡è‰² (r, g, b)    :param end_color: çµæŸé¡è‰² (r, g, b)    :param height: é«˜åº¦ï¼ˆæ¼¸å±¤çš„ç¸½è¡Œæ•¸ï¼‰    :return: æ¼¸å±¤é¡è‰²åˆ—è¡¨    &quot;&quot;&quot;    gradient = []    for i in range(height):        ratio = i / height        r = int(start_color[0] * (1 - ratio) + end_color[0] * ratio)        g = int(start_color[1] * (1 - ratio) + end_color[1] * ratio)        b = int(start_color[2] * (1 - ratio) + end_color[2] * ratio)        gradient.append((r, g, b))    return gradientdef draw_gradient_polygon(draw, vertices, start_color, end_color):    &quot;&quot;&quot;    ç¹ªè£½æ¼¸å±¤é¡è‰²çš„å¤šé‚Šå½¢    :param draw: PIL.ImageDrawå°è±¡    :param vertices: å¤šé‚Šå½¢é ‚é»åº§æ¨™åˆ—è¡¨ [(x1, y1), (x2, y2), ...]    :param start_color: é–‹å§‹é¡è‰² (r, g, b)    :param end_color: çµæŸé¡è‰² (r, g, b)    &quot;&quot;&quot;    x_coords, y_coords = zip(*vertices)    min_y, max_y = min(y_coords), max(y_coords)    height = max_y - min_y    gradient_colors = create_gradient_color(start_color, end_color, height)    for i, color in enumerate(gradient_colors):        draw.line([(min(x_coords), min_y + i), (max(x_coords), min_y + i)], fill=color)def draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path,dim_space=20,arrow_length=10):    text_color=&#x27;#e85fd6&#x27;    # font_size=30    if Y1_DIM==Y2_DIM:        dim_txt=str(int(X2_DIM-X1_DIM))        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/2-font_size/2,(Y1_DIM+Y2_DIM)/2-font_size*2.5-dim_space), font_size, font_path, fill=text_color)        draw_line(draw, (X1_DIM, Y1_DIM-dim_space), (X1_DIM, Y1_DIM-arrow_length-dim_space), fill=text_color, width=1)        draw_line(draw, (X2_DIM, Y2_DIM-dim_space), (X2_DIM, Y2_DIM-arrow_length-dim_space), fill=text_color, width=1)        draw_line(draw, (X1_DIM, Y1_DIM-arrow_length/2-dim_space), (X2_DIM, Y2_DIM-arrow_length/2-dim_space), fill=text_color, width=1)        elif X1_DIM==X2_DIM:        dim_txt=str(int(Y2_DIM-Y1_DIM))        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/2-dim_space-2.5*font_size,(Y1_DIM+Y2_DIM)/2-font_size), font_size, font_path, fill=text_color)        draw_line(draw, (X1_DIM-dim_space, Y1_DIM), (X1_DIM-arrow_length-dim_space, Y1_DIM), fill=text_color, width=1)        draw_line(draw, (X2_DIM-dim_space, Y2_DIM), (X2_DIM-arrow_length-dim_space, Y2_DIM), fill=text_color, width=1)        draw_line(draw, (X1_DIM-arrow_length/2-dim_space, Y1_DIM), (X2_DIM-arrow_length/2-dim_space, Y2_DIM), fill=text_color, width=1)# ç›¸é—œåƒæ•¸def plot_Uchannel(B,H,T,env_left_txt,env_right_txt,env_left,env_right):    # B=200    # H=120    # T=25    X_left,X_right,Y_top,Y_bottom=150,150,150,100    X0=X_left+T+B/2    Y0=Y_top+H    # env_left_txt=&quot;è·¯&quot;    # env_left=20    # env_right_txt=&quot;ç”°&quot;    # env_right=60    env_left_body=H-env_left+T    env_right_body=H-env_right+T    # è¨­ç½®åœ–åƒå°ºå¯¸å’Œè§£æåº¦    width, height = X_left+X_right+2*T+B, Y_top+Y_bottom+H+T    dpi = 100  # é«˜ DPI è¨­ç½®    # å‰µå»ºåœ–åƒ    image = Image.new(&#x27;RGB&#x27;, (width, height), &#x27;white&#x27;)    draw = ImageDraw.Draw(image)    # å­—é«”è¨­ç½®    font_path = &quot;NotoSansTC-Regular.ttf&quot;  # å­—é«”æ–‡ä»¶çš„è·¯å¾‘    font_size = 20    # ç¹ªè£½æ–‡å­—    draw_text(draw, env_left_txt, (X0-B/2-T-X_left/2-20, Y0-H+env_left-font_size*2), font_size*1.2, font_path)    draw_text(draw, env_right_txt, (X0+B/2+T+X_right/2, Y0-H+env_right-font_size*2), font_size*1.2, font_path)    # åœŸé«”    polygon_points = [ (X0-B/2-T, Y0-H+env_left), (X0-B/2-T-X_left, Y0-H+env_left),  (X0-B/2-T-X_left, Y0-H+env_left+env_left_body), (X0-B/2-T, Y0-H+env_left+env_left_body)]    draw_gradient_polygon(draw, polygon_points, (51, 26, 0),(255, 255, 255))    # åœŸé«”    polygon_points = [ (X0+B/2+T, Y0-H+env_right), (X0+B/2+T+X_right, Y0-H+env_right), (X0+B/2+T+X_right, Y0-H+env_right+env_right_body), (X0+B/2+T, Y0-H+env_right+env_right_body)]    draw_gradient_polygon(draw, polygon_points, (51, 26, 0),(255, 255, 255))    # é¢å±¤    if env_left_txt==&quot;ç”°&quot;:        draw_line(draw, (X0-B/2-T, Y0-H+env_left), (X0-B/2-T-X_left, Y0-H+env_left), fill=&#x27;green&#x27;, width=4)    else:        draw_line(draw, (X0-B/2-T, Y0-H+env_left), (X0-B/2-T-X_left, Y0-H+env_left), fill=(0, 26, 51), width=4)    if env_right_txt==&quot;è·¯&quot;:        draw_line(draw, (X0+B/2+T, Y0-H+env_right), (X0+B/2+T+X_right, Y0-H+env_right), fill=(0, 26, 51), width=4)    else:        draw_line(draw, (X0+B/2+T, Y0-H+env_right), (X0+B/2+T+X_right, Y0-H+env_right), fill=&#x27;green&#x27;, width=4)    # çµæ§‹é«”    pts =[(X0,Y0),(X0-B/2,Y0),(X0-B/2,Y0-H),(X0-B/2-T,(Y0-H)),(X0-B/2-T,(Y0+T)),(X0+B/2+T,(Y0+T)),(X0+B/2+T,(Y0-H)),(X0+B/2,(Y0-H)),(X0+B/2,Y0),(X0,Y0)]    draw_polygon(draw, pts, outline=&#x27;black&#x27;, fill=&#x27;gray&#x27;, width=1)    ## å°ºå¯¸æ¨™è¨»    ### æ°´å¹³æ–¹å‘    X1_DIM,Y1_DIM=X0-B/2-T,Y0-H    X2_DIM,Y2_DIM=X0-B/2,Y0-H    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)    X1_DIM,Y1_DIM=X0-B/2,Y0-H    X2_DIM,Y2_DIM=X0+B/2,Y0-H    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)    X1_DIM,Y1_DIM=X0+B/2,Y0-H    X2_DIM,Y2_DIM=X0+B/2+T,Y0-H    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)    ### å‚ç›´æ–¹å‘    X1_DIM,Y1_DIM=X0-B/2-T,Y0-H    X2_DIM,Y2_DIM=X0-B/2-T,Y0    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)    X1_DIM,Y1_DIM=X0-B/2-T,Y0    X2_DIM,Y2_DIM=X0-B/2-T,Y0+T    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)    # ä¿å­˜é«˜è§£æåº¦åœ–åƒ    image.save(&quot;high_quality_drawing.png&quot;, dpi=(dpi, dpi))    image.show()if __name__ == &quot;__main__&quot;:    # çµ¦å®šå°ºå¯¸    plot_Uchannel(300,200,30,&quot;ç”°&quot;,&quot;ç”°&quot;,20,50)\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Python"]},{"title":"openpyxlç…§ç‰‡è™•ç†ç­†è¨˜","url":"/posts/1384887565/","content":"å‰è¨€\r\nç›®å‰åœ¨è™•ç†è¼¸å‡ºå ±è¡¨çš„å¯¦å‹™ä¸Šæœƒé‡åˆ°è¦è²¼ä¸Šç…§ç‰‡çš„å•é¡Œï¼Œæœ‰é—œpythonåœ¨è™•ç†Excelç…§ç‰‡éƒ¨åˆ†æœƒéœ€è¦é€éopenpyxlè£¡é¢ç›¸é—œçš„å¥—ä»¶é€²è¡Œï¼Œå¸Œæœ›èƒ½å¤ é”æˆä¸‹åˆ—æƒ…æ³:\r\nçµ¦å®šç…§ç‰‡ä¹‹å¾Œå¯ä»¥ä¾ç…§å„²å­˜æ ¼çš„ç¯„åœè²¼ä¸Šç…§ç‰‡ï¼Œå„²å­˜æ ¼å¯èƒ½æ˜¯å–®ä¸€å„²å­˜æ ¼æˆ–è€…æ˜¯åˆä½µå„²å­˜æ ¼ï¼Œæ‰¾å‡ºå„²å­˜æ ¼ç¯„åœå¯¬åº¦ã€å„²å­˜æ ¼ç¯„åœé«˜åº¦\r\n\r\næœ€é©åˆçš„æ–¹å¼è¨ˆç®—éç¨‹\r\n\r\n\r\nç…§ç‰‡å¯¬çš„ï¼Œæ¯”ä¾‹è¨­å®šç‚ºå„²å­˜æ ¼ç¯„åœå¯¬åº¦/ç…§ç‰‡å¯¬åº¦ï¼Œç…§ç‰‡é•·å¯¬åŒä¹˜ä¸Šé€™å€‹æ¯”ä¾‹æ”¾å¤§ç¸®å°\r\nç…§ç‰‡é•·çš„ï¼Œæ¯”ä¾‹è¨­å®šç‚ºå„²å­˜æ ¼ç¯„åœé«˜åº¦/ç…§ç‰‡é«˜åº¦ï¼Œç…§ç‰‡é•·å¯¬åŒä¹˜ä¸Šé€™å€‹æ¯”ä¾‹æ”¾å¤§ç¸®å°\r\n\r\n\r\nç…§ç‰‡è²¼ä¸Šæ–¹å¼\r\nè²¼åˆ°ä¸€å®šç¯„åœé–“\r\nhttps://openpyxl.readthedocs.io/en/latest/_modules/openpyxl/drawing/spreadsheet_drawing.html#TwoCellAnchor\r\nimport streamlit as stfrom openpyxl import load_workbookfrom openpyxl.drawing.image import Image as OpenpyxlImagefrom openpyxl.drawing.spreadsheet_drawing import AnchorMarker,TwoCellAnchorimport iodef is_merged_cell(ws, col, row):    for merged_range in ws.merged_cells.ranges:        if ws.cell(row=row+1, column=col+1).coordinate in merged_range:            return merged_range    return Nonedef insert_image(worksheet,img,target_row,target_col):    col1,row1,col2,row2=(is_merged_cell(worksheet, target_col,target_row).bounds)    marker1=AnchorMarker(col=col1-1, row=row1-1)    marker2=AnchorMarker(col=col2, row=row2)    img.anchor = TwoCellAnchor(_from=marker1, to=marker2)    worksheet.add_image(img)# Streamlit application titlest.title(&quot;Excel Image Insertion Tool&quot;)# File uploaduploaded_excel = st.file_uploader(&quot;Upload Excel file&quot;, type=[&quot;xlsx&quot;])uploaded_image = st.file_uploader(&quot;Upload image file&quot;, type=[&quot;png&quot;, &quot;jpg&quot;, &quot;jpeg&quot;])uploaded_image2 = st.file_uploader(&quot;Upload image file2&quot;, type=[&quot;png&quot;, &quot;jpg&quot;, &quot;jpeg&quot;])# Input for sheet name and cell locationsheet_name = st.text_input(&quot;Enter sheet name&quot;, &quot;æ¦‚è¦è¡¨&quot;)cell_location = st.text_input(&quot;Enter cell location for image insertion&quot;, &quot;E3&quot;)if uploaded_excel and uploaded_image and uploaded_image2:    # Read Excel file    workbook = load_workbook(filename=uploaded_excel)        # Check if sheet exists    if sheet_name not in workbook.sheetnames:        st.error(f&quot;Sheet &#x27;&#123;sheet_name&#125;&#x27; does not exist!&quot;)    else:        worksheet = workbook[sheet_name]        # Load image        img = OpenpyxlImage(uploaded_image)        img2=OpenpyxlImage(uploaded_image2)        insert_image(worksheet,img,3,5) #E3        insert_image(worksheet,img2,14,5) #E14        # Save modified Excel file        output = io.BytesIO()        workbook.save(output)        output.seek(0)                # Provide download link        st.download_button(label=&quot;Download modified Excel file&quot;,                           data=output,                           file_name=&quot;modified_excel.xlsx&quot;)        st.success(&quot;Image successfully inserted into Excel file!&quot;)\r\nç›´æ¥è²¼åˆ°å·¦ä¸Šè§’é»\r\nç›®å‰openpyxlçš„å¥—ä»¶åªèƒ½é€éOneCellAnchorè™•ç†ï¼Œä½†æ˜¯ç…§ç‰‡å¤§å°ç„¡å¾é©æ‡‰(ä¹Ÿè¨±æ˜¯æˆ‘é‚„æ²’æ‰¾åˆ°æ–¹æ³•)ã€‚\r\nè²¼åˆ°å·¦ä¸Šè§’é»ä¹‹å¾Œé€²è¡Œåç§»(ç›®å‰æ–½å·¥ç…§ç‰‡æ˜¯é€™æ¨£è™•ç†)\r\nVBA å…§å®¹\r\ndblGap = 2#Count = 0For Each fleTmp In fldMain.Files    strTmp = UCase(fsoMain.GetExtensionName(fleTmp.path))    If strTmp = &quot;JPG&quot; Or strTmp = &quot;JPEG&quot; Then        Count = Count + 1        With shtAct            Set ranOri = .Range(.Cells(2 + (Count - 1) * 14, 4), .Cells(2 + (Count - 1) * 14, 4))            Set ranNum = ranOri.Offset(2, -2)            ranNum = Count        End With        Set picAct = shtAct.Pictures.Insert(fleTmp.path)        With picAct            .ShapeRange.LockAspectRatio = msoTrue &#x27;é–å®šç…§ç‰‡é•·å¯¬æ¯”            If .Height &gt; .Width Then &#x27;ç›´å¼                Set ranOri = ranOri.Resize(13, 1) &#x27;.Merge                ranOri.Merge            Else &#x27;æ©«å¼                Set ranOri = ranOri.Offset(4, -2).Resize(9, 3) &#x27;.Merge                ranOri.Merge            End If            dblRatioPic = .Width / .Height            dblRatioOri = ranOri.Width / ranOri.Height            If dblRatioPic &gt; dblRatioOri Then &#x27;å¯¬åº¦æ§åˆ¶                .Width = ranOri.Width - 2 * dblGap                .Top = ranOri.Top + 0.5 * ranOri.Height - 0.5 * .Height                .Left = ranOri.Left + dblGap            Else                                &#x27;é«˜åº¦æ§åˆ¶                .Height = ranOri.Height - 2 * dblGap                .Top = ranOri.Top + dblGap                .Left = ranOri.Left + 0.5 * ranOri.Width - 0.5 * .Width            End If        End With    End IfNext fleTmp\r\né–‹ç™¼å°å•é¡Œ\r\nI/O operation on closed file\r\nSol:\r\nå¦‚æœuploaded_fileæ²’æœ‰å…ˆç¶“éimg_fileé€²è¡Œå„²å­˜çš„è©±ï¼Œæœƒåœ¨OpenpyxlImageè™•ç†å®Œç•¢ä¹‹å¾Œå°±close\r\nimg1_file = io.BytesIO(st.session_state.uploaded_file1.getvalue())img1 = OpenpyxlImage(img1_file)img2_file = io.BytesIO(st.session_state.uploaded_file2.getvalue())img2 = OpenpyxlImage(img2_file)img3_file = io.BytesIO(st.session_state.uploaded_file3.getvalue())img3 = OpenpyxlImage(img3_file)# img1=OpenpyxlImage(st.session_state.uploaded_file1)insert_image(sheet,img1,3,5)# img2=OpenpyxlImage(st.session_state.uploaded_file2)insert_image(sheet,img2,14,5)# img3=OpenpyxlImage(st.session_state.uploaded_file3)insert_image(sheet,img3,14,8)\r\nref\r\nhttps://blog.csdn.net/chenliang1038/article/details/119410308\r\n","categories":["åŸºæœ¬åŸç†"],"tags":["python"]},{"title":"ä¸åŒç‰ˆæœ¬é–“çš„CADé–‹ç™¼","url":"/posts/2144300187/","content":"ğŸ™Œå‰è¨€\r\nCADç‰ˆæœ¬æœ‰éå¸¸å¤šç¨®ï¼Œæˆ‘ç›®å‰æœ‰æ¥è§¸éçš„å°±æœ‰AutoCADã€ZWCADä»¥åŠç¾åœ¨æ­£åœ¨ä½¿ç”¨ä¸­çš„ProgeCADã€‚\r\nåœ¨ä½¿ç”¨VBAé€²è¡ŒäºŒæ¬¡é–‹ç™¼çš„éç¨‹ï¼Œéœ€è¦è€ƒé‡å¼•ç”¨ç‰©ä»¶æ¨¡å‹ä¹‹é–“çš„å·®ç•°ï¼Œå°±ç›®å‰é–‹ç™¼ç¶“é©—ä¸­ï¼ŒAutoCADèˆ‡ZWCADå¯ä»¥é€éä¿®æ”¹å¼•ç”¨åç¨±å°±å¯ä»¥æœ‰å¾ˆå¥½çš„è½‰æ›é«”é©—ï¼Œä½†æ˜¯ProgeCADçš„åŸºåº•ç‰©ä»¶æœ‰æ¯”è¼ƒä¸åŒçš„è¨­è¨ˆï¼Œæ•…æœ¬ç¯‡è¦ä¾†è§£é‡‹å¾AutoCADçš„VBAcodeå¦‚ä½•é€éæˆ‘æ‰€æ’°å¯«çš„ç‰©ä»¶è½‰æ›å‡½æ•¸é€²è¡Œç›¸å®¹ï¼Œè®“ç¨‹å¼ç¢¼åœ¨ProgeCADä¹Ÿå¯ä»¥é †åˆ©å‹•èµ·ä¾†ã€‚\r\nğŸ”—HanksVBAå­¸ç¿’æ­·ç¨‹-ä¸åŒCADç‰ˆæœ¬é–“ä¹Ÿå¯ä»¥å¼•ç”¨çš„Library(clsACAD)\r\n\r\nğŸ¯ç‰ˆæœ¬æ²¿é©\r\nAutoCAD\r\nAutoCADç‚ºAutodeskå…¬å¸æ——ä¸‹ç”¢å“ï¼Œç”¢å“æ¯”è¼ƒæ²’æœ‰ç•°å¸¸ï¼Œç¨‹å¼ç¢¼ç¯„ä¾‹è±å¯Œï¼Œç¤¾ç¾¤æ”¯æ´å®Œæ•´åº¦è¼ƒé«˜ï¼ŒåŒæ™‚ä¹Ÿæ˜¯æœ€æ˜‚è²´çš„è»Ÿé«”ã€‚\r\nZWCAD\r\nZWCADç‚ºä¸­æœ›å…¬å¸æ——ä¸‹ç”¢å“ï¼Œå…¶å¯¦èˆ‡AutoCADéƒ½å¤§åŒå°ç•°ï¼Œè²»ç”¨æ¯”AutoCADä¾†çš„ä¾¿å®œï¼Œå¯æƒœæ”¿åºœæ©Ÿé—œä¸èƒ½æ¥å—ä¸­è³‡ï¼Œæ€•æœ‰è³‡å®‰ç–‘æ…®ã€‚\r\nProgeCAD\r\nProgeCADç¸½éƒ¨è¨­ç«‹æ–¼ç¾©å¤§åˆ©ï¼Œæ¡ç”¨IntelliCADå¼•æ“é©…å‹•ï¼Œå°±ä½¿ç”¨ä¸Šä¸çŸ¥æ€éº¼èªªï¼Œå°±æ˜¯è¦ºå¾—èˆ‡AutoCADå°‘äº†ä¸€å‘³ï¼Œç¨‹å¼ç¢¼çš„é‹ä½œæ¯”è¼ƒç·©æ…¢ï¼Œæœ‰äº›ä»‹é¢æœƒè·ŸAutoCADæœ‰äº›è¨±è½å·®ã€‚\r\nğŸ“Œé–‹ç™¼å·®ç•°\r\nä¹‹å‰çš„å°ˆæ¡ˆå¤§å¤šéƒ½æ˜¯ç”¨æ–¼AutoCADé‹ä½œï¼Œè‡ªå¾æ©Ÿé—œè²·æ–·ProgeCADä¹‹å¾Œï¼Œç‚ºäº†æŠŠç¨‹å¼ç¢¼ç§»è½‰åˆ°ProgeCADé€²è¡Œï¼Œéœ€è¦äº†è§£ä¸€ä¸‹ç¨‹å¼ç¢¼é–‹ç™¼ä¹‹é–“çš„å·®ç•°ã€‚\r\nå…¬å…±è®Šæ•¸\r\nå…¬å…±è®Šæ•¸çš„ç›®çš„æ˜¯ç‚ºäº†èƒ½å¤ åœ¨å„å€‹functionä¸­ç›¸äº’å‚³éè®Šæ•¸ä½¿ç”¨\r\nPrivate mo As ObjectPrivate pa As ObjectPublic acadDoc As ObjectPublic CADVer As String\r\né€£æ¥æ‡‰ç”¨ç¨‹å¼\r\né€™è£¡æˆ‘åœ¨Sheets(\"ç¸½è¡¨\")ä¸Šé¢åšäº†ä¸€å€‹é¸å–®ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥æŒ‘é¸è¦å•Ÿç”¨å“ªå€‹å¾ŒæœŸç¹«çµå­—ä¸²ï¼ŒstrCADç‚ºVBAå‘¼å«CADæ‡‰ç”¨ç¨‹å¼é€£æ¥å­—ä¸²ï¼ŒCADVerç‚ºå„functioné€£æ¥å¾Œçš„ç´°å¾®èª¿æ•´åˆ¤æ–·ã€‚\r\nPrivate Sub Class_Initialize()If Sheets(&quot;ç¸½è¡¨&quot;).optAutoCAD = True Then    strCAD = &quot;AutoCAD.application&quot;    CADVer = &quot;AUTOCAD&quot;    ElseIf Sheets(&quot;ç¸½è¡¨&quot;).optZWCAD = True Then        strCAD = &quot;ZWCAD.Application&quot;    CADVer = &quot;ZWCAD&quot;    ElseIf Sheets(&quot;ç¸½è¡¨&quot;).optICAD = True Then    strCAD = &quot;ICAD.application&quot;    CADVer = &quot;ICAD&quot;End IfCall CADInit(strCAD)End SubPrivate Sub CADInit(ByVal strCAD As String)On Error Resume NextSet acadApp = GetObject(, strCAD) &#x27;æŸ¥çœ‹å®‰è£If Err &lt;&gt; 0 Then Set acadApp = CreateObject(strCAD)acadApp.Visible = TrueOn Error GoTo 0Set mo = acadApp.ActiveDocument.ModelSpaceSet pa = acadApp.ActiveDocument.PaperSpaceSet acadDoc = acadApp.ActiveDocumentEnd Sub\r\nğŸŒŸç‰©ä»¶ç›¸å®¹è½‰æ›å‡½æ•¸\r\n\r\nAutoCADçš„é»ç‰©ä»¶æ˜¯ä»¥ä¸€å€‹é™£åˆ—(array)å„²å­˜(0,1,2)doubleè®Šæ•¸è€Œæˆã€‚\r\nAutoCADçš„ç·šç‰©ä»¶å‰‡åˆ†ç‚ºLightWeightPolylineè·Ÿ3dPolyline\r\n\r\nLightWeigtPolylineæ˜¯ä»¥ä¸€å€‹é™£åˆ—(vertice)è‡³å°‘å„²å­˜(0,1,2,3)ç”Ÿæˆï¼Œéç¨‹ä¸­ä¸å„²å­˜é«˜ç¨‹ï¼Œæ‰€ä»¥æ¯2å€‹å€¼ç‚ºä¸€å€‹é»ã€‚\r\n3DPolylineæ˜¯ä»¥ä¸€å€‹é™£åˆ—(vertice)è‡³å°‘å„²å­˜(0,1,2,3,4,5)ç”Ÿæˆï¼Œéç¨‹ä¸­å„²å­˜é«˜ç¨‹ï¼Œæ‰€ä»¥æ¯3å€‹å€¼ç‚ºä¸€å€‹é»ã€‚\r\n\r\nProgeCADçš„é»ç‰©ä»¶æ˜¯ä»¥ä¸€å€‹é»ç‰©ä»¶(Point)ï¼Œç”±X,Y,Zä¸‰å€‹å±¬æ€§å„²å­˜å…¶è®Šæ•¸è€Œæˆã€‚\r\nProgeCADçš„ç·šç‰©ä»¶æ˜¯ä»¥é»ç¾¤ç‰©ä»¶(Points)å„²å­˜é»ç‰©ä»¶(Point)ï¼Œå–å…¶è®Šæ•¸è€Œæˆã€‚\r\n\r\nFunction tranPoint(ByVal CADpt)If CADVer &lt;&gt; &quot;ICAD&quot; Then tranPoint = CADpt: Exit FunctionSet tranPoint = Library.CreatePoint(CADpt(0), CADpt(1), CADpt(2))End FunctionFunction tranIPoint(ByVal ICADpt)If CADVer &lt;&gt; &quot;ICAD&quot; Then tranIPoint = ICADpt: Exit FunctionDim tmp(2) As Doubletmp(0) = ICADpt.Xtmp(1) = ICADpt.Ytmp(2) = ICADpt.ZtranIPoint = tmpEnd FunctionFunction tranPoints(ByVal vertices, Optional cnt As Byte = 3)If CADVer &lt;&gt; &quot;ICAD&quot; Then tranPoints = vertices: Exit FunctionIf vertices(2) = 0 Then cnt = 3Dim myPline, myPoints, pt    Set myPoints = Library.CreatePointsIf cnt = 2 Then    For i = 0 To UBound(vertices) Step cnt            Set pt = Library.CreatePoint(vertices(i), vertices(i + 1))            myPoints.Add        myPoints(myPoints.Count - 1).X = pt.X        myPoints(myPoints.Count - 1).Y = pt.Y        NextElse    For i = 0 To UBound(vertices) Step cnt            Set pt = Library.CreatePoint(vertices(i), vertices(i + 1), vertices(i + 2))            myPoints.Add        myPoints(myPoints.Count - 1).X = pt.X        myPoints(myPoints.Count - 1).Y = pt.Y        myPoints(myPoints.Count - 1).Z = pt.Z        NextEnd IfSet tranPoints = myPointsEnd FunctionFunction tranIPoints(ByVal myPoints)If CADVer &lt;&gt; &quot;ICAD&quot; Then tranIPoints = myPoints: Exit FunctionDim vertices()ReDim vertices(myPoints.Count * 3 - 1)For Each it In myPointsvertices(0 + j) = it.Xvertices(0 + j + 1) = it.Yvertices(0 + j + 2) = it.Zj = j + 3NexttranIPoints = verticesEnd Function\r\nåŸºæœ¬ç‰©ä»¶\r\nç•«é»ã€ç•«åœ“ã€ç•«ç·šã€å¯«æ–‡å­—\r\nFunction AddPoint(pt) As ObjectIf CADVer = &quot;ICAD&quot; Then    Set AddPoint = mo.AddPointEntity(tranPoint(pt))Else    Set AddPoint = mo.AddPoint(tranPoint(pt))End IfEnd FunctionFunction AddCircle(cpt, r) As ObjectSet AddCircle = mo.AddCircle(tranPoint(cpt), r)End FunctionFunction AddLine(spt, ept) As ObjectSet AddLine = mo.AddLine(tranPoint(spt), tranPoint(ept))End FunctionFunction AddLineCO(X1, Y1, X2, Y2) As ObjectDim spt(2) As DoubleDim ept(2) As Doublespt(0) = X1: spt(1) = Y1ept(0) = X2: ept(1) = Y2Set AddLineCO = AddLine(spt, ept)End FunctionFunction AddPolyLine(vertices) As ObjectSet AddPolyLine = mo.AddPolyLine(tranPoints(vertices))End FunctionFunction Add3dPoly(vertices) &#x27;20210604 newSet Add3dPoly = mo.Add3dPoly(tranPoints(vertices))End FunctionFunction AddLWPolyLine(vertices) As ObjectSet AddLWPolyLine = mo.AddLightWeightPolyline(tranPoints(vertices, 2))End FunctionFunction AddArc(ByVal Center, Radius As Double, StartAngle As Double, EndAngle As Double)Set AddArc = mo.AddArc(tranPoint(Center), Radius, StartAngle, EndAngle)End FunctionFunction AddText(ByVal myText As String, ByVal txtpt, ByVal txtheight As Double, Optional alignmode As Byte = 1)    Dim mtextObj As Object &#x27;IntelliCAD.Text    Dim insPt        insPt = txtpt    Set txtobj = mo.AddText(myText, tranPoint(insPt), txtheight)    If CADVer = &quot;ICAD&quot; Then            Select Case alignmode                Case 1            txtobj.HorizontalAlignment = 0  &#x27; acAlignmentMiddleLeft        Case 2            txtobj.HorizontalAlignment = 4  &#x27; acAlignmentMiddleCenter        Case 3            txtobj.HorizontalAlignment = 2 &#x27; acAlignmentMiddleRight                End Select        Else            Select Case alignmode            Case 1            txtobj.Alignment = 9 &#x27; acAlignmentMiddleLeft        Case 2            txtobj.Alignment = 10 &#x27; acAlignmentMiddleCenter        Case 3            txtobj.Alignment = 11 &#x27; acAlignmentMiddleRight                    End Select        End If        txtobj.TextAlignmentPoint = tranPoint(insPt)    Set AddText = txtobjEnd Function\r\né€šç”¨é¡åˆ¥(Util)\r\né€šç”¨é¡åˆ¥ç”¨æ–¼èˆ‡æ‡‰ç”¨ç¨‹å¼é–“çš„äº’å‹•å±…å¤šï¼ŒåŒ…å«å–å¾—é»ã€å–å¾—æ–‡å­—ã€‚ä¹ŸåŒ…å«CADç‰©ä»¶æœ¬èº«æ‰€æä¾›çš„ç„¡æ³•åˆ†é¡å±¬æ€§ï¼Œä¹Ÿæœƒæ”¾å…¥é€šç”¨é¡åˆ¥ã€‚\r\nFunction GetPoint(ByVal prompt As String)If CADVer = &quot;ICAD&quot; Then    Set o = IntelliCAD.ActiveDocument.Utility.GetPoint(, prompt)    GetPoint = tranIPoint(o)Else    GetPoint = acadDoc.Utility.GetPoint(, prompt)End IfEnd FunctionFunction GetString(ByVal prompt As String)GetString = acadDoc.Utility.GetString(False, prompt &amp; vbNewLine)End FunctionFunction GetBoundingBox(ByVal entobj, MinX, MinY, MaxX, MaxY)If CADVer = &quot;ICAD&quot; Then Call GetBoundingBox_ICAD(entobj, MinX, MinY, MaxX, MaxY): Exit FunctionCall entobj.GetBoundingBox(Min, Max)MinX = Min(0): MinY = Min(1)MaxX = Max(0): MaxY = Max(1)End FunctionFunction GetBoundingBox_ICAD(ByVal entobj, MinX, MinY, MaxX, MaxY)Dim Min As ObjectDim Max As ObjectCall entobj.GetBoundingBox(Min, Max)MinX = Min.X: MinY = Min.YMaxX = Max.X: MaxY = Max.YEnd Function\r\nğŸé–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ\r\nå¡«å……ç·šä¹Ÿæ˜¯å¸¸ç”¨æ–¼æ¨™ç¤ºåœ–å½¢çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œé€™è£¡çš„AddHatchæˆ‘ä¸€ç›´è©¦ä¸å‡ºä¾†ï¼Œç•¶åˆçŒœæ¸¬å¯èƒ½æ˜¯å¸¸æ•¸çš„å•é¡ŒvicHatchPatternTypePreDefinedï¼Œçµæœé‚„æ˜¯ä¸€æ¨£...\r\nä¸åŒæ‡‰ç”¨ç¨‹å¼ä¹‹é–“æœ‰æ™‚å€™å¸¸æ•¸è¨­å®šæœƒæœ‰æ‰€ä¸åŒï¼ŒåŒ…å«æ’åºçš„æ–¹å¼ä¹Ÿå¯èƒ½æœƒä¸åŒï¼Œåƒæ˜¯åœ¨åšselectionset(é¸æ“‡é›†)çš„æ™‚å€™ï¼ŒAutoCADå¯ä»¥å¾ˆæ¸…æ¥šçŸ¥é“é †åºï¼Œä½†æ˜¯ProgeCADä¼¼ä¹æ²’æœ‰ä¸€å®šçš„è¦å‰‡å¯è¨€ã€‚\r\nSub Hatch(ByVal obj As Object, ByVal Ratio As Double, ByVal ptrName As String)&#x27;usually use &quot;SOLID&quot;,&quot;ANSI32&quot;,&quot;AR-CONC&quot;If CADVer = &quot;ICAD&quot; Then Exit SubDim hatchobj As Object &#x27;AcadHatchDim outerloop(0 To 0) As Object &#x27;AcadEntityPatternName = ptrNameSet hatchobj = mo.AddHatch(0, PatternName, True)&#x27;Set hatchobj = mo.AddHatch(vicHatchPatternTypePreDefined, PatternName, True)hatchobj.PatternScale = 1 / Ratio * 4Set outerloop(0) = objOn Error Resume Nexthatchobj.AppendOuterLoop (outerloop)End SubFunction AddMixText(ByVal s As String, ByVal txtpt, ByVal txtheight As Double, _                    Optional alignmode As Byte = 1, Optional dashmode As Integer = 0)Dim txtobj As Object &#x27;AcadTextDim circleobj As Object &#x27;AcadCircleSet AddMixText = AddText(s, txtpt, txtheight, alignmode)With mo    Dim vertices(5) As Double    If dashmode = 0 Then Exit Function        Call GetBoundingBox(AddMixText, MinX, MinY, MaxX, MaxY)        For i = 1 To dashmode            vertices(0) = MinX        vertices(1) = MinY - txtheight / 2 - txtheight / 2 * 0.5 * i                vertices(3) = MaxX        vertices(4) = vertices(1)                Set plineobj = AddPolyLine(vertices)                &#x27;******æ•´é«”å¯¬åº¦å°šæœªè§£æ±º******                If CADVer &lt;&gt; &quot;ICAD&quot; Then plineobj.ConstantWidth = txtheight / 10        NextEnd WithEnd FunctionFunction CreateSSET(Optional ByVal sname As String = &quot;SS1&quot;, Optional ByVal ftypetmp As Variant = &quot;&quot;, Optional ByVal fdatatmp As Variant = &quot;&quot;)&#x27;****PorgeCADä¸­ä¼¼ä¹æ²’è¾¦æ³•åšåˆ°éæ¿¾çš„æ¢ä»¶?*****&#x27;0:object type&#x27;2:object name&#x27;8:layer name&#x27;62:color number(0 to 256)Dim FilterType() As IntegerDim FilterData() As VariantOn Error Resume Next: acadDoc.SelectionSets(sname).Delete: On Error GoTo 0Set sset = acadDoc.SelectionSets.Add(sname)If ftypetmp = &quot;&quot; Then    sset.SelectOnScreen    Else    ft = Split(ftypetmp, &quot;,&quot;)    fd = Split(fdatatmp, &quot;,&quot;)        ReDim FilterType(0 To UBound(ft))    ReDim FilterData(0 To UBound(fd))        For i = 0 To UBound(ft)            FilterType(i) = ft(i)        FilterData(i) = fd(i)            Next        sset.SelectOnScreen FilterType, FilterData    End IfSet CreateSSET = ssetEnd FunctionSub SetXdataToObj(ByVal obj As Object, ByVal xdata As String) &#x27;æä¾›ç¶å…¥å­—ä¸²ä½¿ç”¨If CADVer = &quot;ICAD&quot; Then Exit Sub  &#x27;ä¸­å¿ƒç·šæ¨ç„¡æ³•æä¾›&#x27;*****ç”¨Handleè™•ç†?!***Dim DataType(0 To 1) As IntegerDim Data(0 To 1) As VariantDataType(0) = 1001: Data(0) = xdataDataType(1) = 1000: Data(1) = &quot;&quot;obj.SetXData DataType, DataEnd Sub\r\nğŸ‘‰å»ºè­°é–‹ç™¼æ–¹å‘\r\né€šç”¨æ‰æ˜¯ç‹é“ï¼Œä¸ç®¡ä½¿ç”¨å“ªç¨®æ‡‰ç”¨ç¨‹å¼ï¼Œåªè¦å¯ä»¥å½¼æ­¤åŒ¯å…¥ã€åŒ¯å‡ºï¼Œæœ€å¾Œéƒ½åªæ˜¯å·®åœ¨ä»‹é¢ä½¿ç”¨çš„ç¿’æ…£ä»¥åŠå„æ‡‰ç”¨ç¨‹å¼ç¨ç«‹æä¾›çš„åŠŸèƒ½è€Œå·²ã€‚\r\nå¦‚åŒå‰è¨€æ‰€è¿°ï¼ŒCADç‰ˆæœ¬æœ‰éå¸¸å¤šç¨®é¡å‹ï¼Œåœ¨é ç®—ä¸Šè‹¥æœ‰æ‰€è€ƒé‡ï¼Œå…¶å¯¦ä¹Ÿæœ‰FreeCADã€LibreCAD...ç­‰ç­‰é–‹æºé¸é …ã€‚ä½†è‹¥ä»Šå¤©æŠŠå¤§å¤šæ•¸çš„é–‹ç™¼æ™‚é–“éƒ½æŠ•åœ¨æŸä¸€å€‹CADç‰ˆæœ¬èº«ä¸Šï¼Œæœªä¾†å¦‚æœå…¬å¸è¦æ›´æ›ç‰ˆæœ¬æ™‚ï¼Œè½‰æ›æˆæœ¬æœƒéš¨è‘—ä½ çš„é–‹ç™¼æ™‚é–“è€Œå‘ˆæŒ‡æ•¸ä¸Šå‡ï¼Œç¨‹å¼ç¢¼è¶Šè¤‡é›œå•é¡Œè¶Šé›£æŸ¥å‡ºä¾†ã€‚\r\nç•¶ä»Šå¤©é–‹ç™¼äººå“¡å·²ç¶“æ±ºå®šè¦æŠ•è³‡åœ¨CADçš„äºŒæ¬¡é–‹ç™¼ä¸Šï¼Œæˆ‘æœ‰å¹¾é»å»ºè­°\r\n\r\nç¢ºèªæ–‡ä»¶æ˜¯å¦è±å¯Œ\r\nç¤¾ç¾¤å¹³å°æ˜¯å¦æœ‰è‰¯å¥½çš„æ”¯æ´\r\nåŸºåº•æ‡‰ç”¨ç¨‹å¼æ˜¯å¦æœ‰ç´°å¾®bug\r\nç”¢å‡ºå…§å®¹ç›¡é‡ä»¥dxfç‚ºä¸»\r\n\r\næŒæ¡å¥½ä¸Šé¢å¹¾é»ï¼Œå°±å·®ä¸å¤šå¯ä»¥é–‹å§‹æŒ‘é¸CADçš„é¡Œç›®ï¼Œæ…¢æ…¢å˜—è©¦ï¼Œé‡åˆ°å•é¡Œå°±çœ‹æ–‡ä»¶ã€ä¸è¡Œå°±å•åˆ¥äººï¼Œåªè¦æ²’æœ‰æœ¬èº«çš„bugï¼ŒåŸºæœ¬ä¸ŠCADçš„é–‹ç™¼æ‡‰è©²å¯ä»¥å®Œæˆ80%çš„å·¥ä½œæµç¨‹ï¼Œæ­é…dxfçš„ç”¢å‡ºå…§å®¹ï¼Œæœªä¾†è½‰æ›ä¹Ÿæ˜¯æ²’æœ‰å•é¡Œçš„ã€‚\r\nğŸ’¡Pythonè¼¸å‡ºDXF(é¡Œå¤–è©±)\r\npythonçš„ezdxfå¥—ä»¶æ˜¯æˆ‘æœ€è¿‘åœ¨ä½¿ç”¨streamlité–‹ç™¼æ™‚åœ¨ä½¿ç”¨ï¼Œæ–‡ä»¶ä¹Ÿç®—æ˜¯ç›¸ç•¶è©³ç´°ï¼Œé€™æ˜¯ä¸€å€‹å–®ç´”ç”¨pythonæ‰€è£½ä½œçš„CSVè½‰DXFå°ˆæ¡ˆï¼Œå°æ–¼é»è³‡æ–™è½‰æˆé»ç‰©ä»¶æ‡‰è©²æœ‰å¹«åŠ©ï¼Œä¸‹è¼‰DXFä¹‹å¾Œåªè¦åŒ¯å…¥è‡ªå·±çš„CADç‰ˆæœ¬å°±å¯ä»¥é€²è¡Œå¾ŒçºŒä½¿ç”¨äº†!\r\nğŸ”—CSVè½‰DXF-Streamlit\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["AutoCAD VBA","ProgeCAD VBA","Streamlit"]},{"title":"å…§éƒ¨ç¶²è·¯å¸³è™Ÿå¯†ç¢¼æ¬Šé™æ§åˆ¶å¯¦ä½œ","url":"/posts/3389672383/","content":"å‰è¨€\r\nç•¶ç¶²ç«™å¯«å¥½å¾Œï¼Œä¾ç…§å…¬å¸å…§éƒ¨çµ„ç¹”åˆ†å±¤è² è²¬ï¼Œæ¬Šé™åˆ†ç‚ºç·¨è¼¯ã€è®€å–ã€æ‹’çµ•ï¼Œæ¯å€‹åˆ†é é€šå¸¸éƒ½æœƒæœ‰æŒ‡æ´¾çš„äººå“¡é€²è¡Œç·¨è¼¯ï¼Œç›¸é—œäººå“¡é€²è¡Œè®€å–ï¼Œä¸ç›¸å¹²äººç­‰ç¦æ­¢é€²å…¥(åŒæ™‚ä¹Ÿæ˜¯ç‚ºäº†é¿å…è³‡è¨Šå¤–æµ)ï¼Œæ•…åœ¨é€²å…¥ç¶²ç«™ä¹‹å‰ï¼Œæœƒè¦æ±‚ç”¨æˆ¶æä¾›å¸³è™Ÿå¯†ç¢¼ï¼Œé€™æ™‚å€™å…¬å¸å…§éƒ¨å¦‚æœæœ‰AD(Active\r\nDirectory)ç®¡ç†å¸³è™Ÿå¯†ç¢¼æœƒéå¸¸æ–¹ä¾¿ã€‚\r\n\r\nèˆ‰ä¾‹:å·¥ç¨‹å¯©æŸ¥ç³»çµ±ï¼Œå¯ç·¨è¼¯è€…ç‚ºè¨­è¨ˆè‚¡ï¼Œå¯è®€å–è€…ç‚ºå·¥äº‹è‚¡ã€‚\r\n\r\næ“ä½œæµç¨‹\r\n\r\nç¶²ç«™å…¥å£è¦æ±‚æä¾›å¸³è™Ÿå¯†ç¢¼\r\næ ¹æ“šè©²å¸³è™Ÿå¯†ç¢¼åˆ°ADç¢ºèªåç¨±ã€çµ„ç¹”è³‡è¨Š\r\næ ¹æ“šçµ„ç¹”è³‡è¨Šé–‹å•Ÿç›¸å°æ‡‰çš„é é¢\r\n\r\n\r\nç¨‹å¼ç¢¼è§£é‡‹\r\nç’°å¢ƒåƒæ•¸\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nè®Šæ•¸åç¨±\r\nèªªæ˜\r\nä¸­æ–‡è§£é‡‹\r\n\r\n\r\n\r\n\r\nAD_SERVER_NAME\r\nActive Directory server name\r\nAD ä¼ºæœå™¨åç¨±\r\n\r\n\r\nAD_DOMAIN\r\nActive Directory domain\r\nAD ç¶²åŸŸåç¨±\r\n\r\n\r\nAD_ADMIN_USER\r\nAD administrator username\r\nAD ç®¡ç†å“¡å¸³è™Ÿ\r\n\r\n\r\nAD_ADMIN_PASSWORD\r\nAD administrator password\r\nAD ç®¡ç†å“¡å¯†ç¢¼\r\n\r\n\r\nBASE_DN\r\nBase Distinguished Name\r\næŸ¥è©¢çš„èµ·é»\r\n\r\n\r\n\r\nç™»å…¥é©—è­‰\r\ndef check_ad_credentials(username, password):    # è¨­å®šå€¼ï¼ˆå¾ä½ çš„ C# è¨»è§£è½‰æ›éä¾†ï¼‰    user_upn = f&quot;&#123;username&#125;@&#123;AD_DOMAIN&#125;&quot;    try:        print(f&quot;ğŸ” å˜—è©¦ç”¨ &#123;user_upn&#125; ç™»å…¥ AD ä¼ºæœå™¨ &#123;AD_SERVER_NAME&#125; ...&quot;)        server = Server(AD_SERVER_NAME, get_info=ALL)        conn = Connection(server, user=user_upn, password=password, authentication=&#x27;SIMPLE&#x27;, auto_bind=True)        print(&quot;âœ… ç™»å…¥æˆåŠŸï¼&quot;)        conn.unbind()        return True    except LDAPException as e:        print(f&quot;âŒ LDAP é©—è­‰éŒ¯èª¤: &#123;e&#125;&quot;)        return False    except Exception as ex:        print(f&quot;âŒ å…¶ä»–éŒ¯èª¤: &#123;ex&#125;&quot;)        return False\r\nå–å¾—ç”¨æˆ¶è³‡è¨Š\r\ndef get_user_info_one(s_type, s_data):    try:        print(f&quot;ğŸ” æŸ¥è©¢æ¢ä»¶: (&#123;s_type&#125; = &#123;s_data&#125;)&quot;)        # å»ºç«‹é€£ç·š        server = Server(AD_SERVER_NAME, get_info=ALL)        conn = Connection(server, user=AD_ADMIN_USER, password=AD_ADMIN_PASSWORD,authentication=&#x27;SIMPLE&#x27;, auto_bind=True)        # å»ºç«‹æœå°‹ Filter        search_filter = f&quot;(&amp;(objectCategory=user)(&#123;s_type&#125;=&#123;s_data&#125;))&quot;        # åŸ·è¡Œæœå°‹        conn.search(            search_base=BASE_DN,            search_filter=search_filter,            search_scope=SUBTREE,            attributes=[                &#x27;displayName&#x27;,                &#x27;description&#x27;,                &#x27;userPrincipalName&#x27;,                &#x27;sAMAccountName&#x27;,                &#x27;distinguishedName&#x27;            ]        )        if not conn.entries:            print(&quot;âŒ æŸ¥ç„¡æ­¤äºº&quot;)            return None        entry = conn.entries[0]        # å›å‚³æ¨¡æ“¬ C# DataTable çš„å­—å…¸        result = &#123;            &#x27;USR_NAME&#x27;: entry.displayName.value or &#x27;&#x27;,            &#x27;TITLE&#x27;: entry.description.value or &#x27;&#x27;,            &#x27;EMAIL&#x27;: entry.userPrincipalName.value or &#x27;&#x27;,            &#x27;DP_STR&#x27;: entry.distinguishedName.value or &#x27;&#x27;        &#125;        conn.unbind()        return result    except LDAPException as e:        print(f&quot;âŒ LDAP éŒ¯èª¤: &#123;e&#125;&quot;)        return None    except Exception as ex:        print(f&quot;âŒ å…¶ä»–éŒ¯èª¤: &#123;ex&#125;&quot;)        return None\r\nå–å¾—å„å€‹å±¤æ¬¡çš„è³‡è¨Š\r\ndef parse_dn(dn):    # åˆ†å‰² DNï¼Œå–å¾—å„å€‹å±¤æ¬¡çš„è³‡è¨Š    parts = dn.split(&#x27;,&#x27;)        user_name = None    ou_list = []    dc_list = []        for part in parts:        if part.startswith(&#x27;CN=&#x27;):            user_name = part.replace(&#x27;CN=&#x27;, &#x27;&#x27;)        elif part.startswith(&#x27;OU=&#x27;):            ou_list.append(part.replace(&#x27;OU=&#x27;, &#x27;&#x27;))        elif part.startswith(&#x27;DC=&#x27;):            dc_list.append(part.replace(&#x27;DC=&#x27;, &#x27;&#x27;))        # è¿”å›è§£æçµæœ    return &#123;        &#x27;user_name&#x27;: user_name,        &#x27;organization_units&#x27;: ou_list,        &#x27;domain_components&#x27;: dc_list    &#125;\r\nç™½åå–®åŠæ¬Šé™çµ¦äºˆ\r\ndef white_list(ou_list):    accept_ou = [&quot;010&quot;, &quot;020&quot;, &quot;030&quot;, &quot;051&quot;, &quot;052&quot;, &quot;053&quot;, &quot;054&quot;, &quot;1C0&quot;, &quot;1CH&quot;, &quot;2D0&quot;, &quot;2DD&quot;, &quot;3E0&quot;, &quot;3EC&quot;, &quot;4F0&quot;, &quot;4FD&quot;, &quot;5G0&quot;, &quot;5G4&quot;,&quot;081&quot;]    edit_ou =[&quot;051&quot;]    # çµ±ä¸€è½‰æˆ list è™•ç†    if isinstance(ou_list, str):        ou_list = [ou_list]    # å…ˆæª¢æŸ¥æ˜¯å¦ç‚ºç·¨è¼¯è€…    for ou in ou_list:        if ou.strip() in edit_ou:            return &quot;EDITOR&quot;    # å†æª¢æŸ¥æ˜¯å¦ç‚ºæ¥å—è€…    for ou in ou_list:        if ou.strip() in accept_ou:            return &quot;VIEWER&quot;    # å…¶ä»–éƒ½ä¸æ˜¯    return &quot;NONE&quot;\r\nå…¥å£é‚è¼¯\r\nst.subheader(&quot;è«‹è¼¸å…¥EIPå¸³è™Ÿå¯†ç¢¼&quot;)with st.form(&quot;login_form&quot;, clear_on_submit=False):    username = st.text_input(&quot;ğŸ‘¤ å¸³è™Ÿ&quot;)    password = st.text_input(&quot;ğŸ”‘ å¯†ç¢¼&quot;, type=&quot;password&quot;)    login_btn = st.form_submit_button(&quot;ç™»å…¥&quot;)    if login_btn:        if check_ad_credentials(username, password):            # ç™»å…¥æˆåŠŸï¼Œå–å¾—ä½¿ç”¨è€…è³‡è¨Š            user_info = get_user_info_one(&quot;sAMAccountName&quot;, username)            res=parse_dn(user_info[&#x27;DP_STR&#x27;])            st.toast(f&quot;ğŸ‰ ç™»å…¥æˆåŠŸ &#123;user_info[&#x27;USR_NAME&#x27;]&#125; ...&quot;)            myrole=white_list(res[&#x27;organization_units&#x27;][0][0:3])            st.session_state.role = myrole            if myrole == &quot;NONE&quot;:                st.error(&quot;âŒ æ¬Šé™ä¸è¶³ï¼Œè«‹è¯çµ¡---è¨­è¨ˆè‚¡æ—å®—æ¼¢ã€‚&quot;)            time.sleep(3)            st.rerun()        else:            st.error(&quot;âŒ å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚&quot;)\r\nå¯¦éš›ç•«é¢\r\n\r\n\r\nFig1. å¸³è™Ÿå¯†ç¢¼å…¥å£\r\n\r\n\r\n\r\nFig2. æˆæ¬Šé€šéå¾Œç•«é¢\r\n\r\néŒ¯èª¤ç´€éŒ„\r\n\r\nåœ¨check_ad_credentialsä¸­çš„conn = Connection(server, user=user_upn, password=password, authentication='SIMPLE', auto_bind=True)å¦‚æœç”¨conn = Connection(server, user=user_upn, password=password, authentication='NTLM', auto_bind=True)æœƒå ±éŒ¯ã€‚\r\n\r\nNTLMæ˜¯æ¯”è¼ƒåŠ å¼·çš„é©—è­‰æ ¼å¼ï¼Œç°¡å–®çš„å¯ä»¥ç”¨SIMPLEå°±å¥½ã€‚\r\n\r\n\r\n","categories":["Python"],"tags":["åŸºæœ¬åŸç†"]},{"title":"å…¬å¸è¡Œè™Ÿç™¼å‡½VBAç³»çµ±","url":"/posts/675663677/","content":"ğŸš©ä½¿ç”¨è€…æƒ…å¢ƒ\r\n\r\næƒ³è«‹å•æœ‰æ²’æœ‰å¯èƒ½ç”¨VBA\r\nå»åšä¸€èˆ¬å…¬å¸è¡Œè™Ÿç™¼å‡½çš„ç³»çµ±ï¼Œå› ç‚ºç›®å‰å…¬å¸æ˜¯åœŸæ³•ç…‰é‹¼ç”¨WORDå»æ‰“ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦åšå…©å€‹æª”æ¡ˆæ­£æœ¬è·Ÿå‰¯æœ¬ï¼Œå› ç‚ºæœ‰æ™‚å€™ç™¼æ–‡æ˜¯éœ€è¦ç™¼çµ¦æ¥­ä¸»è·ŸPCMï¼Œç”šè‡³æ˜¯ç™¼æ–‡ç·¨è™Ÿä¹Ÿèƒ½ç³»çµ±æ ¹æ“šæ—¥æœŸè‡ªå‹•æ•´ç†ç”¢ç”Ÿ\r\n\r\nğŸ›’éœ€æ±‚åˆ†æ\r\nåŸºæœ¬æµç¨‹\r\n\r\ngraph TD;\r\n    A[æ¥ç²å–®ä½ä¾†æ–‡] --> B{é–‹å§‹é€²è¡Œå…¬æ–‡å¡«å¯«};\r\n    B -->|æ‰‹å‹•å¡«å¯«| C[å–å¾—å…¬æ–‡æ–‡è™Ÿ];\r\n    B -->|åŒ¯å…¥ç¯„æœ¬| C;\r\n    C --> D[è¼¸å…¥ä¸»æ—¨ã€èªªæ˜];\r\n    D --> E[é¸å–é™„ä»¶å…§å®¹];\r\n    E --> F[é¸æ“‡æ­£å‰¯æœ¬æ”¶æ–‡å°è±¡];\r\n    F --> G[æé€è¡¨å–®];\r\n    G --> H{æ˜¯å¦ç‚ºé€šç”¨é¡å‹?};\r\n    H -->|æ˜¯| I[å»ºç«‹ç‚ºç¯„æœ¬] --> J[åˆ—å°å…¬æ–‡];\r\n    H -->|å¦| J[åˆ—å°å…¬æ–‡];\r\n\r\nä½¿ç”¨è€…ç•«é¢\r\n \r\nè³‡æ–™åº«\r\n\r\n\r\nFig3. å·¥ä½œè¡¨è¦åŠƒ\r\n\r\nå ±è¡¨\r\næœ€çµ‚æˆå“\r\n\r\n\r\nFig4. å ±è¡¨æœ€çµ‚é•·ç›¸\r\n\r\nè³‡æ–™å¤¾æ¶æ§‹\r\næ–¼Excelçš„åŒå€‹ç›®éŒ„ä¸‹æœƒå‡ºç¾ä¸‰å€‹è³‡æ–™å¤¾\r\n\r\nç™¼æ–‡PDF:å­˜æ”¾å…¬æ–‡PDFï¼Œæ ¹æ“šä¸åŒçš„æ­£æœ¬å‰¯æœ¬æ©Ÿé—œçš†é€²è¡Œå„²å­˜!\r\nç™¼æ–‡åŸå§‹æª”:å­˜æ”¾å°è£½æˆPDFçš„Excelæª”\r\né™„ä»¶è³‡æ–™å¤¾:æ ¹æ“šå„å€‹ä¸åŒå…¬æ–‡ç·¨è™Ÿæé€è¡¨å–®æ™‚çš„é™„ä»¶å…§å®¹æ‹‰å–è‡³è©²è³‡æ–™å¤¾å­˜æ”¾\r\n\r\nğŸéŒ¯èª¤ç´€éŒ„\r\n1. èªªæ˜æ ¼å¼\r\nèªªæ˜å…§å®¹æœ‰å¾ˆå¤šé»æ™‚ï¼ŒExcelç”¢è£½çš„æ ¼å¼ç„¡æ³•åƒWordæœ‰ç¸®è¡Œæ®µè½ã€‚\r\nç™¼ç”ŸåŸå› \r\nåŸæœ¬çš„è¨­è¨ˆæ˜¯å°‡èªªæ˜æ¬„ä½çš„å…§å®¹ç›´æ¥ä»£å…¥å¥—ç‰ˆçš„æŸä¸€å„²å­˜æ ¼ã€‚\r\nè§£æ±ºæ–¹æ³•\r\nåœ¨è¡¨å–®ä¸Šè¦è¼¸å…¥è³‡æ–™æ™‚ï¼Œå¦‚æœ‰åˆ†è¡Œéœ€æ±‚ï¼Œç”¨shift+Enterè®“å…§å®¹è·³è‡³ä¸‹å€‹æ®µè½ï¼Œç¨‹å¼åœ¨åˆ¤æ–·æ™‚å°±èƒ½æ‰¾åˆ°vbCrLf\r\né€™å€‹é—œéµå­—é€²è¡Œæ‹†åˆ†ï¼Œæ‹†åˆ†å°±èƒ½å¾—çŸ¥é †åºï¼Œå†å°‡é †åºç·¨è™Ÿä»£å…¥åˆ°Bæ¬„ä½ã€é †åºå…§å®¹ä»£å…¥åˆ°Cæ¬„ä½ï¼Œå°±èƒ½è£½ä½œå‡ºé¡ä¼¼Wordçš„ç¸®è¡Œæ®µè½ã€‚\r\n\r\n\r\nFig5. æ¨¡æ“¬Wordç¸®è¡Œçš„å¥—ç‰ˆä½ç½®\r\n\r\n2. å…§å®¹æ¶ˆå¤±\r\nå„²å­˜æ ¼æ¬„ä½ç„¡æ³•è‡ªå‹•è·Ÿè‘—å…§å®¹çš„è‡ªå‹•æ›è¡Œé€²è¡Œæ”¾å¤§ï¼Œå°è‡´éƒ¨åˆ†å…§å®¹æœƒè¢«å„²å­˜æ ¼çš„åˆ—é«˜é™åˆ¶å…¶é¡¯ç¤ºå…§å®¹ã€‚\r\nç™¼ç”ŸåŸå› \r\nåœ¨ç¨‹å¼ç¢¼ä¸­è¨­å®š\r\nrows.autofitï¼Œä½†å¦‚æœé‡åˆ°åˆä½µå„²å­˜æ ¼æ™‚å°±æœƒå¤±æ•ˆã€‚\r\nè§£æ±ºæ–¹æ³•\r\nå–å¾—åˆä½µå„²å­˜æ ¼çš„å„å€‹æ¬„ä½å¯¬åº¦ï¼Œåœ¨ä¸é€²è¡Œåˆ—å°çš„å–®å„²å­˜æ ¼è¨­å®šå…¶å¯¬åº¦ç­‰åŒåˆä½µå„²å­˜æ ¼çš„å„å€‹æ¬„ä½å¯¬åº¦ç¸½å’Œï¼Œä¸¦ä¸”è‡ªå‹•æ›è¡Œã€å­—å‹å¤§å°éƒ½éœ€è¦ä¸€è‡´ï¼Œæœªä¾†åœ¨é€²è¡Œè‡ªå‹•åˆ—é«˜èª¿æ•´æ™‚å°±æœƒå»æŠ“å–è©²å–®å„²å­˜æ ¼çš„å±¬æ€§è‡ªè¡Œèª¿æ•´ã€‚\r\n\r\n\r\nFig6.\r\nåˆ—é«˜è‡ªå‹•èª¿æ•´æ¨™çš„ä½ç½®(ç´…=ä¸»æ—¨ï¼Œè—=èªªæ˜)\r\n\r\n3. åˆ—å°æˆæœ\r\nExcelä¸­çš„ç‰ˆå‹çœ‹èµ·ä¾†çš„ç•«é¢èˆ‡é è¦½ç•«é¢ç›¸ç¬¦ï¼Œä½†æ˜¯è¼¸å‡ºæˆPDFçš„æ™‚å€™å°±æœƒæœ‰äº›è¨±è½å·®ã€‚\r\nç™¼ç”ŸåŸå› \r\nä¸æ˜ï¼ŒçŒœæ¸¬æ˜¯æª¢è¦–è¨­å®šç‚ºåˆ†é æ¨¡å¼?\r\nè§£æ±ºæ–¹æ³•\r\nå°‡æª¢è¦–èª¿æ•´ç‚ºæ•´é æ¨¡å¼å‰‡å¯ä»¥æ­£å¸¸åˆ—å°ï¼Œç‰ˆå‹ä¸æœƒæœ‰è®ŠåŒ–ï¼Œæ–‡å­—ä¹Ÿæœƒå¦‚é è¦½æ™‚çš„ä½ç½®ã€‚\r\n4. é™„ä»¶é¸å–\r\né™„ä»¶å¤¾å¸¶æ™‚ç„¡æ³•é¸æ“‡ä¸åŒç›®éŒ„ä¸‹çš„æª”æ¡ˆå…§å®¹ã€‚\r\nç™¼ç”ŸåŸå› \r\nApplication.FileDialog(msoFileDialogFilePicker)\r\nå¤©ç”Ÿé™åˆ¶åªèƒ½åœ¨åŒä¸€å€‹ç›®éŒ„ä¸‹é€²è¡Œé¸æ“‡å¤šå€‹æª”æ¡ˆè·¯å¾‘ã€‚\r\nè§£æ±ºæ–¹æ³•\r\nè®“ä½¿ç”¨è€…èƒ½æœ‰æ©Ÿæœƒè¡¨é”æˆ‘é‚„è¦é¸æ“‡æª”æ¡ˆï¼Œè©³ç´°ç¨‹å¼ç¢¼å¦‚ä¸‹æ‰€ç¤º:\r\nFunction SelectFiles() As String    Dim fd As FileDialog    Dim filePath As String    Dim selectedItem As Variant    Dim response As VbMsgBoxResult        &#x27; å»ºç«‹ FileDialog ç‰©ä»¶ (é¸æ“‡æª”æ¡ˆæ¨¡å¼)    Set fd = Application.FileDialog(msoFileDialogFilePicker)        &#x27; è¨­å®šå…è¨±å¤šé¸    fd.AllowMultiSelect = True    fd.Title = &quot;è«‹é¸æ“‡æª”æ¡ˆ&quot;        &#x27; åˆå§‹åŒ–æª”æ¡ˆè·¯å¾‘è®Šæ•¸    filePath = &quot;&quot;        &#x27; é€²å…¥å¾ªç’°ï¼Œå…è¨±ç”¨æˆ¶å¤šæ¬¡é¸æ“‡æª”æ¡ˆ    Do        &#x27; é¡¯ç¤ºå°è©±æ¡†        If fd.Show = -1 Then            &#x27; éæ­·æ‰€æœ‰é¸å–çš„æª”æ¡ˆ            For Each selectedItem In fd.SelectedItems                filePath = filePath &amp; selectedItem &amp; &quot;;&quot;            Next selectedItem        End If                &#x27; å•ç”¨æˆ¶æ˜¯å¦é‚„æƒ³é¸æ“‡æ›´å¤šæª”æ¡ˆ        response = MsgBox(&quot;æ˜¯å¦é¸æ“‡æ›´å¤šæª”æ¡ˆ?&quot;, vbYesNo)                &#x27; å¦‚æœé¸æ“‡ã€Œå¦ã€ï¼Œå‰‡é€€å‡ºå¾ªç’°        If response = vbNo Then Exit Do    Loop        &#x27; ç§»é™¤æœ€å¾Œä¸€å€‹ &quot;;&quot;    If Len(filePath) &gt; 0 Then filePath = Left(filePath, Len(filePath) - 1)        &#x27; å›å‚³é¸å–çš„æª”æ¡ˆè·¯å¾‘ï¼ˆå¦‚æœæœªé¸å–å‰‡å›å‚³ç©ºå­—ä¸²ï¼‰    SelectFiles = filePath        &#x27; æ¸…é™¤ç‰©ä»¶    Set fd = NothingEnd Function\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["ExcelVBA"]},{"title":"æ–½å·¥æŠ½æŸ¥ç´€éŒ„è¡¨ç®¡æ§ç³»çµ±","url":"/posts/304659370/","content":"å‰è¨€\r\næŠ½æŸ¥ç´€éŒ„è¡¨å¸¶å»ç¾å ´å¯«å®Œå¾Œæœƒæƒæç•™å­˜æˆé›»å­æª”ï¼ŒæŠ½æŸ¥éç¨‹é€šå¸¸æœƒæ‹æ”ä½è­‰ç…§ç‰‡æª¢é™„æ–¼å¾Œæ–¹ï¼Œä»¥åˆ©å‘ˆç¾çµ¦å§”å“¡æª¢è¦–æŠ½æŸ¥éç¨‹æ˜¯å¦è©³å¯¦ç™»è¼‰ï¼Œä½†ç›¸ä¿¡æœ‰åšéçš„æœ‹å‹è‚¯å®šæœƒè¦ºå¾—é€™ä»½æ–‡ä»¶è£½ä½œéç¨‹å¯èªªæ˜¯ç›¸ç•¶ç¹é›œï¼Œç­†è€…æœ¬èº«ç›£é€ éç¨‹ä¹Ÿæ˜¯å—äº†ä¸å°‘è‹¦é›£ï¼Œåˆ»éª¨éŠ˜å¿ƒã€‚\r\nç—›é»\r\n\r\næŠ½æŸ¥è¨˜éŒ„è¡¨å¸¸è¢«è¦æ±‚æ‰‹å¯«ç´€éŒ„ï¼Œä¸èƒ½ç”¨é›»å­æª”ç°½åç”šè‡³è¬„æ‰“å…§å®¹ã€‚\r\næŠ½æŸ¥ç…§ç‰‡ä¸Šå‚³è‡³LINEç¾¤çµ„ï¼Œæœƒæœ‰éæœŸå•é¡Œï¼Œå¿…é ˆå¸¸å¸¸ä¸‹è¼‰æ­¸æª”ï¼Œè³‡æ–™å¤¾åˆ†é¡éç¨‹ä¹Ÿæ»¿éº»ç…©çš„ã€‚\r\næŠ½æŸ¥ç…§ç‰‡è¦åšæˆæ–½å·¥æŠ½æŸ¥è¡¨ç…§ç‰‡å ±è¡¨æ™‚ï¼Œè¦èŠ±å¾ˆå¤šæ™‚é–“è²¼ç…§ç‰‡+æ’°å¯«æè¿°æ–‡å­—ã€‚\r\næŠ½æŸ¥å ±è¡¨PDFåˆ†æ•£ï¼Œå¦‚æœè¦åˆ—å°å¾ˆå¤šå…§å®¹çš„æ™‚å€™ä¸å¥½æ‰¾ã€‚\r\næŠ½æŸ¥ç…§ç‰‡é›–ç„¶åˆ†é¡äº†ï¼Œä½†å¦‚æœè¦æ‰¾åˆ°æŒ‡å®šçš„æŠ½æŸ¥è¡¨ç·¨è™Ÿç›¸é—œç…§ç‰‡å¯èƒ½ä¸å¥½æ‰¾ã€‚\r\n\r\n\r\nå¦‚æœæ²’æœ‰æ¯å¤©åšä¸€äº›æ´»ï¼Œåˆ°äº†æŸ¥æ ¸æˆ–ç£å°çš„æ™‚å€™æœƒå¾ˆå¯æ€•çš„...\r\n\r\nè§£æ±ºæ–¹æ¡ˆ\r\né–‹ç™¼ä¸€å¥—å…¨ç«¯çš„ç³»çµ±ï¼Œå¯ä»¥åšåˆ°ä¸‹åˆ—äº‹é …\r\n\r\nç®¡ç†å„å€‹å°ˆæ¡ˆ(å·¥ç¨‹åç¨±)\r\nç®¡ç†å„å€‹å°ˆæ¡ˆä¸‹çš„æŠ½æŸ¥è¡¨åŠç…§ç‰‡\r\nå¾æŠ½æŸ¥è¡¨æ¸…å–®åˆ—å°æŒ‡å®šçš„æŠ½æŸ¥è¡¨ç¯„åœ\r\næ‰¾åˆ°æŒ‡å®šçš„æŠ½æŸ¥è¡¨çš„ç¬¬å¹¾æ¬¡çš„ç…§ç‰‡\r\n\r\né æœŸæˆæœ\r\n\r\n\r\nFig1. å ±è¡¨æˆæœ\r\n\r\n\r\n\r\nå½±ç‰‡æˆæœ\r\n\r\n\r\n\r\nğŸ”—\r\næ–½å·¥æŠ½æŸ¥ç³»çµ±é€£çµ\r\næ–½å·¥æŠ½æŸ¥ç³»çµ±-V2.0.4\r\nä½¿ç”¨é ˆçŸ¥\r\n\r\nè²´å–®ä½å¦‚æœè¦ºå¾—ä½¿ç”¨æ»¿æ„è¦å°å…¥å…¬å¸å…§éƒ¨ç³»çµ±ï¼Œå¯æä¾›ç¨‹å¼ç¢¼æ‰“åŒ…æœå‹™éƒ¨ç½²åˆ°æ‰€æŒ‡å®šä¸»æ©Ÿç©ºé–“ï¼Œé€™æ¨£å°±ä¸æœƒæœ‰å„²å­˜ç©ºé–“çš„é™åˆ¶ï¼Œä¹Ÿä¸æœƒèˆ‡ä»–äººå…±ç”¨è³‡æºã€‚\r\næŠ½æŸ¥è¡¨ç…§ç‰‡å ±è¡¨PDFå…ˆæš«æ™‚ç”¨é€™å€‹ç‰ˆå‹ï¼Œè€ƒé‡å„å€‹å–®ä½å¯èƒ½éƒ½æœ‰æ‰€å·®ç•°ï¼Œå†æä¾›ç‰ˆé¢æ´½æˆ‘ä¿®æ”¹èª¿æ•´ã€‚\r\nç›®å‰æ˜¯ç”¨Googleå¸³è™Ÿæ§åˆ¶æ¬Šé™ï¼Œå€‹äººç‰ˆåªèƒ½ç·¨è¼¯å€‹äººç”Ÿæˆçš„å°ˆæ¡ˆï¼Œè¦å®¢è£½æˆå¤šäººå…±åŒç·¨è¼¯åŒä¸€ä»½å°ˆæ¡ˆä¹ŸOKã€‚\r\n\r\næœ¬åœ°ä½ˆç½²æ–¹å¼\r\n(0607æ›´æ–°)åœ¨è‡ªå·±çš„ä¸»æ©Ÿéƒ¨ç½²æ–¹å¼:\r\n\r\nä¸‹è¼‰ Dockerï¼Œè©³æƒ…è«‹åƒè€ƒITå¹«å¹«å¿™\r\nä¸‹è¼‰ Gitï¼Œè©³æƒ…è«‹åƒè€ƒITå¹«å¹«å¿™\r\næ‰¾æŸä¸€å€‹è³‡æ–™å¤¾è¼¸å…¥æŒ‡ä»¤\r\n\r\n\r\ngit clone https://github.com/HankLin1995/st_eng.git\r\n\r\n\r\nç§»å‹•è‡³ st_eng è³‡æ–™å¤¾ä¸­ï¼Œè¼¸å…¥æŒ‡ä»¤\r\n\r\n\r\ndocker-compose up --build -d\r\n\r\n\r\næ‰“é–‹ç€è¦½å™¨è¼¸å…¥ localhost:8501 æ‡‰è©²å°±çœ‹çš„åˆ°äº†!\r\n\r\nPS:å¦‚æœå«Œå®‰è£GITå¤ªéº»ç…©ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ°åŸå§‹ç¢¼é é¢ä¸‹è¼‰ZIPï¼Œè§£å£“ç¸®å¾Œå†ç§»å‹•é€²å»ä¹Ÿå¯\r\nç›¸é—œç•«é¢\r\n\r\n\r\nFig2. æ–°å¢æŠ½æŸ¥è¡¨ç•«é¢\r\n\r\n\r\n\r\nFig3.\r\næ–°å¢æŠ½æŸ¥è¡¨ç•«é¢(ç…§ç‰‡å¯å¤šå¼µ)\r\n\r\n\r\n\r\nFig4.\r\næŠ½æŸ¥è¡¨æ¸…å–®ç•«é¢ï¼Œå‹¾é¸å¾Œå¯åˆ—å°æˆå ±è¡¨æˆæœ\r\n\r\n\r\n\r\nFig5.\r\nç…§ç‰‡åœ–å»Šï¼Œå¦‚è¦å¢åŠ ç…§ç‰‡å¯åœ¨é€™è£¡æ–°å¢\r\n\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Streamlit","FastAPI","ç›£é€ "]},{"title":"å·¥ç¨‹æ‹›æ¨™æ–‡ä»¶ç·šä¸Šå¥—å°ä½œæ³•","url":"/posts/169262062/","content":"å‰è¨€\r\nå…¬éƒ¨é–€å·¥ç¨‹æ¡ˆè¦ä¸Šç¶²æ‹›æ¨™ä¹‹å‰éƒ½æœƒéœ€è¦è£½ä½œæ‹›æ¨™æ–‡ä»¶åŠæŠ•æ¨™è¡¨å–®ï¼Œå…¶å…§å®¹åŒ…å«:\r\n\r\næ‹›æ¨™æ–‡ä»¶\r\n\r\n\r\nå·¥ç¨‹æ¡è³¼å¥‘ç´„\r\næŠ•æ¨™é ˆçŸ¥\r\n\r\n\r\næŠ•æ¨™è¡¨å–®\r\n\r\n\r\næ¨™å–®\r\næ¨™å°\r\næŠ•æ¨™æ–‡ä»¶å¯©æŸ¥è¡¨\r\né€€é‚„æŠ¼æ¨™é‡‘ç”³è«‹å–®\r\næŠ¼æ¨™é‡‘æŸ¥è©¢åŒæ„æ›¸\r\nä½¿ç”¨å°ç« æˆæ¬Šæ›¸\r\næŠ•æ¨™å» å•†è²æ˜æ›¸\r\næŠ•æ¨™åˆ‡çµæ›¸\r\nèº«åˆ†æ­éœ²è¡¨\r\n\r\næ—¢æœ‰ä½œæ³•æ˜¯åˆ©ç”¨WordVBAæ­é…Excelå…§å®¹å¥—å°ï¼Œä½†è‹¥æ‹›æ¨™æ–‡ä»¶æœ‰ç‰ˆæœ¬æ›´è¿­æ™‚ï¼Œéœ€è¦å°‡æ¯å€‹åŒä»çš„æª”æ¡ˆé€²è¡Œæ›´æ›æ‰èƒ½é€²è¡Œæ­£ç¢ºçš„å…§å®¹è¼¸å‡ºï¼Œé€™å°æ–¼ç‰ˆæœ¬æ§ç®¡æœ‰ç›¸ç•¶å¤§çš„é›£åº¦ã€‚\r\nç‚ºäº†æ¸›å°‘ç‰ˆæœ¬æ›´è¿­çš„å•é¡Œï¼Œç›®å‰è¨­è¨ˆç›´æ¥å°‡æœ€æ–°çš„å…§å®¹æ¨é€åˆ°ä¼ºæœå™¨ä½ç½®ï¼Œå‰ç«¯å‰‡åˆ©ç”¨ç¶²é é€²è¡Œè³‡æ–™å¡«å¯«ï¼Œè‡ªæ­¤å°±èƒ½å¤ åŠæ™‚è¼¸å‡ºæœ€æ­£ç¢ºçš„è³‡æ–™ï¼Œå¸Œæœ›é€éé€™æ¨£çš„è¨­è¨ˆèƒ½å¤ æ¸›å°‘æ‹›æ¨™æ–‡ä»¶ç”¢è£½çš„ç‰ˆæœ¬ç–æ¼ã€‚\r\n\r\næ¦‚ç•¥ä½œæ³•\r\n\r\nå„²å­˜é è¨ˆè¦å–ä»£çš„æ–‡å­—å…§å®¹åŠæ¨™ç±¤åç¨±ã€‚\r\nå°‡ç¯„æœ¬wordè¤‡è£½ä¸€ä»½å‡ºä¾†é€²è¡Œä¿®æ”¹ã€‚\r\næª¢æŸ¥wordä¸­æ˜¯å¦æœ‰æ¨™ç±¤åç¨±ã€‚\r\nå¦‚æœæœ‰æ‰¾åˆ°ï¼Œå°‡æ¨™ç±¤åç¨±é€²è¡Œå–ä»£å¾Œè¼¸å‡ºã€‚\r\nè¼¸å‡ºå…§å®¹æ‰“åŒ…æˆZIPï¼Œè®“ä½¿ç”¨è€…ä¸‹è¼‰ä½¿ç”¨ã€‚\r\n\r\nå¿…è¦çŸ¥è­˜é»\r\n\r\nStreamlit\r\npython-docx\r\n\r\næ“ä½œç¶²é \r\nğŸ”—\r\nå·¥ç¨‹æ‹›æ¨™æ–‡ä»¶V1.2.3\r\næ¨™ç±¤\r\nç›®å‰çš„å¯¦ä½œç”¨ %%\r\nç•¶ä½œæ¨™ç±¤çš„åµæ¸¬é»ï¼Œæ¼”ç®—éç¨‹æœƒé‡å°æ•´å€‹æ®µè½é€²è¡Œï¼Œåµæ¸¬åˆ°å¾Œæ‰æœƒå°‡æ¨™ç±¤åç¨±é€²è¡Œæ–‡å­—å–ä»£ã€‚\r\n\r\n\r\nFig1. æ¨™ç±¤ç¯„ä¾‹\r\n\r\nå¤šåŸ·è¡Œç·’\r\nä»¥å‰æ˜¯ä½¿ç”¨ Word VBA\r\né€²è¡Œæª”æ¡ˆçš„è™•ç†ï¼Œç¤™æ–¼VBAç‚ºå–®åŸ·è¡Œç·’çš„è™•ç†ï¼Œå³ä¾¿CPUæœ‰å¾ˆå¤šé¡†ï¼Œä½†ä»–ä¸€æ¬¡åªèƒ½å¤ è™•ç†ä¸€ä»½æ–‡ä»¶ï¼Œæ²’æœ‰è¾¦æ³•ç™¼æ®å¤šé¡†CPUçš„æ•ˆæœï¼Œå°è‡´æ–‡ä»¶åœ¨ç”Ÿæˆéç¨‹éƒ½æœƒéœ€è¦æ’éšŠï¼Œæ¶ˆè€—ä¸å°‘æ™‚é–“ã€‚\r\nPythonå¯ä»¥è—‰ç”±å¤šåŸ·è¡Œç·’çš„æ¼”ç®—æ³•ä¾†åŒæ™‚ä½µç™¼æª”æ¡ˆçš„è™•ç†ï¼Œè®“æ•´é«”ç”¢è£½æ‹›æ¨™æ–‡ä»¶éç¨‹æ™‚é–“ä¸‹é™ï¼Œç”šè‡³ç¬é–“å°±å®Œæˆï¼Œå°æ–¼æ™‚é–“ç›¸ç•¶å¯¶è²´çš„ç¾ä»£ä¾†èªªç›¸ç•¶æœ‰å¹«åŠ©!\r\nimport concurrent.futuresimport time# æ¨¡æ“¬ä»»å‹™: å‡è¨­è™•ç†æ™‚é–“ç‚ºéš¨æ©Ÿæ•¸å€¼çš„å»¶é²def task(task_id):    print(f&quot;ä»»å‹™ &#123;task_id&#125; é–‹å§‹è™•ç†...&quot;)    time.sleep(2)  # æ¨¡æ“¬è™•ç†å»¶é²    print(f&quot;ä»»å‹™ &#123;task_id&#125; è™•ç†å®Œæˆï¼&quot;)    return f&quot;çµæœ: ä»»å‹™ &#123;task_id&#125;&quot;def main():    # ä½¿ç”¨ ThreadPoolExecutor ä¾†ä¸¦è¡Œè™•ç†å¤šå€‹ä»»å‹™    with concurrent.futures.ThreadPoolExecutor(max_workers=4) as executor:        # æäº¤ä»»å‹™çµ¦åŸ·è¡Œç·’æ±         tasks = [executor.submit(task, i) for i in range(5)]        # ç­‰å¾…æ‰€æœ‰ä»»å‹™å®Œæˆä¸¦ç²å–çµæœ        for future in concurrent.futures.as_completed(tasks):            result = future.result()            print(result)if __name__ == &quot;__main__&quot;:    main()\r\n\r\næœ¬ç¯‡ç‚ºæ¡ç”¨Streamlitï¼Œä»ç„¶å±¬æ–¼å–®åŸ·è¡Œç·’çš„ä¸¦ä¸åŸç”Ÿæ”¯æŒå¤šåŸ·è¡Œç·’ï¼Œä¸Šæ–¹ç¯„ä¾‹ç¨‹å¼ç¢¼åƒ…èªªæ˜pythonæœ‰æ”¯æŒå¤šåŸ·è¡Œç·’çš„æ’°å¯«æ–¹å¼ï¼Œæ–¼DOSæŒ‡ä»¤ä¸Šå¯ä»¥ç™¼æ®å…¶æ•ˆæœã€‚\r\n\r\nå¾ŒçºŒç™¼å±•\r\nç›®å‰çš„ä»‹é¢ä»è³´æ–¼ä½¿ç”¨è€…é€²è¡Œè³‡æ–™å¡«å¯«å¾Œé»é¸æŒ‰éˆ•è¼¸å‡ºï¼Œç„¶è€Œèº«ç‚ºä¸€åç¨‹å¼è¨­è¨ˆå¸«ï¼Œè¦å¡«å¯«çš„è³‡æ–™è¶Šå°‘è¶Šå¥½ï¼Œå› æ­¤è®“å¡«å¯«è³‡æ–™é€™ä»¶äº‹æƒ…çµ¦é€å¯©é ç®—æ›¸çš„åŒäº‹é€²è¡Œï¼Œé‡å°é ç®—æ›¸å¯©æŸ¥çš„å…§å®¹é€²è¡Œå¡«å ±ã€‚\r\né ç®—æ›¸å¯©æŸ¥\r\nè³‡æ–™ç›¡å¯èƒ½é‡è¤‡åˆ©ç”¨ï¼Œè®“äº†è§£è©³æƒ…çš„äººå“¡é€²è¡Œå¡«å¯«æœ€æœ‰æ•ˆç‡ï¼ŒStreamlitå¥½è™•æ˜¯ä»–å¯ä»¥è‡ªå‹•é©æ‡‰å„ç¨®è£ç½®ï¼Œæ‰€ä»¥æ‰‹æ©Ÿéƒ¨åˆ†ä¹Ÿå¯ä»¥é€²è¡Œå¡«å¯«ï¼Œç‰ˆå‹ä¸Šä¹Ÿä¸è‡³æ–¼å¤ªé›£çœ‹ï¼Œåœ¨æ­¤å¯ä»¥å°‡éƒ¨å±¬çš„ç¶²é åšæˆQRCODEè²¼åœ¨è¾¦å…¬å®¤ä¸»æ©Ÿæ—ï¼Œè®“é€å¯©äººå“¡ç›´æ¥æƒæå¡«å¯«ã€‚\r\n\r\n\r\nFig2. é ç®—æ›¸å¯©æŸ¥ç•«é¢\r\n\r\nå·¥ç¨‹æ¡ˆä»¶ç¸½è¦½\r\nç›®å‰ç™¼å±•å‰›èµ·æ­¥ï¼Œæœªä¾†å¯ä»¥åšå„€è¡¨æ¿æ§åˆ¶ç›®å‰é€²åº¦åŠé ç®—åˆ†é…æƒ…å½¢ã€‚\r\n\r\n\r\nFig3. å·¥ç¨‹æ¡ˆä»¶ç¸½è¦½ç•«é¢\r\n\r\nè¼‰å…¥æ‹›æ¨™æ–‡ä»¶\r\né¸æ“‡å·²é€å¯©é ç®—æ›¸å…§å®¹ï¼Œå°‡å…¶æ‰€å¡«å¯«çš„è³‡æ–™ä¾åºå°å…¥åˆ°æŠ•æ¨™æ–‡ä»¶çš„æ¬„ä½ä¸­ï¼Œæ­¤è™•éœ€è¦å¡«å¯«çš„åªæœ‰æŠ¼æ¨™é‡‘é‡‘é¡åŠå±¥ç´„ä¿è­‰é‡‘ã€‚\r\n\r\n\r\nFig4. è¼‰å…¥æ‹›æ¨™æ–‡ä»¶ç•«é¢\r\n\r\nå¾Œè¨˜\r\nç¤™æ–¼å…¬éƒ¨é–€æœ‰è³‡æ–™å¤–æ´©çš„ç–‘æ…®ï¼Œåœ¨æ­¤åƒ…èƒ½æä¾›æ‹›æ¨™æ–‡ä»¶ç”¢è£½ç¶²é ä¾›ä½¿ç”¨ï¼Œæœªä¾†å¦‚æœ‰éœ€è¦å»ºç«‹è³‡æ–™åº«å¯å†å¼•ç”¨åŸå§‹ç¢¼è‡³è²´å–®ä½é€²è¡Œä½¿ç”¨ï¼Œè³‡æ–™åº«çš„å»ºç½®åˆæ˜¯å¦å¤–ä¸€å€‹èª²é¡Œäº†ï¼Œæœ¬ç¯‡ä¸å†è´…è¿°ã€‚\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Streamlit","Python-docx"]},{"title":"æ–½å·¥æ—¥èªŒVBA-V3.6.0ç³»åˆ—æ›´æ–°èªªæ˜","url":"/posts/3015163677/","content":"å‰è¨€\r\næœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ æ–½å·¥æ—¥èªŒVBA-V3.5.0\r\nç‰ˆæœ¬æ“ä½œæ•™å­¸ï¼Œéå¸¸æ„Ÿè¬å„è·¯å¥½å‹æä¾›å¯¶è²´æ„è¦‹ï¼Œæœ¬ç¯‡ä¸‹æ–¹æœƒè©³åˆ—å„ç‰ˆæœ¬ä¿®æ”¹é€²ç¨‹ä¾›å„ä½åšåƒè€ƒã€‚\r\n\r\næ–°åŠŸèƒ½\r\n\r\n\r\nå¾Œè™•ç†å·¥å…·åŒ¯å…¥\r\nå¥‘ç´„é …ç›®æœå°‹\r\nä¸è¨ˆå·¥æœŸ\r\nè‡ªå‹•æ›è¡Œ\r\n\r\n\r\néŒ¯èª¤ä¿®å¾©\r\n\r\n\r\næ¬„ä½å¯¬åº¦æ‘ºç–Šé¡¯ç¤º\r\nå·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿ\r\n\r\n\r\nä¸»è¦åŠŸèƒ½èªªæ˜\r\n[å¥‘ç´„è¨­å®š]å¾Œè™•ç†å·¥å…·åŒ¯å…¥\r\n\r\n\r\nFig1. åŒ¯å…¥ç•«é¢\r\n\r\nè€ƒé‡æœ‰äº›å°ˆæ¡ˆä¸ä¸€å®šæœƒç”¨PCCESä¾†è™•ç†é ç®—æ›¸å…§å®¹ï¼Œå¯èƒ½åªæ˜¯ä¸€å€‹å¾ˆåƒçš„EXCELæª”ï¼Œæ•…æä¾›\"å¥‘ç´„è¨­å®šæ¨¡æ¿\"ç¯„æœ¬ä¾›ä½¿ç”¨è€…æ‰‹å‹•å¡«å¯«å†é€²è¡ŒåŒ¯å…¥ï¼Œéœ€æ³¨æ„å¡«å¯«éç¨‹é …æ¬¡ä¸èƒ½é‡è¤‡ã€‚\r\n[æ—¥å ±å¡«å¯«]å¥‘ç´„é …ç›®æœå°‹\r\n\r\n\r\nFig2. å¡«å¯«ç•«é¢\r\n\r\nå¥‘ç´„é …ç›®çš„ä¸‹æ‹‰å¼é¸å–®çµ„æˆç‚º\"å¥‘ç´„é …æ¬¡&gt;&gt;å¥‘ç´„é …ç›®\"ï¼Œæ•…å¯ä»¥é€²è¡Œå¥‘ç´„é …ç›®é—œéµå­—çš„æœå°‹æˆ–è€…å¥‘ç´„é …æ¬¡çš„é—œéµå­—æœå°‹ã€‚\r\n\r\nèˆ‰ä¾‹: \r\n\r\n\r\n\r\nå¦‚è¦é€²è¡Œå¥‘ç´„é …æ¬¡çš„æœå°‹ï¼Œè¼¸å…¥é—œéµå­—ã€Œç”².å£¹ã€ï¼Œå‰‡æœƒåˆ—å‡ºæ‰€æœ‰ç”².å£¹é–‹é ­çš„å¥‘ç´„é …ç›®\r\nå¦‚è¦é€²è¡Œå¥‘ç´„é …ç›®çš„æœå°‹ï¼Œè¼¸å…¥é—œéµå­—ã€Œå®‰å…¨åœç±¬ã€ï¼Œå‰‡æœƒåˆ—å‡ºæ‰€æœ‰åç¨±å…·æœ‰å®‰å…¨åœç±¬çš„å¥‘ç´„é …ç›®ã€‚\r\n\r\n\r\nä¸è¨ˆå·¥æœŸåŠŸèƒ½\r\n\r\n\r\nFig4. é€²åº¦è¨­å®šç•«é¢\r\n\r\nå»ºç«‹ä¸è¨ˆå·¥æœŸå·¥ä½œè¡¨ï¼Œå¦‚ç‚ºä¸è¨ˆå·¥æœŸçš„æ—¥æœŸæ™‚ï¼Œé€²åº¦èˆ‡å‰æ—¥æœ‰è¨ˆå·¥æœŸæ™‚ç›¸åŒ\r\n\r\n\r\nFig5. ç¯„ä¾‹\r\n\r\nè‡ªå‹•æ›è¡Œ\r\nè¼¸å‡ºæ–½å·¥æ—¥èªŒæ™‚ï¼Œå¦‚æœ‰å¥‘ç´„é …ç›®æ¯”è¼ƒé•·çš„æƒ…æ³ï¼Œä»¥å¾€æ¡ç”¨æ¬„ä½å…§æ–‡å­—å¤§å°è‡ªå‹•ç¸®æ”¾é€²è¡Œè™•ç†ï¼Œç„¶è€Œå¦‚æ–‡å­—é•·åº¦éé•·æ™‚ï¼Œæœƒè®“å¥‘ç´„é …ç›®è®Šå¾—ç„¡æ³•è‚‰çœ¼è­˜åˆ¥ï¼Œå› æ­¤æ”¹ç”¨è‡ªå‹•æ›è¡Œæ­é…åˆ—é«˜è‡ªå‹•èª¿æ•´è™•ç†ã€‚\r\n\r\nä¸»è¦éŒ¯èª¤èªªæ˜\r\næ¬„ä½å¯¬åº¦æ‘ºç–Šé¡¯ç¤º\r\n\r\n\r\nFig6. æ¬„ä½æ‘ºç–Šç¯„ä¾‹\r\n\r\næ¬„ä½å¯¬åº¦ä¸è¶³ä»¥é¡¯ç¤ºæ—¥æœŸæ™‚ï¼ŒEXCELå…§å»ºçš„æœå°‹åŠŸèƒ½æœƒå¤±æ•ˆï¼Œæ•…åœ¨é€²è¡Œæœå°‹å‰å…ˆé‡å°é è¨ˆè¦æœå°‹çš„å·¥ä½œè¡¨é€²è¡Œæ¬„å¯¬è‡ªå‹•é©æ‡‰ã€‚\r\nå·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿ\r\nåŸå·¥æ–™è¨­å®šéç¨‹åœ¨ç·¨è™Ÿæ™‚æœƒé€éè¨ˆç®—åŒæ€§è³ªçš„å€‹æ•¸åšåŠ ç¸½å¾ŒåŠ ä¸€æ›ç®—ï¼Œå¦‚æœæœ‰å…ˆé€²è¡Œåˆªé™¤å†è‡ªå‹•ç·¨è™Ÿçš„è©±æœƒæœ‰ç·¨è™Ÿé‡ç–Šçš„å•é¡Œï¼Œå°è‡´å ±è¡¨è¼¸å‡ºæ™‚çš„æœå°‹åŠŸèƒ½ç•°å¸¸ï¼Œæ•…æ”¹ç‚ºè‡ªå‹•ç·¨è™Ÿä¹‹å‰å…ˆé‡å°åŒæ€§è³ªçš„å…§å®¹æ’åºå¾Œå–æœ€å¤§å€¼åŠ ä¸€æ›ç®—ã€‚\r\n\r\nç‰ˆæœ¬ç´°ç¯€\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nç‰ˆæœ¬è™Ÿ\r\nå‹æ…‹\r\nå…§å®¹\r\n\r\n\r\n\r\n\r\nV3.6.6\r\nFeature\r\næ•¸é‡è¨ˆç®—è¡¨é å°¾åŠ å…¥ç¬¬Oé /å…±Oé \r\n\r\n\r\n\r\nFix\r\nä¿®æ­£å·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿé‡è¤‡å•é¡Œ\r\n\r\n\r\nV3.6.5\r\nFix\r\nèª¿æ•´å„è¡¨æ¬„ä½è‡ªå‹•ç¸®æ”¾ï¼Œé¿å…å‡ºç¾###å½±éŸ¿æœå°‹\r\n\r\n\r\nV3.6.4\r\nFix\r\nåˆ—å°å ±è¡¨æ™‚é è¨­ç‚ºç¬¬ä¸€å€‹å ±è¡¨é …ç›®\r\n\r\n\r\nV3.6.3\r\nFix\r\nç¬¬å…­é …åˆ—é«˜è‡ªå‹•èª¿æ•´\r\n\r\n\r\nV3.6.2\r\nFix\r\nä¿®å¾©clsInfoæŸ¥æ‰¾æ¬„ä½å•é¡Œã€åˆ—å°æ—¥å ±å‰æœƒå…ˆé€²è¡Œé€²åº¦é‡æ•´\r\n\r\n\r\nV3.6.1\r\nFix\r\nä¿®å¾©å‘ˆç¾ç«£å·¥æ—¥æœŸæ¬„ä½æ‰¾å°‹å•é¡Œ(clsReport)\r\n\r\n\r\nV3.6.0\r\nFeature\r\nç¬¬äºŒå¤§é …è·Ÿç¬¬ä¸‰å¤§é …æ•¸é‡æ²’æœ‰å°±å¢åˆ—ä¸€è¡Œç©ºç™½åˆ—\r\n\r\n\r\n\r\nFeature\r\næ–½å·¥æ—¥èªŒæˆæœä¾ç…§æ—¥æœŸå‘ˆç¾(åŸæœ¬è¨­è¨ˆç‚ºæŒ‰ç…§ç·¨è™Ÿ)\r\n\r\n\r\n\r\nFeature\r\næ©Ÿå…·ã€äººåŠ›ã€ææ–™æŒ‰ç…§é¡åˆ¥æ’åº\r\n\r\n\r\nV3.5.12\r\nFix\r\næ•¸é‡è¨ˆç®—è¡¨åŸå‘ˆç¾0.00ä¿®æ­£ç‚º-\r\n\r\n\r\n\r\nFix\r\nå‰æœŸå®Œæˆæ•¸é‡å…¬å¼ä¿®æ­£\r\n\r\n\r\n\r\nFix\r\næ•¸é‡è¨ˆç®—è¡¨è¡¨å ±ç·¨è™Ÿæ¬„ä½è£œä¸ŠéŒ¯èª¤æ§åˆ¶\r\n\r\n\r\nV3.5.11\r\nFix\r\nå·¥æ–™è¨­å®šä¸‹æ‹‰å¼é¸å–®æ›´æ–°ï¼Œä¿®æ”¹ç”Ÿæ•ˆæ—¥æ§åˆ¶ï¼Œå¯ä»¥é€²è¡Œåˆªé™¤\r\n\r\n\r\n\r\nFeature\r\nfrmDataå‰©é¤˜æ•¸é‡æé†’ç´…å­—å¢åŠ è­¦å‘Šè¦–çª—!\r\n\r\n\r\n\r\nFeature\r\nè¡¨å–®é¡¯ç¤ºä¿®æ”¹æˆ\"ä¸\"å¼·åˆ¶éŸ¿æ‡‰\r\n\r\n\r\n\r\nFix\r\nP008 åˆ—é«˜è‡ªå‹•èª¿æ•´\r\n\r\n\r\nV3.5.10\r\nFeature\r\nåŠ å…¥æœå°‹åŠŸèƒ½ï¼Œå¯ä»¥æœå°‹é …ç›®æˆ–æœå°‹é …æ¬¡ï¼Œç©ºç™½å‰‡å…¨é¡¯\r\n\r\n\r\n\r\nFeature\r\nåŠ å…¥æ–°å ±è¡¨ï¼Œå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ä¸å«é …æ¬¡)ï¼Œä¿®å¾©æœ¬æ—¥ä¸æ–½å·¥æ¬„ä½\r\n\r\n\r\n\r\nFix\r\næ–°å¢æ•¸é‡è¨ˆç®—è¡¨ï¼Œå·¥ä½œè¡¨åç‚ºå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(æœˆåº•)\r\n\r\n\r\n\r\nFix\r\næ–½å·¥é …ç›®å‘ˆç¾çš„æ•¸é‡åˆ°å°æ•¸é»å¾Œç¬¬2ä½ï¼ŒNumberformatlocal\r\n\r\n\r\n\r\nFix\r\nè¡¨å ±ç·¨è™Ÿé¡¯ç¤ºä¿®æ”¹ç‚º&lt;&gt;ï¼Œä½¿ç”¨å­—ä¸²æ ¼å¼\r\n\r\n\r\nV3.5.9\r\nFeature\r\nåŠ å…¥æ–°å ±è¡¨ï¼Œå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(æœˆåº•)ï¼Œç‚ºæ•¸é‡è¨ˆç®—è¡¨\r\n\r\n\r\n\r\nFeature\r\nè¼¸å‡ºå ±è¡¨æ™‚å­—é«”å¤§å°è¨­ç½®10ptç‚ºè‡ªå‹•æ›è¡Œï¼ŒåšAutoFité¡¯ç¤º\r\n\r\n\r\n\r\nFix\r\nèª¿æ•´å¥‘ç´„é …ç›®ä¸»é …å¤§é¡åˆ¤å®šæ¬„ä½ç‚º\"å–®ä½\"=ç©ºç™½\r\n\r\n\r\n\r\nFeature\r\nåŠ å…¥å¥‘ç´„é …ç›®æ¨™è¨˜\"H\"ç‚ºæŠ˜ç–Šé …ç›®\r\n\r\n\r\nV3.5.8\r\nFix\r\nä¿®å¾©eng_pgs&lt;&gt;1çš„éŒ¯èª¤ï¼Œå¦‚æœç‚ºdoubleéœ€è¦å…ˆåšround(x,6)\r\n\r\n\r\n\r\nFeature\r\nåŠ å…¥ä¸è¨ˆå·¥æœŸåŠŸèƒ½ï¼ŒåŠŸèƒ½ä½æ–¼frmPgsçš„å³ä¸‹è§’\r\n\r\n\r\nV3.5.7\r\nFix\r\nåŠ å…¥\"æœ¬æ—¥ç„¡æ–½å·¥\"é …ç›®ï¼Œé è¨­é€²åº¦ç‚ºå‰æ—¥ç´¯è¨ˆé€²åº¦\r\n\r\n\r\nV3.5.6\r\nFix\r\nåˆ—å°å ±è¡¨æ™‚éš±è—ç©ºç™½åˆ—ä½ææ–™åç¨±åµæ¸¬ä¿®å¾©(hideEmptyRow)\r\n\r\n\r\nV3.5.5\r\nFeature\r\nåŸºæœ¬æ“ä½œæ¬Šé™æ§ç®¡åŠ å…¥clsFetchURL\r\n\r\n\r\nV3.5.4\r\nFix\r\nå¥‘ç´„é …ç›®ä¸­ä¸»é …ç›®åˆ¤å®šä¿®å¾©(IsMainItems(cont))\r\n\r\n\r\n\r\nFeature\r\nå¥‘ç´„é …ç›®å¯ä»¥å¼•å…¥å¾Œè™•ç†å·¥å…·ç”¢ç”Ÿä¹‹excel\r\n\r\n\r\n\r\nFix\r\nä¸è¨ˆå…¥é€²åº¦é …ç›®ä»æä¾›çµ¦ä½¿ç”¨è€…é€²è¡Œå¡«å¯«\r\n\r\n\r\nV3.5.3\r\nTODO\r\næ–°å¢ç›£é€ å ±è¡¨(ç®¡ç†è™•)ç‰ˆæœ¬-å°šæœªå®Œæˆ\r\n\r\n\r\n\r\nFix\r\nè®Šæ›´è¨­è¨ˆå¾Œå…¶å¥‘ç´„æ•¸é‡ç‚º0çš„ç›£é€ æ—¥å ±é¡¯ç¤ºæ–‡å­—ä¿®æ­£\r\n\r\n\r\n\r\nFeature\r\næ–°å¢getRangeByKeyï¼Œå„ªåŒ–adjustRowã€hideEmptyRow\r\n\r\n\r\nV3.5.2\r\nFix\r\nè³‡æ–™è¦é€²å…¥å„è¡¨æ™‚ï¼Œå…ˆåšå¥½æ¬„ä½æ ¼å¼è™•ç†(æ—¥æœŸ)\r\n\r\n\r\nV3.5.1\r\nFix\r\nç•¶ç·¨è¼¯æ—¥å ±å¼•å…¥è³‡æ–™è‡³frmDataæ™‚ï¼Œå†é€²è¡Œæ–°å¢ç„¡æ³•æ¸…ç©º(clearFrmDataInfo)\r\n\r\n\r\n\r\nFix\r\næ—¥å ±è¡¨å–®åŸæœ¬é è¨­éæ˜¯å³ç„¡ï¼Œæ–°å¢ç©ºç™½é …ç›®ä¸¦è¨­å®šç‚ºé è¨­\r\n\r\n\r\n\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["ExcelVBA","æ–½å·¥æ—¥èªŒ"]},{"title":"æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡","url":"/posts/426352985/","content":"å‰è¨€\r\næœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ æ–½å·¥æ—¥èªŒVBA-V3.5.0\r\nç‰ˆæœ¬æ“ä½œæ•™å­¸\r\nå¾å‰ç¯‡ç¬¬1æ­¥é©Ÿé–‹å§‹é€²è¡Œçš„æœ‹å‹ï¼Œæœƒç™¼ç¾æœ‰ä¸€å€‹ç”Ÿæ•ˆæ—¥æ˜¯ç©ºç™½çš„ï¼Œé€™å°±æ˜¯è®“ä½¿ç”¨è€…è¦é–‹å§‹å¡«å¯«æ—¥å ±å‰çš„æœ€å¾Œç¢ºèªï¼Œç¢ºèªç„¡èª¤å¾Œä¾¿æœƒå°‡ç”Ÿæ•ˆæ—¥åŠ è¨»(ç¬¬ä¸€æ¬¡åŠ è¨»æœƒèˆ‡é–‹å·¥æ—¥ç›¸åŒ)ï¼Œæ­¤æ™‚æ‰èƒ½é–‹å§‹å¡«å¯«æ—¥å ±ï¼Œå¡«å¯«æ—¥å ±å¾Œéœ€è¦é»é¸\"å„²å­˜æ—¥å ±\"è³‡æ–™æ‰æœƒç”Ÿæ•ˆï¼Œå–æ¶ˆå¡«å¯«æ™‚åªèƒ½é€éæŒ‰éˆ•\"å–æ¶ˆå¡«å¯«\"ï¼Œä¸èƒ½é»é¸å³ä¸Šè§’çš„Xã€‚\r\nå¡«å¯«æ—¥å ±çš„éç¨‹ï¼Œå¯ä»¥åœ¨ç‰ˆæœ¬èªªæ˜ä¸­çš„\"åŠŸèƒ½ä¸»è¦ç•«é¢\"è£¡é¢å°æ—¥å ±é€²è¡Œæ–°å¢ã€ç·¨è¼¯ã€åˆªé™¤ï¼Œæœ‰é—œæ—¥å ±å¡«å¯«å…§å®¹åˆ†ç‚ºä»¥ä¸‹å¹¾ç¨®å…§å®¹:\r\n\r\nåŸºæœ¬è³‡è¨Š\r\nå¥‘ç´„é …ç›®\r\nææ–™\r\näººåŠ›\r\næ©Ÿå…·\r\nå…¶ä»–å‚™è¨»\r\nç›£é€ éƒ¨åˆ†\r\n\r\n\r\nåŸºæœ¬è³‡è¨Š\r\næ—¥æœŸ\r\næ—¥æœŸåœ¨é€²è¡Œæ–°å¢æ—¥å ±çš„æ™‚å€™ä¾¿æœƒè¦æ±‚è¼¸å…¥ï¼Œå¦‚æœæœ‰é‡è¤‡å‰‡æœƒè­¦ç¤ºå·²ç¶“æœ‰å¡«å¯«éäº†ï¼Œæœ¬ç¯‡æ—¨åœ¨ä»‹ç´¹å·¥ç¨‹å°ˆæ¡ˆé¡å‹ï¼Œè€Œéé–‹å£å¥‘ç´„é¡å‹ï¼ŒåŸå‰‡æ¯æ—¥æœƒæœ‰ä¸€ç¯‡æ—¥å ±ä½œç‚ºç´€éŒ„ä½¿ç”¨ã€‚\r\næˆ‘æœ‰é ç•™ä¸€æ—¥å¤šè¡¨çš„æ“´å……ç¨‹å¼ç¢¼ï¼Œå¦‚æœæœ‰éœ€è¦è«‹è¯çµ¡æˆ‘é€²è¡Œä¿®æ”¹ã€‚\r\nå¤©æ°£\r\nå¤©æ°£éƒ¨åˆ†åˆ†ç‚ºä¸Šåˆè·Ÿä¸‹åˆï¼Œå…§å®¹æœ‰æ™´ã€é™°ã€é›¨ï¼Œæœªä¾†é å®šæœƒæä¾›ä¸€å€‹åƒè€ƒæ¸¬ç«™ï¼Œé€éä¸­å¤®æ°£è±¡å±€APIå»å–å¾—ç›¸å°æ™‚æ®µçš„è‡ªå‹•æ¸¬å ±å…§å®¹ã€‚\r\nå¥‘ç´„é …ç›®\r\né …ç›®\r\n\r\n\r\nFig1. é …ç›®\r\n\r\nå¥‘ç´„é …ç›®å¡«å¯«ä¾†æºç‚ºå¥‘ç´„è¨­å®šçš„é …ç›®ï¼Œæœ‰é—œå¥‘ç´„é …ç›®æœ‰å…©é …ç‰¹åˆ¥è¦æ³¨æ„çš„äº‹é …:\r\n\r\nè¨­å®šç‚ºä¸åˆ—å…¥é€²åº¦é …ç›®ï¼Œå‰‡ä¸æœƒè¢«è¨ˆå…¥é€²åº¦æ›ç®—æ™‚çš„åˆ†æ¯ã€‚\r\nè¨­å®šç‚ºç™¼åŒ…å·¥ä½œè²»å¤–çš„é …ç›®ï¼Œå‰‡ä¸æœƒé¡¯ç¤ºæ–¼ä¸‹æ‹‰å¼é¸å–®ä¸­ã€‚\r\n\r\né¸å–å¥‘ç´„é …ç›®å¾Œï¼ŒæœƒåŒæ­¥å‘ˆç¾è©²é …ç›®ä¹‹å¥‘ç´„æ•¸é‡ã€ç´¯è¨ˆæ•¸é‡ï¼Œå¡«å¯«æ–½ä½œæ•¸é‡æ™‚ï¼ŒæœƒåŒæ™‚æ–¼å³å´é¡¯ç¤ºå‰©é¤˜æ•¸é‡ï¼Œå¦‚å‡ºç¾ç´…è‰²è¡¨ç¤ºå‰©é¤˜æ•¸é‡ç‚ºè² å€¼ã€ç¶ è‰²è¡¨ç¤ºä»æœ‰å‰©é¤˜æ•¸é‡å¯ä»¥ä½¿ç”¨ã€‚\r\nè¼¸å…¥å®Œç•¢é»é¸\"æ–°å¢\"ï¼Œé …ç›®å°‡æœƒåˆ—æ–¼ä¸‹æ–¹æš«å­˜å€åŸŸï¼Œå¯ä»¥ç­‰æ‰€æœ‰é …ç›®(åŒ…å«å¾ŒçºŒå…§å®¹çš†å®Œæˆå¾Œ)åœ¨ä¸€ä½µé»é¸\"å„²å­˜æ—¥å ±\"ï¼Œæ­¤æ™‚è³‡æ–™æ‰æœƒæ­£å¼åŒ¯å…¥æ—¥å ±ä¸­ã€‚\r\né€²åº¦\r\né€²å…¥ç•«é¢æ™‚ï¼Œæœƒé å…ˆå–å¾—ç´¯ç©è‡³å‰æ—¥ä¹‹é‡‘é¡åŠé€²åº¦ï¼Œç•¶å¡«å¯«é …ç›®å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•æ›ç®—æœ¬æ—¥é‡‘é¡èˆ‡æœ¬æ—¥é€²åº¦å‘ˆç¾æ–¼å·¦ä¸‹è§’ï¼Œå…©æ¨£æ•¸å€¼åŠ ç¸½å¾Œå–å¾—æœ¬æ—¥ç´¯ç©å¯¦éš›é€²åº¦ï¼ŒåŒæ™‚æœƒæ ¹æ“šå¯¦éš›é€²åº¦èˆ‡é å®šé€²åº¦çš„å·®ç•°å‘ˆç¾ç´…è‰²æˆ–ç¶ è‰²ã€‚\r\nææ–™ã€äººåŠ›ã€æ©Ÿå…·\r\né …ç›®ä¾†æºç‚ºå·¥æ–™è¨­å®šï¼Œé€™è£¡æ¯”è¼ƒå–®ç´”æ²’æœ‰å…¶ä»–å…§å®¹ï¼Œåƒ…ä½œç‚ºç´€éŒ„ä½¿ç”¨ï¼Œæ–¼å·¥æ–™è¨­å®šä¸­å¦‚æœ‰å¡«å¯«å…¶ç›¸é—œå–®åƒ¹ï¼Œæœªä¾†å¯ä»¥åŠ å…¥åŠŸèƒ½è¼¸å‡ºçµ±è¨ˆé•·è¡¨ï¼Œè®“ç®¡ç†è€…æ¸…æ¥šç›®å‰æ‰€æ”¯å‡ºçš„å…§å®¹ï¼ŒåŒ…å«äººåŠ›è²»ç”¨ã€ææ–™è²»ç”¨ã€æ©Ÿå…·è²»ç”¨ï¼Œæ–¹ä¾¿èˆ‡ä¼°é©—è«‹æ¬¾å¾Œçš„ç¾é‡‘æµåšæ¯”å°è©•ä¼°è²¡å‹™æ”¯å‡ºæ”¶å…¥ç‹€æ³ã€‚\r\n\r\n\r\nFig2. å·¥æ–™è¨­å®šç•«é¢\r\n\r\nå…¶ä»–å‚™è¨»\r\n\r\n\r\nFig3. å…¶ä»–å‚™è¨»\r\n\r\næœ‰é—œå…¶ä»–æ¯”è¼ƒé•·çš„æ–‡å­—ç´€éŒ„éƒ¨åˆ†çš†æœƒåœ¨æ­¤é€²è¡Œï¼Œä¹‹å‰å§”å“¡æœ‰èªªéæ ¼å­ä¸èƒ½å¡—é»‘ï¼Œè¦æ‰“å‹¾ï¼Œé€™è£¡æœ‰æä¾›é¸é …çµ¦ä½¿ç”¨è€…é¸å–ï¼Œå¦‚æœè®“é›»è…¦æ‰“å‹¾ä¹Ÿä¸è¡Œï¼Œè«‹é¸å–å…©é‚Šéƒ½æ˜¯ç©ºç™½æ¡†æ¡†ã€‚\r\nå¦é—œæ–¼æ–½å·¥å–æ¨£è©¦é©—ç´€éŒ„èˆ‡é‡è¦äº‹é …ç´€éŒ„æœªä¾†é è¨ˆæœƒèˆ‡æ”¶ç™¼æ–‡ç³»çµ±ã€å“ç®¡ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼Œè«‹å†ç¨ç­‰ä¸‹!\r\nç›£é€ éƒ¨åˆ†\r\nå¦‚æœåªæœ‰å–®ç´”è¦åšæ–½å·¥æ—¥èªŒçš„ä½¿ç”¨è€…ï¼Œå¯ä»¥è·³éé€™ä¸€å€‹æ­¥é©Ÿã€‚\r\n\r\n\r\nFig4. ç›£é€ éƒ¨åˆ†\r\n\r\næœ‰é—œå…¶ä»–æ¯”è¼ƒé•·çš„æ–‡å­—ç´€éŒ„éƒ¨åˆ†çš†æœƒåœ¨æ­¤é€²è¡Œï¼Œæ‰“å‹¾æƒ…æ³ä¸€æ¨£æœ‰åšè€ƒé‡ï¼ŒåŒæ¨£æä¾›ä¸‰ç¨®æƒ…æ³ä¾›ä½¿ç”¨è€…é¸å–ã€‚\r\nç›®å‰å·¥ç¨‹é€²è¡Œæƒ…æ³ï¼Œå¯ä»¥è‡ªè¡Œå¡«å¯«æˆ–è€…æ˜¯é€éå‰é¢å¡«å¯«ä¹‹å¥‘ç´„é …ç›®åšç™¾åˆ†æ¯”æ›ç®—å‘ˆç¾(å¦‚ä¸‹åœ–)ã€‚\r\n\r\n\r\nFig5. ç™¾åˆ†æ¯”ç¯„ä¾‹\r\n\r\nå¦é—œæ–¼æª¢é©—åœç•™é»åŠæŠ½æŸ¥ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼ŒæŸ¥æ ¸ææ–™è¦æ ¼åŠå“è³ªèˆ‡å“ç®¡ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼Œè«‹å†ç¨ç­‰ä¸‹!\r\nç›¸é—œé€£çµ\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","æ–½å·¥æ—¥èªŒ"]},{"title":"æ–½å·¥æ—¥èªŒVBA-ç‰ˆæœ¬èªªæ˜","url":"/posts/1512537146/","content":"ç‰ˆæœ¬å…§å®¹æ¯”è¼ƒ\r\n\r\n\r\n\r\né …ç›®\r\nè¨‚é–±ç‰ˆ\r\n\r\n\r\n\r\n\r\nåŸºæœ¬åŠŸèƒ½\r\nO\r\n\r\n\r\néŒ¯èª¤ä¿®å¾©\r\nO\r\n\r\n\r\næŠ€è¡“æ”¯æ´\r\nO\r\n\r\n\r\nåŸå§‹ç¢¼\r\n\r\n\r\n\r\nä½¿ç”¨æœŸé™\r\nå·¥ç¨‹æœŸé–“\r\n\r\n\r\n\r\nå‚™è¨»äº‹é …\r\n\r\næ–½å·¥æ—¥èªŒèˆŠç‰ˆ(ç¤¾ç¾¤ç‰ˆ)æ­£åœ¨ä½¿ç”¨ä¸­çš„æœ‹å‹ä»å¯ä½¿ç”¨åˆ°2024å¹´åº•ï¼Œå¦‚éœ€è½‰æ›è‡³æ–°ç‰ˆè«‹è¯ç¹«ä½œè€…å”åŠ©ã€‚\r\nå¦‚æ¬²è³¼ç½®æ–½å·¥æ—¥èªŒæ–°ç‰ˆ(V3.5.0)ç³»åˆ—å¾Œä¹‹è¨‚é–±åŒ…å¥—æœå‹™(åŒ…å«è®Šæ›´è¨­è¨ˆã€å±•å»¶å·¥æœŸã€å¥‘ç´„é …ç›®å°å…¥)ï¼Œè«‹æä¾›ä»¥ä¸‹è³‡æ–™ä¸¦è¯ç¹«ä½œè€…\r\n\r\n\r\nå·¥ç¨‹åç¨±\r\nå¥‘ç´„é‡‘é¡\r\nå·¥ç¨‹æ—¥æ•¸\r\n\r\n\r\nè¯ç¹«æ–¹å¼\r\n\r\n\r\nLINE(ID:@903qzhwa)\r\né›»å­éƒµä»¶(apple84026113@gmail.com)\r\n\r\n\r\n\r\nåŸºæœ¬åŠŸèƒ½\r\n\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯ã€ç¬¬äºŒè¯)\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯ã€ç¬¬äºŒè¯)\r\nç›£é€ æ—¥å ±\r\n\r\néŒ¯èª¤ä¿®å¾©\r\n\r\nä¿®å¾©é‡å¤§ç³»çµ±éŒ¯èª¤\r\n\r\næŠ€è¡“æ”¯æ´\r\n\r\nå…¬ç‰ˆå ±è¡¨å¾®èª¿\r\nå®¢è£½åŠŸèƒ½æ“´å……(æŒ‰å·¥æ™‚å¦è¨ˆ)\r\nè®Šæ›´è¨­è¨ˆç•°å‹•\r\nå±•å»¶å·¥æœŸèª¿æ•´\r\n\r\næ³•è¦ä¾†æº\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ\r\nç›¸é—œé€£çµ\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-V3.5.0\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Excel VBA","æ–½å·¥æ—¥èªŒ"]},{"title":"æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡","url":"/posts/1990910755/","content":"å‰è¨€\r\næœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ æ–½å·¥æ—¥èªŒVBA-V3.5.0\r\nç‰ˆæœ¬æ“ä½œæ•™å­¸\r\nå–å¾—ä¸»ç¨‹å¼æ™‚ï¼Œæœƒé è¨­å­˜åœ¨ç¯„ä¾‹è³‡æ–™ï¼Œå¯å…ˆç”±ç¯„ä¾‹è³‡æ–™å¤§è‡´äº†è§£æœªä¾†ä½¿ç”¨éç¨‹ä¸­è³‡æ–™çš„æ¨¡æ¨£æœƒå¦‚ä½•ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥å…ˆè©¦è¡Œè¼¸å‡ºå ±è¡¨ï¼Œç¢ºèªæ˜¯å¦ç¬¦åˆè²´å¸éœ€æ±‚ã€‚\r\nå¦‚æ¬²é–‹å§‹é€²è¡Œä½¿ç”¨ï¼Œå»ºè­°ä¾ç…§ä¸‹åˆ—é †åºé€²è¡Œï¼Œé™¤åŸºæœ¬è¨­å®šæœƒå¦å¤–åšé‡ç½®è¡Œç‚ºéœ€å„ªå…ˆè¨­å®šå¤–ï¼Œå…¶é¤˜è¨­å®šä¸ä¸€å®šè¦æŒ‰ç…§é †åºã€‚\r\nä»¥ä¸‹ç›¸é—œè¨­å®šæŒ‰éˆ•çš†éœ€é€éå·¥ä½œè¡¨\"ç‰ˆæœ¬èªªæ˜\"é»é¸æŒ‰éˆ•ã€åŠŸèƒ½ä¸»è¦ç•«é¢ã€‘å¾Œé€²è¡Œã€‚\r\n\r\n1.åŸºæœ¬è¨­å®š\r\n\r\nè¨­å®šåŸºæœ¬è³‡æ–™\r\n\r\næ­¥é©Ÿ\r\n\r\né»é¸æŒ‰éˆ•ã€1.åŸºæœ¬è¨­å®šã€‘\r\nè«‹ç¢ºèªæ˜¯å¦æ¸…é™¤æ—¢æœ‰è³‡æ–™ä¸¦å»ºç«‹æ–°çš„å·¥ç¨‹å°ˆæ¡ˆ?(æ˜¯/å¦)\r\n(æ˜¯)è‡ªå‹•åŸ·è¡Œå‚™ä»½ï¼Œå‚™ä»½è·¯å¾‘ç‚ºåŒç›®éŒ„ä¸‹çš„ã€backupã€‘è³‡æ–™å¤¾\r\nå‚™ä»½å®Œæˆå¾Œæœƒå°‡è³‡æ–™æ¸…ç©º\r\n\r\nåŸºæœ¬è¨­å®šã€å…¶ä»–è¨­å®š\r\næ•¸é‡è¡¨ã€ææ–™è¡¨ã€æ©Ÿå…·è¡¨ã€äººåŠ›è¡¨ã€å…¶ä»–è¡¨\r\n\r\nè«‹è¼¸å…¥å·¥ç¨‹åç¨±\r\nè«‹è¼¸å…¥æ‰¿æ”¬å» å•†\r\nè«‹è¼¸å…¥æ–½å·¥åœ°é»\r\nè«‹è¼¸å…¥å¥‘ç´„ç·¨è™Ÿ\r\nè«‹è¼¸å…¥ç‰Œç…§è™Ÿç¢¼\r\n\r\næˆæœ\r\nè³‡æ–™æœƒå„²å­˜æ–¼å·¥ä½œè¡¨\"åŸºæœ¬è¨­å®š\"ï¼Œæœ‰é—œå€‹åˆ¥æ¬„ä½ä»‹ç´¹è«‹åƒè€ƒä¸‹è¡¨\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nå…§å®¹\r\nç”¨é€”\r\n\r\n\r\n\r\n\r\nç”Ÿæ•ˆæ—¥\r\n(ç©ºç™½)\r\næ–°å¢æ—¥å ±å‰ç¢ºèªè¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œèˆ‡é–‹å·¥æ—¥æœŸåŒ\r\n\r\n\r\nå·¥ç¨‹åç¨±\r\nOOOOæ”¹å–„å·¥ç¨‹\r\n\r\n\r\n\r\næ‰¿æ”¬å» å•†\r\nOOç‡Ÿé€ æœ‰é™å…¬å¸\r\nåŒæ‰¿é€ äºº\r\n\r\n\r\næ–½å·¥åœ°é»\r\nOOç¸£OOå¸‚\r\n\r\n\r\n\r\nå¥‘ç´„ç·¨è™Ÿ\r\nA123456\r\n\r\n\r\n\r\né–‹å·¥æ—¥æœŸ\r\n(ç©ºç™½)\r\né€²åº¦è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºé¦–æ—¥æ—¥æœŸ\r\n\r\n\r\nç«£å·¥æ—¥æœŸ\r\n(ç©ºç™½)\r\né€²åº¦è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºæœ«æ—¥æ—¥æœŸ\r\n\r\n\r\nç‰Œç…§è™Ÿç¢¼\r\nåºœå»ºç®¡å­—ç¬¬OOOOOè™Ÿ\r\nå»º/é›œ/æ‹†ç…§è™Ÿç¢¼ä½¿ç”¨\r\n\r\n\r\nå¥‘ç´„é‡‘é¡\r\n(ç©ºç™½)\r\nå¥‘ç´„è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜\r\n\r\n\r\né€²åº¦é‡‘é¡\r\n(ç©ºç™½)\r\nå¥‘ç´„è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºé€²åº¦è¨ˆç®—æ™‚ä¹‹åˆ†æ¯\r\n\r\n\r\n\r\n2.å¥‘ç´„è¨­å®š\r\n\r\nè¨­å®šå¥‘ç´„é …ç›®ï¼Œé€™ä¸€æ­¥æœƒæ¯”è¼ƒé‡è¦ä¸”ç¹ç‘£ï¼Œæœ‰éœ€è¦å¯ä¾†ä¿¡è¨è«–æˆ–ä»£å·¥\r\n\r\nè¨­å®šåŸå‰‡\r\n\r\né …æ¬¡ä¸èƒ½é‡è¤‡\r\nè¤‡åƒ¹ç¸½å’Œç‚ºå¥‘ç´„é‡‘é¡\r\nåˆ†é¡ç‚ºPä¸ç´å…¥é€²åº¦è¨ˆç®—åˆ†æ¯\r\nåˆ†é¡ç‚ºNç‚ºç™¼åŒ…å·¥ä½œè²»å¤–é …ç›®\r\n\r\næ­¥é©Ÿ\r\nPCCESçš„XLS\r\n\r\né»é¸æŒ‰éˆ•ã€2.å¥‘ç´„è¨­å®šã€‘\r\né»é¸æŒ‰éˆ•ã€å¼•å…¥PCCESã€‘\r\né¸æ“‡PCCESç”¢å‡ºä¹‹XLSæª”æ¡ˆ\r\nå¦‚æœ‰èˆŠè³‡æ–™å­˜åœ¨ï¼Œå‰‡è·³æé†’\"ä½ æœ‰èˆŠè³‡æ–™å­˜åœ¨ï¼Œç¢ºå®šè¦åˆªé™¤?\"\r\n(æ˜¯)æ¸…ç©ºè³‡æ–™åŠåˆ†é¡ï¼Œä¸¦å°‡XLSå…§å®¹å°å…¥\r\næŒ‘é¸ç™¼åŒ…å·¥ä½œè²»å¤–çš„é …ç›®\r\næŒ‘é¸ä¸è¨ˆå…¥é€²åº¦è¨ˆç®—çš„é …ç›®\r\né—œé–‰å¾Œæœƒè‡ªå‹•å°‡\"å¥‘ç´„é‡‘é¡\"ã€\"é€²åº¦é‡‘é¡\"ä»£å…¥åˆ°\"åŸºæœ¬è¨­å®š\"\r\n\r\nå‚™è¨»\r\né¸æ“‡PCCESç”¢å‡ºä¹‹XLSä¹‹å‰ï¼Œå¯ä»¥å…ˆå°‡æ±ºæ¨™å–®åƒ¹ä¿®æ”¹åˆ°XLSçš„é ç®—å–®åƒ¹ï¼Œæœªä¾†æ‰ä¸ç”¨é€å€‹ä¿®æ­£ã€‚\r\nPCCESçš„XML\r\nåŸºæœ¬ä¸Šèƒ½å–å¾—XMLä¹Ÿå°±èƒ½å°‡å®ƒåŒ¯å…¥åˆ°PCCESå¾Œè¼¸å‡ºXLSäº†ï¼Œé™¤éçœŸçš„æ²’æœ‰è¾¦æ³•ï¼Œæ‰æœƒæ¡è¡Œä¸‹åˆ—å¾Œè™•ç†å·¥å…·é€²è¡Œã€‚\r\nå¦è©³ Excel\r\nVBA @ PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†\r\nå…¶ä»–XLS\r\nå¯ä»¥è¤‡è£½è²¼ä¸Šåˆ°å·¥ä½œè¡¨\"å¥‘ç´„è¨­å®š\"æˆ–å…¶ä»–ä»»ä½•æ–¹å¼\r\næˆæœ\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nå…§å®¹\r\nç”¨é€”\r\n\r\n\r\n\r\n\r\né …æ¬¡\r\nå£¹.ä¸€.1\r\né …æ¬¡ä¸èƒ½é‡è¤‡\r\n\r\n\r\né …ç›®\r\næ–½å·¥å‘Šç¤ºç‰Œ\r\n\r\n\r\n\r\nå–®ä½\r\nç‰‡\r\n\r\n\r\n\r\næ•¸é‡\r\n2\r\n\r\n\r\n\r\nå–®åƒ¹\r\n2500\r\n\r\n\r\n\r\nè¤‡åƒ¹\r\n5000\r\n\r\n\r\n\r\nåˆ†é¡\r\n(ç©ºç™½)\r\nPä¸ç´å…¥é€²åº¦ã€Nç‚ºç™¼åŒ…å·¥ä½œè²»å¤–\r\n\r\n\r\n\r\n\r\nä¸»é …å¤§é¡å¦‚æ²’æœ‰ç´°é …ï¼Œå»ºè­°å°‡å–®åƒ¹ã€è¤‡åƒ¹çš†æ­¸0ï¼Œé¿å…å½±éŸ¿å¥‘ç´„é‡‘é¡ç¸½å’Œã€‚\r\n\r\n3.å·¥æ–™è¨­å®š\r\n\r\nè¨­å®šå¥‘ç´„é …ç›®\r\n\r\næ­¥é©Ÿ\r\næ–°å¢\r\n\r\né»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘\r\né¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)\r\nè¼¸å…¥é …ç›®ã€å–®ä½ã€æ•¸é‡ã€å–®åƒ¹\r\né»é¸æŒ‰éˆ•\"æ–°å¢\"\r\n\r\nåˆªé™¤\r\n\r\né»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘\r\né¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)\r\né»é¸è¦åˆªé™¤çš„é …ç›®åç™½å¾Œ\r\né»é¸æŒ‰éˆ•\"åˆªé™¤\"\r\n\r\nç·¨è¼¯\r\n\r\né»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘\r\né¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)\r\næŒ‘é¸è¦ç·¨è¼¯çš„é …ç›®å¾Œå¿«é»å…©ä¸‹\r\nè¼¸å…¥æ­£ç¢ºæ•¸é‡\r\nè¼¸å…¥æ­£ç¢ºå–®åƒ¹\r\n\r\næˆæœ\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nå…§å®¹\r\nç”¨é€”\r\n\r\n\r\n\r\n\r\né …æ¬¡\r\nE0001\r\n\r\n\r\n\r\né …ç›®\r\næŒ–åœŸæ©Ÿ\r\né …ç›®åç¨±ä¸èƒ½é‡è¤‡\r\n\r\n\r\nå–®ä½\r\nå¤©\r\n\r\n\r\n\r\næ•¸é‡\r\n200\r\n\r\n\r\n\r\nå–®åƒ¹\r\n1000\r\n\r\n\r\n\r\n\r\n\r\nEé–‹é ­ç‚ºæ©Ÿå…·\r\nLé–‹é ­ç‚ºäººåŠ›\r\nMé–‹é ­ç‚ºææ–™\r\n\r\n4.é€²åº¦è¨­å®š\r\n\r\nè¨­å®šé€²åº¦é …ç›®ï¼ŒåŒ…å«é–‹å·¥æ—¥æœŸã€ç«£å·¥æ—¥æœŸã€é å®šé€²åº¦\r\n\r\næ­£ç¢ºè¨­å®šé€²åº¦æµç¨‹æ˜¯æ¡ç”¨æ‹†é …ç›®ã€é‡‘é¡çš„æ–¹å¼å®‰æ’èµ·è¨–æ—¥é€²è¡Œï¼Œé€™æ¨£æœƒæ¯”è¼ƒç¬¦åˆå¯¦éš›æ‰€éœ€ï¼Œå¦‚è¦æ¡ç”¨è¼ƒç°¡ä¾¿çš„æ–¹å¼ï¼Œå¯ä»¥å°‡æ–½å·¥è¨ˆç•«æ›¸ä¸­çš„é å®šé€²åº¦è¡¨å–æ¯åŠæœˆæˆ–æ¯æœˆä¹‹é å®šç´¯ç©é€²åº¦åšå…§æ’æ›ç®—ã€‚\r\næ­¥é©Ÿ\r\nè‡ªè¡Œè¼¸å…¥\r\n\r\né»é¸æŒ‰éˆ•ã€4.é€²åº¦è¨­å®šã€‘\r\né¸å–è¦ä½¿ç”¨å“ªå€‹æ–¹æ³•å¼•å…¥(1.è‡ªè¡Œè¼¸å…¥,2.å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·)\r\n(é¸æ“‡1)\r\nè¼¸å…¥æ—¥æœŸã€è©²æ—¥é å®šç´¯ç©é€²åº¦å¾ŒåŠ å…¥\r\né»é¸æŒ‰éˆ•ã€é€²åº¦è¨ˆç®—ã€‘\r\n\r\nå¼•å…¥ç”˜ç‰¹åœ–å·¥å…·\r\n\r\nè©³ç´°æ“ä½œæ­¥é©Ÿblog Streamlitå·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–\r\nå·¥å…·ç¶²é  å·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–å·¥å…·\r\n\r\n\r\næ ¹æ“šä¸Šè¿°å…§å®¹è£½ä½œå®Œæˆå¾Œç•™å­˜XLSå‚™ç”¨\r\né»é¸æŒ‰éˆ•ã€4.é€²åº¦è¨­å®šã€‘\r\né¸å–è¦ä½¿ç”¨å“ªå€‹æ–¹æ³•å¼•å…¥(1.è‡ªè¡Œè¼¸å…¥,2.å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·)\r\n(é¸æ“‡2)\r\né¸å–æ­¥é©Ÿ1ä¹‹XLS\r\n\r\næˆæœ\r\n\r\n\r\n\r\næ¬„ä½åç¨±\r\nå…§å®¹\r\nç”¨é€”\r\n\r\n\r\n\r\n\r\næ—¥æœŸ\r\n2024/9/25\r\n\r\n\r\n\r\né å®šé€²åº¦\r\n0.00%\r\n\r\n\r\n\r\nå¯¦éš›é€²åº¦\r\n(ç©ºç™½)\r\nå¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜\r\n\r\n\r\nä¸Šåˆå¤©æ°£\r\n(ç©ºç™½)\r\nå¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜\r\n\r\n\r\nä¸‹åˆå¤©æ°£\r\n(ç©ºç™½)\r\nå¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜\r\n\r\n\r\n\r\nç›¸é—œé€£çµ\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","æ–½å·¥æ—¥èªŒ"]},{"title":"æ–½å·¥æ—¥èªŒVBA-V3.5.0æ­£å¼ç™¼ä½ˆ","url":"/posts/1000661249/","content":"å‰è¨€\r\nè‡ª2018å¹´ç™¼å¸ƒç›£é€ æ—¥å ±è¡¨VBAåŠ2022å¹´ç™¼å¸ƒå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒè³‡æ–™åº«VBAå¾Œï¼Œé™¸çºŒæœ‰æ”¶åˆ°å¾ˆå¤šæœ‹å‹çš„å›é¥‹ï¼Œç¶“éä¸€æ¬¡åˆä¸€æ¬¡çš„è¿­ä»£ä¿®æ”¹ï¼Œè©²é‡åˆ°çš„å•é¡Œå·®ä¸å¤šä¹Ÿå·²ç¶“è§£æ±ºäº†ï¼Œå°æ–¼æª”æ¡ˆä¸­é•·æœŸç´¯ç©çš„ç¨‹å¼ç¢¼æˆ–è¨±å› ç‚ºåœ¨ä¸‹çš„åŠŸåŠ›ä¸å¤ æ·±åšï¼Œéºç•™ä¸‹å¤§é‡çš„æŠ€è¡“å‚µï¼Œæ¯æ¬¡çš„ç¨‹å¼ç¢¼ç·¨è¼¯æœƒè€—è²»ä¸å°‘æ™‚é–“ï¼Œè€Œä¸”ä¹Ÿéœ€è¦åšå¤§é‡çš„æ¸¬è©¦ï¼Œç‚ºäº†ä¸è¦å‚µç•™å­å­«ï¼Œç‰¹åœ°èŠ±äº†ä¸€äº›æ™‚é–“é€šç›¤æª¢è¨é€²è¡Œä¸€æ¬¡å®Œæ•´çš„é‡æ§‹ï¼Œä¹Ÿå°±æ˜¯æœ¬ç¯‡æ–‡ç« çš„ä¸»è§’-æ–½å·¥æ—¥èªŒVBA-V3.5.0.ã€‚\r\n\r\n\r\nFig1.é¸å–®å…§å®¹\r\n\r\n\r\nå½±ç‰‡æ“ä½œ\r\n\r\n\r\né¦–é \r\n\r\n\r\nFig2.ä¸»è¦é€²å…¥é»\r\n\r\nåŠŸèƒ½\r\nä¸»è¦æ¶æ§‹å¯åˆ†ç‚ºè¨­å®šã€ç´€éŒ„è¡¨ã€æ ¼å¼åŠè³‡æ–™å‚™ä»½ï¼Œæ¦‚è¿°å¦‚ä¸‹\r\nè¨­å®šç›¸é—œ\r\n\r\nåŸºæœ¬è¨­å®š\r\n\r\nç¶œç†å„æ©Ÿé—œç¯„æœ¬æ‰€éœ€ä¹‹åŸºæœ¬è³‡æ–™ï¼Œæ‰€éœ€å¤§è‡´ç‚º\r\n\r\nå·¥ç¨‹åç¨±\r\næ‰¿æ”¬å» å•†(æ‰¿é€ äºº)\r\næ–½å·¥åœ°é»\r\nå¥‘ç´„ç·¨è™Ÿ\r\nå¥‘ç´„é‡‘é¡\r\né–‹å·¥æ—¥æœŸ\r\nç«£å·¥æ—¥æœŸ\r\nå»º/é›œ/æ‹†ç…§è™Ÿç¢¼\r\n\r\n\r\nå¥‘ç´„è¨­å®š\r\n\r\nå¥‘ç´„é …æ¬¡ä¸èƒ½é‡è¤‡ï¼Œå¯å¼•å…¥PCCESæˆ–å¾Œè™•ç†å·¥å…·\r\n\r\n\r\nFig3.å¥‘ç´„è¨­å®šç•«é¢\r\n\r\n\r\nå·¥æ–™è¨­å®š\r\n\r\näººæ©Ÿæ–™åç¨±ä¸èƒ½é‡è¤‡\r\n\r\n\r\nFig4.å·¥æ–™è¨­å®šç•«é¢\r\n\r\n\r\né€²åº¦è¨­å®š\r\n\r\nå¯ä»¥é€éæ—¥æœŸèˆ‡é å®šç´¯ç©é€²åº¦æ›ç®—æˆ–åŒ¯å…¥ç”˜ç‰¹åœ–å·¥å…·ä¹‹æˆæœ\r\n\r\n\r\nFig5.é€²åº¦è¨­å®šç•«é¢\r\n\r\nç´€éŒ„è¡¨ç›¸é—œ\r\n\r\næ–°å¢æ—¥å ±\r\nç·¨è¼¯æ—¥å ±\r\nåˆªé™¤æ—¥å ±\r\nåˆ—å°æ—¥å ±\r\n\r\nç´€éŒ„å…§å®¹åŒ…å«å¥‘ç´„é …ç›®ã€å¤©æ°£ç‹€æ³ã€äººæ©Ÿæ–™ã€å‚™è¨»åŠç›£é€ éƒ¨åˆ†\r\n\r\n\r\nFig6.å¥‘ç´„é …ç›®ç·¨è¼¯ç•«é¢\r\n\r\n\r\n\r\nFig7.æ–½å·¥æ—¥èªŒå‚™è¨»ç·¨è¼¯ç•«é¢\r\n\r\n\r\n\r\nFig8.ç›£é€ å ±è¡¨å‚™è¨»ç·¨è¼¯ç•«é¢\r\n\r\næ ¼å¼ç›¸é—œ\r\n\r\n\r\nFig9.åˆ—å°æ—¥å ±ç•«é¢\r\n\r\n\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nç›£é€ å ±è¡¨\r\n\r\n\r\n\r\nFig10.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ\r\n\r\n\r\n\r\nFig11.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)æˆæœ\r\n\r\n\r\n\r\nFig12. å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ\r\n\r\n\r\n\r\nFig13. ç›£é€ å ±è¡¨æˆæœ\r\n\r\nå‚™ä»½é‚„åŸ\r\nå•Ÿå‹•æ™‚é»\r\n\r\næ¸…ç©ºè³‡æ–™åº«\r\nç‰ˆæœ¬æ›´æ–°\r\n\r\nå°‡è¨­å®šèˆ‡ç´€éŒ„è¡¨åŒ¯å‡ºæˆæ–°çš„æ´»é ç°¿ï¼Œå¦‚ç‰ˆæœ¬æ›´æ–°æ™‚ï¼Œå¯å°‡è©²æ´»é ç°¿é‚„åŸé€²å»ã€‚\r\nçµèª\r\né–‹ç™¼ç›®æ¨™ç›¡é‡ä»¥é€šç”¨ç‚ºä¸»ï¼Œä½†é›£å…æœ‰æ©Ÿé—œæœƒæœ‰è‡ªå·±çš„æ ¼å¼ï¼Œä½†é€™éƒ½æ˜¯å¯ä»¥è™•ç†çš„ï¼Œç•¶åˆåœ¨é–‹ç™¼æ™‚å·²ç¶“å°‡æ“´å……çš„æ¬„ä½ç”šè‡³æ˜¯å ±è¡¨çš„ç”Ÿæˆçš†å·²é€²è¡Œè€ƒé‡ï¼Œæœ‰ç‰¹æ®Šéœ€æ±‚çš„äººå¯ä»¥é€éå·¦å´è³‡è¨Šæ¬„è¯ç¹«æˆ‘(LINEæˆ–Email)ï¼ŒèˆŠç‰ˆæœ¬çš„æ–½å·¥æ—¥èªŒVBAé è¨ˆåªç¶­è­·åˆ°ä»Šå¹´å¹´åº•ï¼Œæ˜å¹´1/1èµ·å°‡ä¸å†æä¾›ç¶­è­·ï¼Œçš†æœƒæ¡ç”¨æ–°ç‰ˆé€²è¡Œï¼Œå¦‚æœ‰è³¼ç½®ä½¿ç”¨çš„æœ‹å‹å¯å”åŠ©è½‰æ›è‡³æ–°ç‰ˆã€‚\r\n\r\næ–½å·¥æ—¥èªŒVBAç›¸é—œç‰ˆæœ¬å…§å®¹è«‹åƒè€ƒç‰ˆæœ¬èªªæ˜\r\n\r\nâ­\r\næœ‰éœ€è¦è«‹LINE(ID:@903qzhwa)è¯ç¹«æˆ–é›»å­éƒµä»¶(apple84026113@gmail.com)è¯ç¹«\r\nç›¸é—œé€£çµ\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-V3.6.0ç³»åˆ—æ›´æ–°èªªæ˜\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Excel VBA","æ–½å·¥æ—¥èªŒ","ç›£é€ å ±è¡¨"]},{"title":"æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡","url":"/posts/997099184/","content":"å‰è¨€\r\næœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ æ–½å·¥æ—¥èªŒVBA-V3.5.0\r\nç‰ˆæœ¬æ“ä½œæ•™å­¸\r\nç‰ˆé¢æ ¼å¼æœ‰å¯èƒ½å› ç‚ºæ¥­ä¸»çš„è¦æ±‚æˆ–å§”å“¡çš„è¦æ±‚è€Œæœ‰äº›è¨±ä¸åŒï¼Œé›£ä»¥åƒç¯‡ä¸€å¾‹çš„å…§å®¹æ‡‰ä»˜æ‰€æœ‰çš„æ©Ÿé—œï¼Œç•¶åˆåœ¨è¨­è¨ˆè»Ÿé«”æ™‚å°±æœ‰è€ƒé‡åˆ°é€™å€‹éƒ¨åˆ†ï¼Œæ•…è®“å ±è¡¨ç”Ÿæˆçš„éç¨‹ç›¡å¯èƒ½çš„å½ˆæ€§ï¼Œèƒ½å¤ åœ¨é€™å€‹èªªAæ”¹Bçš„ç’°å¢ƒä¸‹å¥½å¥½é©æ‡‰å„ç¨®ç‹€æ³ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç´¹æ–½å·¥æ—¥èªŒVBAå¯ä¾›è¼¸å‡ºçš„å ±è¡¨æ ¼å¼åŠå¾®èª¿ç‰ˆå‹çš„æ–¹æ³•ï¼Œç›¡å¯èƒ½ä»¥å…¬ç‰ˆä½œç‚ºé è¨­ï¼ŒçœŸçš„éœ€è¦å†ä¾†èª¿æ•´ã€‚\r\nä»¥ä¸‹ç›¸é—œè¨­å®šæŒ‰éˆ•çš†éœ€é€éå·¥ä½œè¡¨\"ç‰ˆæœ¬èªªæ˜\"é»é¸æŒ‰éˆ•ã€åŠŸèƒ½ä¸»è¦ç•«é¢ã€‘å¾Œé€²è¡Œã€‚\r\n\r\nå ±è¡¨æ ¼å¼\r\n\r\n\r\nFig1. åˆ—å°æ—¥å ±ä»‹é¢\r\n\r\nå¥‘ç´„é …ç›®åˆ†é¡\r\n\r\nç´¯ç©æ•¸é‡ä¸ç‚º0(æ›¾ç¶“æ–½ä½œçš„å·¥é …)\r\næœ¬æ—¥æ•¸é‡ä¸ç‚º0(ä»Šå¤©æ–½ä½œçš„å·¥é …)\r\nå…¨éƒ¨å¥‘ç´„é …ç›®\r\n\r\nç‰ˆå‹åˆ†é¡\r\n\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯)\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯)\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nç›£é€ å ±è¡¨(ç¬¬ä¸€è¯)\r\n\r\n\r\nå¦‚æœå¥‘ç´„é …ç›®åˆ†é¡æ¡ç”¨æœ¬æ—¥æ•¸é‡ä¸ç‚º0é™¤æ¯æ—¥å›ºå®šè¦è¼¸å‡ºçš„ç¬¬ä¸€è¯å¤–ï¼Œæœƒåœ¨æ¯æœˆæˆ–æ¯å‘¨å†å¦å¤–è£½ä½œç¬¬äºŒè¯ï¼Œé »ç‡è¦–æ©Ÿé—œè¦å®šè€Œå®šã€‚\r\n\r\nå¾®èª¿ç‰ˆå‹\r\næ¯å€‹æª”æ¡ˆéƒ½æœƒæœ‰å›ºå®šçš„ç‰ˆå‹ï¼Œå…¶ç¯„æœ¬ä½æ–¼å·¥ä½œè¡¨åç¨±:\r\n\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ\r\nå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)\r\nç›£é€ æ—¥å ±\r\n\r\n\r\n\r\nFig2. ç‰ˆå‹å·¥ä½œè¡¨\r\n\r\nä¸»è¦é—œéµå­—\r\nç¯„æœ¬ä¸­ç”±&lt;&lt;&gt;&gt;åŒ…ä½çš„å„²å­˜æ ¼æ–‡å­—ä¸èƒ½æ”¹è®Šï¼Œèˆ‰ä¾‹:&lt;&gt;\r\næ–‡å­—å¤§å°å¾®èª¿\r\nå¦‚æœåˆ—å°æ™‚ç™¼ç¾æ–‡å­—å¤ªå¤§æˆ–å¤§å°ï¼Œéƒ½å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼Œä¸è¦å½±éŸ¿åˆ°åŸæœ¬çš„æ–‡å­—å…§å®¹å³å¯ã€‚\r\né¡å¤–åŠ è¨»æ–‡å­—\r\nå¯ä»¥åœ¨ä¸å½±éŸ¿åŸæœ¬çš„å„²å­˜æ ¼æ–‡å­—å…§å®¹ä¸‹ï¼Œé¡å¤–åŠ å…¥è¨»è¨˜äº‹é …åˆ°ç‰ˆé¢ä¸­ï¼ŒæƒŸé ˆæ³¨æ„ä¸èƒ½è½åœ¨åŸæœ¬è¦ç”Ÿæˆæ¸…å–®çš„è·¯ç·šä¸Šã€‚\r\nèˆ‰ä¾‹:å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒçš„ç¬¬äºŒé …ã€å·¥åœ°ææ–™ç®¡ç†æ¦‚æ³(åˆ—è™Ÿ108~128)é›–ç„¶éƒ½æ˜¯ç©ºç™½çš„ï¼Œä½†å®ƒå±¬æ–¼ææ–™çš„æ¸…å–®æ˜ç´°è·¯ç·šï¼Œä¸èƒ½å†æ’å…¥å…¶ä»–é—œéµå­—ä½¿ç”¨ã€‚\r\n\r\n\r\nFig3. ä¸èƒ½é¡å¤–åŠ è¨»ä¹‹æ¸…å–®æ˜ç´°\r\n\r\nåˆ—å°æˆæœ\r\næ¸¬è©¦ç‰ˆ\r\n\r\né è¨­åˆ—å°æˆpdf(æœ‰åŠ å…¥æµ®æ°´å°ï¼Œåƒ…ä¾›æ¸¬è©¦åŠŸèƒ½ä½¿ç”¨)\r\n\r\n\r\n\r\nFig4. æ¸¬è©¦ç‰ˆæˆå“\r\n\r\n\r\næ­£å¼ç‰ˆ\r\n\r\né è¨­åˆ—å°æˆxls(å¯ä»¥ç›´æ¥æ‰¹æ¬¡è¼¸å‡ºï¼Œåˆ—å°æ™‚å¯ä»¥é¸æ“‡åˆ—å°æ•´æœ¬æ´»é ç°¿)\r\n\r\n\r\n\r\nFig5. æ­£å¼ç‰ˆæˆå“\r\n\r\nç›¸é—œé€£çµ\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡\r\nğŸ”—\r\næ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","æ–½å·¥æ—¥èªŒ"]},{"title":"æ‰¹æ¬¡è½‰æ›docåˆ°pdf","url":"/posts/1066861632/","content":"ğŸ™Œå‰è¨€\r\n\r\näº¤é€šéƒ¨çš„éƒ¨é ’è¦ç¯„ä¸‹è¼‰ä¸‹ä¾†ä¹‹å¾Œæœƒè®Šæˆå¾ˆå¤šç´°ç¢çš„æª”æ¡ˆï¼ŒåŒ…å«PDFè·ŸDOCï¼Œåœ¨é€²è¡Œæª”æ¡ˆå…§å®¹æœå°‹çš„æ™‚å€™æ™‚å¸¸éœ€è¦è·¨æª”æ¡ˆæ¯”å°ï¼Œç„¡æ³•åœ¨åŒå€‹æª”æ¡ˆä¸­ä¸€æ¬¡åˆ°ä½ã€‚\r\næœ‰äº›è¦ç¯„æœ‰é€²è¡Œä¿®æ”¹çš„å…§å®¹éœ€è¦å…ˆä¿®æ”¹docå¾Œå†è¼¸å‡ºPDFï¼Œä¹¾è„†å°‡æ‰€æœ‰PDFéƒ½å…ˆé€²è¡Œåˆªé™¤ï¼Œå¾ŒçºŒå†é‡å°è³‡æ–™å¤¾æ‰¹æ¬¡è½‰æª”æˆPDFå¾Œå†åšåˆä½µã€‚\r\n\r\nè§£æ±ºç›®æ¨™:å°‡docä¿®æ”¹å®Œç•¢å¾Œè¼¸å‡ºç‚ºpdfï¼Œä¸Ÿåˆ°pdf_mergeä¸­é€²è¡Œåˆä½µï¼Œé€™å¯¦åœ¨æ˜¯å¾ˆéº»ç…©ã€‚\r\n\r\næœ¬ç¯‡ä»‹ç´¹å¦‚ä½•æ’°å¯«ç¨‹å¼ç¢¼ä¾†ç°¡åŒ–è£½ä½œå…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„çš„æµç¨‹ï¼Œæœ‰èˆˆè¶£è«‹ç¹¼çºŒé–±è®€\r\n\r\n\r\næª”æ¡ˆä¾†æº\r\n\r\nåŸå§‹æª”æ¡ˆä¸‹è¼‰é€£çµ \r\nåŸå§‹æª”æ¡ˆä¸‹è¼‰å…§å®¹ \r\né å…ˆè™•ç†å…§å®¹ \r\n\r\n\r\nğŸ‘‰Pythonçš„è§£æ±ºæ–¹æ¡ˆ\r\né è¨ˆä½¿ç”¨å·¥å…·ç‚ºdocx2pdfé€²è¡Œè½‰æª”\r\ndocx2pdf\r\nä½¿ç”¨æ™‚æ‰€è¼¸å‡ºçš„å…§å®¹ä¸€ç›´å‡ºç¾ç©ºç™½é ï¼Œè€Œä¸”å¯ä»¥æ¥å—çš„å…§å®¹ä¹Ÿåªæœ‰docx\r\nå¯èƒ½æ˜¯æˆ‘é‚„æ²’ç ”ç©¶é€å¾¹...?\r\nfrom docx2pdf import convertimport osdef convert_docx_to_pdf(input_folder, output_folder):    # ç¢ºä¿è¼¸å…¥æ–‡ä»¶å¤¾å­˜åœ¨    if not os.path.exists(input_folder):        print(&quot;è¼¸å…¥æ–‡ä»¶å¤¾ä¸å­˜åœ¨ï¼&quot;)        return    # ç¢ºä¿è¼¸å‡ºæ–‡ä»¶å¤¾å­˜åœ¨    os.makedirs(output_folder, exist_ok=True)    # éæ­·è¼¸å…¥æ–‡ä»¶å¤¾ä¸­çš„æ‰€æœ‰æ–‡ä»¶    for filename in os.listdir(input_folder):        if filename.endswith(&quot;.docx&quot;) :#or filename.endswith(&quot;.doc&quot;):            print(f&quot;&#123;filename&#125; found&quot;)            input_path = os.path.join(input_folder, filename)            output_filename = filename.replace(&quot;.docx&quot;, &quot;.pdf&quot;)            output_path = os.path.join(output_folder, output_filename)            # å°‡ Word æ–‡ä»¶è½‰æ›ç‚º PDF                        convert(input_path, output_path)            print(f&quot;&#123;filename&#125; è½‰æ›å®Œæˆ&quot;)if __name__ == &quot;__main__&quot;:    input_folder = r&quot;D:\\GoogleDrive-åƒè€ƒæ‰‹å†Š\\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot;  # è¼¸å…¥æ–‡ä»¶å¤¾çš„è·¯å¾‘    output_folder = r&quot;D:\\Python\\pdf_output&quot;  # è¼¸å‡ºæ–‡ä»¶å¤¾çš„è·¯å¾‘    convert_docx_to_pdf(input_folder, output_folder)\r\nå¾Œä¾†é‚„æ˜¯æƒ³åˆ¥çš„è¾¦æ³•å»è½‰æª”ã€‚\r\n\r\nğŸ‘æœ€çµ‚é¸æ“‡\r\nèº«ç‚ºå¿ è‡£çš„VBAç”¨æˆ¶ï¼Œå¦‚æœèƒ½å¤ ç”¨VBAè™•ç†æœƒæ˜¯æ¯”è¼ƒå¾—å¿ƒæ‡‰æ‰‹çš„ï¼Œçªç„¶æƒ³èµ·\r\nExcel VBA æœ¬èº«å¯ä»¥å‘¼å« Word VBA åŸ·è¡ŒPDFè½‰æª”ã€‚\r\n&#x27;ä»¥ä¸‹å…§å®¹ä¾†è‡ªèˆ‡ChatGPTä¹‹é–“çš„å°è©±+æˆ‘è‡ªå·±ç¨å¾®ä¿®æ”¹Sub ConvertDocToPDF()    Dim WordApp As Object    Dim WordDoc As Object    Dim FolderPath As String    Dim FileName As String    Dim PDFFileName As String        &#x27; ?ç½® Word ?ç”¨?è±¡    On Error Resume Next    Set WordApp = GetObject(, &quot;Word.Application&quot;)    If WordApp Is Nothing Then        Set WordApp = CreateObject(&quot;Word.Application&quot;)    End If    On Error GoTo 0        &#x27; ?ç½® Word ?ç”¨?ä¸å¯?    WordApp.Visible = False        &#x27; ?ç½®æ–‡ä»¶?è·¯?    FolderPath = &quot;D:\\GoogleDrive-åƒè€ƒæ‰‹å†Š\\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot; &#x27; æ›´æ”¹?ä½ çš„æ–‡ä»¶?è·¯?        &#x27; é?æ–‡ä»¶?ä¸­çš„æ‰€æœ‰ Word æ–‡ä»¶    FileName = Dir(FolderPath &amp; &quot;\\*.doc*&quot;)    Do While FileName &lt;&gt; &quot;&quot;        &#x27; æ‰“? Word æ–‡?        Set WordDoc = WordApp.Documents.Open(FolderPath &amp; &quot;\\&quot; &amp; FileName)                &#x27; æ„å»º PDF æ–‡ä»¶å        PDFFileName = Replace(FolderPath &amp; &quot;\\&quot; &amp; FileName, &quot;.doc&quot;, &quot;.pdf&quot;)                &#x27; ä¿å­˜? PDF        WordDoc.ExportAsFixedFormat OutputFileName:=PDFFileName, ExportFormat:=17 &#x27; 17 è¡¨ç¤º PDF æ ¼å¼                &#x27; ?? Word æ–‡?        WordDoc.Close False                &#x27; ??ä¸‹ä¸€?æ–‡ä»¶        FileName = Dir    Loop        &#x27; ?? Word ?ç”¨    WordApp.Quit        &#x27; ?æ”¾?è±¡    Set WordDoc = Nothing    Set WordApp = Nothing        MsgBox &quot;åˆ—å°å®Œæˆï¼&quot;End Sub\r\n\r\næš«æ™‚çµæœ\r\nç¶“éè½‰æª”ä¹‹å¾Œï¼ŒåŸæœ¬æ˜¯docæˆ–docxçš„æª”æ¡ˆéƒ½æœƒä¾ç…§åŸæœ¬åç¨±è®Šæˆpdfçš„å‰¯æª”å\r\nä¸‹ä¸€æ­¥å°±æ˜¯è¦é€²è¡Œpdfåˆä½µäº†!!\r\n\r\n\r\nFig4.æš«æ™‚ç”Ÿæˆçµæœ\r\n\r\n\r\nåˆ—å°é †åº\r\nå› ç‚ºPDFæ–‡ä»¶çš„åç¨±ä¸ä¸€å®šæ˜¯æˆ‘æ‰€éœ€è¦çš„é †åº\r\nå¸Œæœ›èƒ½å¤ ä¾å¾ªä¸‹åˆ—æ­¥é©Ÿ\r\n\r\nåˆ—å‡ºè©²æª”æ¡ˆå¤¾ä¸­çš„æª”æ¡ˆåç¨±é †åºæˆç‚ºCSVæª”æ¡ˆ\r\næ ¹æ“šæˆ‘æ‰€æŒ‡å®šçš„é †åºé€²è¡Œé¸å–åˆä½µ\r\n\r\n\r\nç”ŸæˆCSVé †åº\r\nimport osimport csvdef list_pdf_files_to_csv(input_folder, output_csv):    # æ‰“å¼€ CSV æ–‡ä»¶ä»¥å†™å…¥æ¨¡å¼    with open(output_csv, &quot;w&quot;, newline=&#x27;&#x27;, encoding=&#x27;utf-8-sig&#x27;) as csv_file:        # åˆ›å»º CSV writer å¯¹è±¡        csv_writer = csv.writer(csv_file)        csv_writer.writerow([&#x27;é †åº&#x27;,&#x27;æª”æ¡ˆåç¨±&#x27;,&#x27;æª”æ¡ˆè·¯å¾‘&#x27;])        order=1        # éå†è¾“å…¥æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶        for filename in os.listdir(input_folder):            # æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä»¥ &quot;.pdf&quot; ç»“å°¾            if filename.lower().endswith(&quot;.pdf&quot;):                # å°†æ–‡ä»¶ä¿¡æ¯å†™å…¥ CSV æ–‡ä»¶                file_path = os.path.join(input_folder, filename)                csv_writer.writerow([order,filename, file_path])                # æ›´æ–°é¡ºåºå·                order += 1if __name__ == &quot;__main__&quot;:    input_folder =r&quot;D:\\GoogleDrive-åƒè€ƒæ‰‹å†Š\\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot;  # è¾“å…¥æ–‡ä»¶å¤¹çš„è·¯å¾„    output_csv = r&quot;D:\\Python\\pdf_doc\\pdf_files.csv&quot;  # è¾“å‡º CSV æ–‡ä»¶çš„è·¯å¾„    list_pdf_files_to_csv(input_folder, output_csv)\r\nç”Ÿæˆä¹‹å¾Œå¯ä»¥è—‰ç”±Excelçš„å¹«åŠ©é€²è¡Œé †åºæ’åºï¼Œå†å¦å­˜ç‚ºcsvæª”æ¡ˆçš„æ ¼å¼å°±å¯ä»¥å‚™ç”¨ã€‚\r\næ ¹æ“šCSVé †åºé€²è¡Œåˆä½µ\r\nimport osimport csvfrom PyPDF2 import PdfMergerdef read_csv_to_pdf_files(csv_file):    pdf_files = []    # æ‰“å¼€ CSV æ–‡ä»¶å¹¶è¯»å–å†…å®¹    #with open(csv_file, &quot;r&quot;, newline=&#x27;&#x27;,errors=&#x27;replace&#x27;) as file:#æœ‰å‡ºç¾å•é¡Œçš„è©±ç”¨é€™è¡Œ    with open(csv_file, &quot;r&quot;, newline=&#x27;&#x27;,encoding=&#x27;utf-8-sig&#x27;) as file:#å…¨æ–°è™›æ“¬ç’°å¢ƒç”¨é€™è¡Œ        reader = csv.reader(file)        next(reader)  # è·³è¿‡æ ‡é¢˜è¡Œ        for row in reader:            order = row[0]#ç¬¬ä¸€åˆ—æ˜¯é¡ºåº            filename = row[1]  # ç¬¬äºŒåˆ—æ˜¯æ–‡ä»¶å            pdf_path = row[2]  # ç¬¬ä¸‰åˆ—æ˜¯ PDF æ–‡ä»¶çš„ç»å¯¹è·¯å¾„            pdf_files.append((order, filename, pdf_path))    return pdf_filesdef merge_pdfs_directly(pdf_files,output_folder):    # åˆ›å»ºä¸€ä¸ª PdfMerger å¯¹è±¡    merger = PdfMerger()    # éå†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  é€™å€‹ä¸èƒ½äº‚æ”¹æœƒå ±éŒ¯    for order, filename,pdf_path in pdf_files:        # å°† PDF æ–‡ä»¶æ·»åŠ åˆ°åˆå¹¶å™¨ä¸­        merger.append(pdf_path)    # ç¡®ä¿è¾“å‡ºæ–‡ä»¶å¤¹å­˜åœ¨    os.makedirs(output_folder, exist_ok=True)    # å°†åˆå¹¶åçš„ PDF ä¿å­˜åˆ°æ–‡ä»¶    output_path = os.path.join(output_folder, &quot;merged_pdf.pdf&quot;)    merger.write(output_path)    # å…³é—­åˆå¹¶å™¨    merger.close()if __name__ == &quot;__main__&quot;:    csv_file = r&quot;D:\\Python\\pdf_doc\\pdf_files.csv&quot;  # CSV æ–‡ä»¶çš„è·¯å¾„    pdf_files = read_csv_to_pdf_files(csv_file)    output_folder = r&quot;D:\\Python\\pdf_doc&quot;  # è¾“å‡ºæ–‡ä»¶å¤¹çš„è·¯å¾„    merge_pdfs_directly(pdf_files,output_folder)\r\næœ€çµ‚æˆæœ\r\nè—‰ç”±vbaçš„è½‰æª”åŠpythonçš„åˆä½µè™•ç†æˆçš„æª”æ¡ˆï¼Œç¸½å…±æœ‰432é çš„PDF ğŸ”—\r\nğŸ”—å®Œæ•´ç‰ˆ-å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„æˆæœä¸‹è¼‰\r\n\r\n\r\nğŸ‘»é–‹ç™¼éç¨‹çš„å•é¡Œ\r\næ“ä½œCSVçš„éç¨‹æ›¾ç¶“å‡ºç¾ä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œè¨˜éŒ„ä¸€ä¸‹æ¯”è¼ƒä¸æœƒå¿˜è¨˜\r\næª”æ¡ˆåç¨±ç‚ºä¸­æ–‡ï¼Œè¦æ”¶é›†åŒ¯å…¥csvæª”æ¡ˆçš„æ™‚æœƒè®Šæˆäº‚ç¢¼\r\néœ€è¦å°‡ç·¨ç¢¼ç”±utf-8æ”¹ç‚ºutf-8-sig\r\nwith open(output_csv, &quot;w&quot;, newline=&#x27;&#x27;, encoding=&#x27;utf-8-sig&#x27;) as csv_file: \r\nCSDNåƒè€ƒ\r\nè¦å°‡CSVçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾'UnicodeDecodeError'\r\nå°‡åŸæœ¬çš„è®€å–å…§å®¹ä¸­çš„encodingæ›æˆ\r\nerrors='replace' å³å¯\r\nwith open(&#x27;some.csv&#x27;, newline=&#x27;&#x27;, encoding=&#x27;utf-8&#x27;) as f:  reader = csv.reader(f)  for row in reader:    print(row)\r\nwith open(&#x27;some.csv&#x27;, newline=&#x27;&#x27;, errors=&#x27;replace&#x27;) as f:   reader = csv.reader(f)   for row in reader:    print(row)\r\nStack\r\noverflowåƒè€ƒè³‡æ–™\r\né–‹å•Ÿä¸€å€‹å…¨æ–°çš„ç’°å¢ƒï¼Œè¦å°‡CSVçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾\r\nFileNotFoundError: [Errno 2] No such file or directory: &#x27;D:\\\\GoogleDrive-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\\\\ï¿½ï¿½ç¥ˆæ¥ç’ˆï¿½ç’‡ï¿½é–®å‰›ï¿½ï¿½é–¬ï¿½ è­ï¿½\\\\èšç Œï¿½ï¿½è¡ï¿½ è®è³¢ï¿½ï¿½1090103.pdf\r\nåŸæœ¬ç¬¬äºŒé»å¯ä»¥è§£æ±ºç·¨è­¯å•é¡Œçš„ç¨‹å¼ç¢¼èª¿æ•´ errors='replace'\r\nå·²ç¶“ç„¡æ³•ä½œç”¨ï¼Œæˆ‘æŠŠencoding='utf-8-sig'é‡æ–°åŠ ä¸Šå»ï¼Œç„¶å¾Œå°±å¥½äº†(?)\r\n\r\nçŒœæ¸¬æ˜¯æ–°çš„ç’°å¢ƒä¸­é‚„æ²’æœ‰é è¨­çš„encodingï¼Œæ‰€ä»¥ä¸­æ–‡é‚„æ²’æœ‰è¾¦æ³•è¢«çŸ¥é“è¦æ€éº¼ç·¨è­¯ã€‚\r\n\r\nwith open(&#x27;some.csv&#x27;, newline=&#x27;&#x27;, encoding=&#x27;utf-8-sig&#x27;) as f:  reader = csv.reader(f)  for row in reader:    print(row)\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["python","ExcelVBA"]},{"title":"æ–½å·¥ç…§ç‰‡VBA-å¯¦ä½œæµç¨‹","url":"/posts/144473154/","content":"å‰è¨€\r\nå·¥ç¨‹é€²è¡Œéšæ®µå› ç‚ºæ¥­ä¸»ã€ç›£é€ ä¸ä¸€å®šéƒ½æœƒåœ¨ç¾å ´ï¼Œç„¡è«–æ–½å·¥æŠ½æŸ¥ã€å“è³ªç®¡ç†ã€éš±è”½éƒ¨åˆ†å°ºå¯¸ç´€éŒ„ã€ç£å°æœƒå‹˜...ç­‰ç­‰å…§å®¹ï¼Œå¤§å¤šæ•¸æ–‡ä»¶éƒ½æœƒéœ€è¦ç…§ç‰‡ä½œç‚ºä½è­‰è³‡æ–™ï¼Œå°¤å…¶æ˜¯å‡è¨­å·¥ç¨‹ã€éš±è”½éƒ¨åˆ†æ›´æ˜¯éœ€è¦ï¼Œå› æ­¤æ•´å€‹å·¥ç¨‹æ¡ˆé€²è¡Œéç¨‹å¯èƒ½æœƒç´¯ç©å¤§é‡çš„ç…§ç‰‡ï¼Œå¾ŒçºŒçš„è«‹æ¬¾å ±è¡¨ç…§ç‰‡è²¼é™„ã€ç…§ç‰‡æª”æ¡ˆæŸ¥æ‰¾ï¼Œæœƒæ˜¯è®“å…§æ¥­äººå“¡ç›¸ç•¶èŠ±è²»æ™‚é–“çš„ä¸€ç’°ã€‚\r\nå¯¦å‹™ä¸Šå¤§å¤šæœƒæ¡ç”¨LINEç¾¤çµ„é€²è¡Œç…§ç‰‡ä¸Šå‚³ï¼Œç…§ç‰‡èªªæ˜æœƒå‡ºç¾åœ¨ç•«é¢ä¸­çš„å°ç™½æ¿ï¼Œå†ç”±å…§æ¥­äººå“¡è‡ªè¡Œä¸‹è¼‰å‚™å­˜ï¼Œæ”¾åœ¨æœ¬æ©Ÿç¡¬ç¢Ÿä¸­æˆ–è€…æ˜¯æ”¾åœ¨å…¬å¸çš„NASè£¡é¢ï¼Œæœªä¾†éœ€è¦åˆ©ç”¨æ™‚å†å»è‡ªå·±æ‰€åˆ†é¡çš„è³‡æ–™å¤¾ä¸­æ¯”å°ã€ä¸‹è¼‰ã€è²¼é™„ï¼Œå› æ­¤å°æ–¼è™•ç†ç…§ç‰‡çš„æª”æ¡ˆç®¡ç†ã€å ±è¡¨è¼¸å‡ºæˆ‘æƒ³éœ€è¦æœ‰æ–¹æ³•ä¾†å®Œæˆå¤§é‡ã€ç¹è¤‡ã€ç°¡å–®çš„å·¥ä½œæµç¨‹ï¼Œç¯€çœæ™‚é–“ä¾†åšå…¶ä»–æ¥­å‹™å…§å®¹ã€‚\r\nå› æ­¤ï¼Œæ–½å·¥ç…§ç‰‡VBAèª•ç”Ÿäº†ï¼Œæ–¼2023å¹´1æœˆç™¼å¸ƒçµ¦å¤§çœ¾ä½¿ç”¨é‹è¡Œè‡³ä»Šï¼Œè©²ä¿®å¾©çš„å…§å®¹å¤§æ¦‚å·²ç¶“å®Œæˆï¼Œä»¥ä¸‹ç‚ºç›®å‰æ‰€é‡‹å‡ºçš„æ–½å·¥ç…§ç‰‡VBAéƒ¨åˆ†å…§å®¹ï¼Œå®Œæ•´å…§å®¹è«‹åƒè€ƒæ–½å·¥ç…§ç‰‡VBAå®Œæ•´åŸå§‹ç¢¼ã€‚\r\n\r\nDEMO\r\n\r\n\r\n\r\nç¬¬ä¸€ç« ç¯€ è³‡æ–™å¤¾\r\n1-1 å–å¾—è³‡æ–™å¤¾\r\n\r\nå­¸ç¿’å¦‚ä½•é€éVBAå…§å»ºçš„è³‡æ–™å¤¾é¸æ“‡è¦–çª—å°‡ç…§ç‰‡å­˜æ”¾è·¯å¾‘æ”¾ç½®åˆ°å·¥ä½œè¡¨\r\n\r\nSub SelectFolder()Dim objDialog As FileDialogSet objDialog = Application.FileDialog(msoFileDialogFolderPicker)With objDialog    If .Show = True Then            Sheets(&quot;Main&quot;).Range(&quot;B2&quot;) = objDialog.SelectedItems(1)        End IfEnd WithEnd Sub\r\n1-2 æŸ¥çœ‹è³‡æ–™å¤¾\r\n\r\nå­¸ç¿’å¦‚ä½•é€éShellçš„æ–¹æ³•ä¾†é–‹å•ŸæŒ‡å®šè³‡æ–™å¤¾\r\n\r\nSub showFolder()main_path = Sheets(&quot;Main&quot;).Range(&quot;B2&quot;)Shell &quot;explorer.exe &quot; &amp; main_path, vbNormalFocusEnd Sub\r\nç¬¬äºŒç« ç¯€ ç…§ç‰‡åŸºæœ¬è³‡æ–™\r\n2-1 ç…§ç‰‡æª”æ¡ˆç®¡ç†\r\n\r\n\r\nè³‡æ–™åº«ä»‹é¢\r\n\r\nSub getDataFromFolder()Dim clsInf As New clsInformationDim objFile As New clsmyFileWith Sheets(&quot;Main&quot;)&#x27;If MsgBox(&quot;æ˜¯å¦è¦è²¼ä¸Šç¸®åœ–?&quot;, vbYesNo) = vbYes ThenIf clsInf.IsPasteIMG = True Then    objFile.IsPaste = True    mywidth = CInt(clsInf.getIMGwidth) &#x27;  CInt(InputBox(&quot;è«‹è¼¸å…¥ç¸®åœ–å¯¬åº¦:&quot;))    objFile.photo_width = mywidth / 4    objFile.photo_height = mywidth    End IfobjFile.main_path = .Range(&quot;B2&quot;)objFile.delRng &#x27;åˆªé™¤æ—¢æœ‰æ¬„ä½objFile.getAllFolder &#x27;å¾ªç’°å–å¾—æŒ‡å®šè³‡æ–™å¤¾ä¸­æ‰€æœ‰ç…§ç‰‡è·¯å¾‘objFile.PastePictures  &#x27;ä¾åºè²¼ä¸Šåˆ°æ“ä½œä»‹é¢End WithCall extractNames &#x27;ç”±æª”åèƒå–è‡³ä»‹é¢æ¬„ä½Call ApplyFilterToAllUsedCells &#x27;End Sub\r\n\r\nåˆªé™¤æ—¢æœ‰æ¬„ä½\r\n\r\nSub delRng()tmp = split(main_path, &quot;\\&quot;)main_folder = tmp(UBound(tmp))With shtResult&#x27;.Range(&quot;A1:F1&quot;) = Array(&quot;ID&quot;, &quot;ç¸®åœ–&quot;, &quot;å…¨è·¯å¾‘&quot;, &quot;è³‡æ–™å¤¾(&quot; &amp; main_folder &amp; &quot;)&quot;, &quot;æª”å&quot;, &quot;æ›´æ”¹æª”å&quot;).Range(&quot;D1&quot;) = &quot;è³‡æ–™å¤¾(&quot; &amp; main_folder &amp; &quot;)&quot;Set rng_last = .Cells.SpecialCells(xlCellTypeLastCell)lr = .Cells(.Rows.Count, 1).End(xlUp).Rowlc = .Cells(1, .Columns.Count).End(xlToLeft).ColumnIf lr &gt; 1 Then .Range(&quot;A2&quot;).Resize(rng_last.Row, rng_last.Column).ClearFor Each Shape In .Shapes        &#x27;Debug.Print Shape.Address        If Shape.TopLeftCell.Row &lt;&gt; 1 Then Shape.DeleteNextEnd WithEnd Sub\r\n\r\nå–å¾—æŒ‡å®šè³‡æ–™å¤¾ä¸‹æ‰€æœ‰ç…§ç‰‡è·¯å¾‘\r\n\r\nSub getAllFolder()Dim objFolder As ObjectSet objFolder = objFso.GetFolder(main_path)Call getAllFile(objFolder)End SubPrivate Sub getAllFile(ByVal objFolder As Object)If objFolder.Files.Count &lt;&gt; 0 Then    For Each objFile In objFolder.Files        s = objFso.GetExtensionName(objFile)            If IsPhoto(s) Then coll_photo_path.Add objFile.path            NextEnd IfIf objFolder.subFolders.Count &lt;&gt; 0 Then    For Each objSubFolder In objFolder.subFolders            Call getAllFile(objSubFolder)        NextEnd IfEnd Sub\r\n\r\nè²¼ä¸Šç…§ç‰‡åˆ°æ“ä½œä»‹é¢\r\n\r\nSub PastePictures()With shtResult        lr = .Cells(1, 1).End(xlDown).Row    lc = .Cells(1, 1).End(xlToRight).Column - 1        Set rng_last = .Cells(lr, lc)        &#x27;Set rng_last = .Cells.SpecialCells(xlCellTypeLastCell)        r = 2        For Each photo_path In coll_photo_path            If IsPaste = True Then                Set objTargetCell = .Cells(r, 2)                objTargetCell.ColumnWidth = photo_width            objTargetCell.RowHeight = photo_height                    Set pic = .Pictures.Insert(photo_path)            &#x27;Set pic = .Pictures.Insert(imagePath).ShapeRange.PictureFormat.Compression = 75            &#x27;Set pic = .Shapes.AddPicture(photo_path) &#x27;, True, True, objTargetCell.Left + 2, objTargetCell.Top + 2, objTargetCell.Width - 4, objTargetCell.Height - 4)            &#x27;pic.LockAspectRatio = msoFalse                    With pic                            dblGap = 2#                            .ShapeRange.LockAspectRatio = msoTrue &#x27;é–å®šç…§ç‰‡é•·å¯¬æ¯”                                Set ranOri = objTargetCell                dblRatioPic = .Width / .Height                dblRatioOri = ranOri.Width / ranOri.Height                                If dblRatioPic &gt; dblRatioOri Then &#x27;å¯¬åº¦æ§åˆ¶                    .Width = ranOri.Width - 2 * dblGap                    .Top = ranOri.Top + 0.5 * ranOri.Height - 0.5 * .Height                    .Left = ranOri.Left + dblGap                Else                                &#x27;é«˜åº¦æ§åˆ¶                    .Height = ranOri.Height - 2 * dblGap                    .Top = ranOri.Top + dblGap                    .Left = ranOri.Left + 0.5 * ranOri.Width - 0.5 * .Width                                    End If                        End With                End If                        .Cells(r, 1) = r - 1        .Cells(r, 3) = photo_path        .Cells(r, 4) = getParentFolder(photo_path) &#x27;å–å¾—ä¸Šå±¤ç›®éŒ„        .Cells(r, 5) = getFileName(photo_path) &#x27;å–å¾—æª”æ¡ˆåç¨±                .Cells(r, 1).Resize(1, rng_last.Column).Borders.LineStyle = 1        .Cells(r, 6).Resize(1, rng_last.Column).HorizontalAlignment = xlLeft                &#x27;Call getMarkDetail(.Cells(r, 5), r)                                r = r + 1        NextEnd WithEnd Sub&#x27;====å–å¾—ä¸Šå±¤ç›®éŒ„è·¯å¾‘=====Function getParentFolder(ByVal path As String)tmp_folder = Replace(path, main_path, &quot;&quot;)tmp = split(tmp_folder, &quot;\\&quot;)tmp_filename = tmp(UBound(tmp))getParentFolder = Replace(tmp_folder, tmp_filename, &quot;&quot;)End Function&#x27;====å–å¾—æª”æ¡ˆåç¨±=====Function getFileName(ByVal path As String)tmp = split(path, &quot;\\&quot;)getFileName = tmp(UBound(tmp))End Function\r\n2-2 åŸºæœ¬è³‡æ–™ç™»éŒ„\r\n\r\n\r\næ“ä½œä»‹é¢è¡¨å–®åŒ–\r\n\r\n&#x27;InitializePrivate Sub UserForm_Initialize()With Sheets(&quot;Result&quot;)    lr = .Cells(.Rows.Count, 1).End(xlUp).Row    Me.Label2.Caption = &quot;å…±&quot; &amp; lr - 1 &amp; &quot;å¼µ&quot;        Me.Label3.Caption = .Cells(1, 7)    Me.Label4.Caption = .Cells(1, 8)    Me.Label5.Caption = .Cells(1, 9)    Me.Label6.Caption = .Cells(1, 10)    Me.Label7.Caption = .Cells(1, 11)        Me.TextBox1 = &quot;1&quot;        Me.ComboBox1.AddItem &quot;æ–½å·¥æŠ½æŸ¥&quot;    Me.ComboBox1.AddItem &quot;å“è³ªç®¡åˆ¶&quot;    Me.ComboBox1.AddItem &quot;ç¼ºå¤±æ”¹å–„&quot;    Me.ComboBox1.AddItem &quot;æ–½å·¥ä¸­&quot;End WithEnd Sub&#x27;ç¯€éŒ„ç…§ç‰‡å…§å®¹Private Sub TextBox1_Change()Dim clsI As New clsInformation&#x27;If clsI.IsShowEditForm = False Then Exit SubOn Error Resume NextIf TextBox1.Value &lt;&gt; &quot;0&quot; Thens = Cells(TextBox1.Value + 1, 3)&#x27;On Error Resume NextImage1.Picture = LoadPicture(s)ImageTmp.TextBox2 = Cells(TextBox1.Value + 1, 7)ImageTmp.TextBox3 = Cells(TextBox1.Value + 1, 8)ImageTmp.TextBox4 = Cells(TextBox1.Value + 1, 9)ImageTmp.ComboBox1 = Cells(TextBox1.Value + 1, 10)&#x27;ImageTmp.TextBox5 = Cells(TextBox1.Value + 1, 10)ImageTmp.TextBox6 = Cells(TextBox1.Value + 1, 11)End IfEnd Sub\r\nç¬¬ä¸‰ç« ç¯€ å ±è¡¨ç‰ˆå‹\r\n3-1 å ±è¡¨åŸºæœ¬ç‰ˆå‹\r\nSub getReportShts()Dim coll As New CollectionFor Each sht In Sheets    If sht.Name Like &quot;*-*&quot; Then        coll.Add sht.Name        End IfNextFor Each it In coll    j = j + 1    p = p &amp; j &amp; &quot;.&quot; &amp; it &amp; vbNewLineNextAGAIN:mode = InputBox(&quot;è«‹é¸æ“‡åˆ—å°ç‰ˆå‹:&quot; &amp; vbNewLine &amp; p)Sheets(coll(CInt(mode))).PrintPreviewmsg = MsgBox(&quot;é€™æ˜¯æ‚¨è¦çš„ç‰ˆå‹å—?&quot;, vbYesNo)If msg = vbYes Then    Sheets(&quot;Main&quot;).Range(&quot;B4&quot;) = coll(CInt(mode))Else    GoTo AGAINEnd IfSheets(&quot;Main&quot;).ActivateEnd Sub\r\n3-2 å ±è¡¨å®¢è£½ç‰ˆå‹â­\r\nå­¸ç¿’å¦‚ä½•å¾æ—¢æœ‰ç‰ˆå‹èª¿æ•´æ¨™ç±¤å¡Šåˆ°æŒ‡å®šä½ç½®ä¸¦èª¿æ•´æ•¸é‡ï¼Œæ‰¹æ¬¡ä»£å…¥å·¥ä½œè¡¨\r\n\r\n&lt;&gt; å¼•å…¥ç…§ç‰‡\r\n&lt;&gt; å°æ‡‰Hæ¬„\r\n&lt;&gt; å°æ‡‰Gæ¬„\r\n&lt;&gt; å°æ‡‰Iæ¬„\r\n\r\nSub checkReportFormat()    Dim coll As New Collection    &#x27; éæ­·å ±è¡¨ä¸­çš„æ‰€æœ‰å„²å­˜æ ¼    For Each rng In Sheets(getReportShtName).UsedRange        &#x27; å¦‚æœå„²å­˜æ ¼çš„å€¼åŒ¹é… &quot;&lt;&lt;*&gt;&gt;&quot;        If rng.Value Like &quot;&lt;&lt;*&gt;&gt;&quot; Then            &#x27; å»æ‰ &lt;&lt; å’Œ &gt;&gt;            tmp = Replace(rng.Value, &quot;&lt;&lt;&quot;, &quot;&quot;)            tmp = Replace(tmp, &quot;&gt;&gt;&quot;, &quot;&quot;)            &#x27; å°‡çµæœåŠ å…¥åˆ° coll é›†åˆä¸­            coll.Add tmp        End If    Next    Dim coll_unique As New Collection    &#x27; æª¢æŸ¥å ±è¡¨ä¸­æ¯å€‹æ¨™è¨»é …ç›®çš„å°æ‡‰è¡¨é ­åç¨±    For Each it In coll        &#x27; å°‡ coll ä¸­çš„æ¯å€‹é …ç›®æŒ‰ &quot;-&quot; æ‹†åˆ†ï¼Œå–å¾—é—œéµå­— ky        s = Split(it, &quot;-&quot;)        ky = s(0)                &#x27; åœ¨ &quot;Result&quot; è¡¨çš„ç¬¬ä¸€è¡ŒæŸ¥æ‰¾é€™å€‹é—œéµå­—        Set rng = Sheets(&quot;Result&quot;).Rows(1).Find(ky)                &#x27; å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¸”é—œéµå­—ä¸ç­‰æ–¼ &quot;ç…§ç‰‡&quot;ï¼Œé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ä¸¦é¸ä¸­å ±è¡¨ä¸­çš„å°æ‡‰ä½ç½®        If rng Is Nothing And ky &lt;&gt; &quot;ç…§ç‰‡&quot; Then            Sheets(getReportShtName).Activate            MsgBox &quot;ã€&quot; &amp; it &amp; &quot;ã€‘:å°æ‡‰ä¸åˆ°Resultçš„è¡¨é ­åç¨±&quot;            Set rng_focus = Sheets(getReportShtName).Cells.Find(&quot;&lt;&lt;&quot; &amp; it &amp; &quot;&gt;&gt;&quot;)            rng_focus.Select            End        End If                &#x27; å°‡å”¯ä¸€çš„ç·¨è™Ÿ num æ·»åŠ åˆ° coll_unique é›†åˆä¸­        num = s(1)        On Error Resume Next        coll_unique.Add num, CStr(num)        On Error GoTo 0    Next    Dim coll_count As New Collection    &#x27; è¨ˆç®—æ¯å€‹å”¯ä¸€ç·¨è™Ÿå‡ºç¾çš„æ¬¡æ•¸    For Each it_unique In coll_unique        cnt = 0        For Each it In coll            s = Split(it, &quot;-&quot;)            num = s(1)            If num = it_unique Then                cnt = cnt + 1            End If        Next        &#x27; å°‡çµæœä»¥ &quot;ç·¨è™Ÿ-æ¬¡æ•¸&quot; çš„æ ¼å¼æ·»åŠ åˆ° coll_count é›†åˆä¸­        coll_count.Add it_unique &amp; &quot;-&quot; &amp; cnt    Next    &#x27; æª¢æŸ¥æ¯å€‹å”¯ä¸€ç·¨è™Ÿçš„å‡ºç¾æ¬¡æ•¸æ˜¯å¦ä¸€è‡´    For i = 1 To coll_count.Count - 1        s_cnt = Split(coll_count(i), &quot;-&quot;)(1)        e_cnt = Split(coll_count(i + 1), &quot;-&quot;)(1)        If s_cnt &lt;&gt; e_cnt Then            MsgBox &quot;å ±è¡¨ä½ç½®è¨»è¨˜é …ç›®ï¼Œä¸åŒç·¨è™Ÿæ‡‰å…·æœ‰ç›¸åŒæ•¸é‡!&quot; &amp; vbNewLine &amp; _            &quot;è«‹æª¢æ ¸ç¬¬&quot; &amp; Split(coll_count(i), &quot;-&quot;)(0) &amp; &quot;æ¬¡èˆ‡ç¬¬&quot; &amp; Split(coll_count(i + 1), &quot;-&quot;)(0) &amp; &quot;æ¬¡!&quot;, vbCritical            End        End If    NextEnd Sub\r\n3-3 æ–‡å­—ç´°ç¯€èª¿æ•´\r\n\r\næ—¥æœŸæ˜¯å¦å‡ºç¾æ–¼å³ä¸‹è§’çš„æµ®æ°´å°æ–‡å­—å¡Šï¼Œèª¿æ•´å…¶æ–‡å­—é¡è‰²åŠç¶²åº•é¡è‰²\r\n\r\nSub AddText(ByVal txtX, ByVal txtY, ByVal txtHeight, ByVal txtWidth, ByVal txtStr, Optional ByVal RGB_Selector As Integer = 0)Dim o As New clsInformationDim r As LongDim g As LongDim b As LongDim r2 As LongDim g2 As LongDim b2 As LongIf o.IsPrintDate = False Then Exit SubRGB_Interior = o.getInteriorColorCall o.VBLongToRGB(RGB_Interior, r, g, b)RGB_Font = o.getFontColorCall o.VBLongToRGB(RGB_Font, r2, g2, b2)With ThisWorkbook.Sheets(report_shtname)    .Activate    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, txtX, txtY, txtHeight * Len(txtStr) * 0.33, txtHeight).Select    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.text = txtStr            Selection.ShapeRange.Fill.Visible = msoFalse    Selection.ShapeRange.Line.Visible = msoFalse    Selection.ShapeRange.ZOrder msoBringToFront        With Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Font        .Bold = msoTrue        .Fill.ForeColor.RGB = RGB(r2, g2, b2)        .Size = txtHeight * 0.5            End With        If o.IsPrintDateBack = True Then            With Selection.ShapeRange(1).Fill            .Visible = msoTrue            .ForeColor.RGB = RGB(r, g, b)        End With    End IfEnd WithEnd Sub\r\nç¬¬å››ç« ç¯€ å ±è¡¨è¼¸å‡º\r\n4-1 å ±è¡¨è¼¸å‡ºæ–¹æ³• â­\r\n\r\nå»ºç«‹åˆ—å°ç¾¤çµ„ï¼Œæ ¹æ“šç‰ˆå‹æ±ºå®šæ¯å¹¾å¼µè¦æ›é ï¼Œç”±å·¥ä½œè¡¨æœªéš±è—çš„åˆ—æ±ºå®šåˆ—å°é †åºï¼Œæœªä¾†äº¦å¯å»ºç«‹è‡ªå·±çš„åˆ—å°è¦å‰‡ï¼Œå°‡å‚™è¨»æ¬„çš„è³‡æ–™ç¯©é¸ä½µå…¥ä½œç‚ºåˆ—å°çš„è§¸ç™¼æ“´å……é …ç›®(æ¯”å¦‚è¨­å®šæ”¹å–„ç·¨è™Ÿã€é æ¬¡ä¾†å°‡å·¥ä½œè¡¨çš„é †åºé€²è¡Œé‡æ–°èª¿æ•´)ã€‚\r\n\r\nSub getPrintGroups()Call checkDateFormatCall checkReportFormatDim f As New clsMyfunctionDim coll_rows_final As New Collection    Set coll_rows = getRowsUnHidden        folder_name = Format(Now(), &quot;YYYYMMDD-HHMMSS &quot;)        For Each r In coll_rows            With Sheets(&quot;Result&quot;)                If .Cells(r, .Columns.Count).End(xlToLeft).Column &gt; 5 Then                    coll_rows_final.Add r                        End If            End With        Next        If coll_rows_final.Count &gt; 0 Then Call printFilesByRows(coll_rows_final, True, folder_name)        Set coll_rows_final = NothingSheets(&quot;Main&quot;).ActivateWorkbooks(Workbooks.Count).ActivateEnd Sub\r\n\r\nåˆ—å°ç›¸é—œä»£ç¢¼ï¼ŒåŒ…å«åˆ—å°æˆPDFè·Ÿåˆ—å°æˆXLS\r\n\r\nSub printFilesByRows(ByVal coll_rows, ByVal IsXLS As Boolean, ByVal folder_name As String)Dim o As New clsReportDim f As New clsMyfunctionDim coll_recover As New Collectionreport_shtname = Sheets(&quot;Main&quot;).Range(&quot;B4&quot;)Set coll_key = getKeyWords &#x27;ç¬¬Gæ¬„é–‹å§‹Set wb = Workbooks.AddThisWorkbook.ActivateFor Each r In coll_rowsKeepPrint:    i = i + 1        For Each s In coll_key                myKey = split(s, &quot;,&quot;)(0)        col = split(s, &quot;,&quot;)(1)            myAddress = getAddressByKeyWord(myKey, CStr(i))        &#x27;        If i = 4 Then Stop            If myAddress &lt;&gt; &quot;&quot; Then                        If myKey = &quot;ç…§ç‰‡&quot; Then                            file_name = file_name &amp; r &amp; &quot;-&quot;                &#x27;paste photo                Call o.PastePhoto_giveRng(Sheets(getReportShtName).Range(myAddress), Sheets(&quot;Result&quot;).Cells(r, &quot;C&quot;), Sheets(&quot;Result&quot;).Cells(r, CInt(col)))                        ElseIf myKey = &quot;æ—¥æœŸ&quot; Then                                Sheets(getReportShtName).Range(myAddress) = f.tranStrToDate(Sheets(&quot;Result&quot;).Cells(r, CInt(col)))                        Else                            Sheets(getReportShtName).Range(myAddress) = Sheets(&quot;Result&quot;).Cells(r, CInt(col))                        End If                        coll_recover.Add &quot;&lt;&lt;&quot; &amp; myKey &amp; &quot;-&quot; &amp; CStr(i) &amp; &quot;&gt;&gt;;&quot; &amp; myAddress            IsPrinted = False                    Else                        IsPrinted = True            If IsXLS = False Then                Call printReportPDF(file_name)            Else                Call printReportToWb(wb, file_name)            End If                        Call clearReport(coll_recover)            file_name = &quot;&quot;            i = 0            GoTo KeepPrint                    End If            NextNextIf IsPrinted = False Then    If IsXLS = False Then        Call printReportPDF(file_name)    Else        Call printReportToWb(wb, file_name)    End If        Call clearReport(coll_recover)    End IfIf IsXLS = True Then Call printReportToWb_Save(wb, folder_name)End Sub\r\n4-2 ç…§ç‰‡æ­¸æª”\r\n\r\nå°‡å·¥ä½œè¡¨ä¸Šæ‰‹å‹•ç´€éŒ„çš„è³‡æ–™å…§å®¹ä¾ç…§æŒ‡å®šæ–¹å¼æ‰¹æ¬¡é‡å°ç…§ç‰‡åŸå§‹æª”æ¡ˆé€²è¡Œæª”åæ›´æ”¹ï¼Œæœªä¾†å¼•å…¥æ™‚æœƒå…ˆåˆ¤å®šæª”åå…§å®¹å¼•å…¥å·¥ä½œè¡¨ç›¸å°æ‡‰è³‡æ–™ã€‚\r\n\r\nSub ChangeAllFileName()If Sheets(&quot;Result&quot;).AutoFilterMode Then    Sheets(&quot;Result&quot;).AutoFilterMode = FalseEnd IfCall getCombineNamesDim objFile As New clsmyFileWith Sheets(&quot;Main&quot;)    objFile.main_path = .Range(&quot;B2&quot;)    objFile.changeFileNameEnd WithCall getDataFromFolder &#x27;reloadingEnd SubSub getCombineNames()Dim clsInf As New clsInformationSet coll = clsInf.getCollStructure(clsInf.getReNameStruc)With Sheets(&quot;Result&quot;)    lr = .Cells(.Rows.Count, 1).End(xlUp).Row        For r = 2 To lr            If .Cells(r, .Columns.Count).End(xlToLeft).Column &gt; 5 Then                    p = &quot;&quot;                    For Each col In coll                            p = p &amp; .Cells(r, col) &amp; &quot;_&quot;                        Next                        .Cells(r, &quot;F&quot;) = mid(p, 1, Len(p) - 1)                End If        NextEnd WithEnd Sub\r\n\r\næ”¹åéƒ¨åˆ†\r\n\r\nSub changeFileName()With shtResult    lr = .Cells(.Rows.Count, 1).End(xlUp).Row        For r = 2 To lr            oldname = .Cells(r, 3)                If .Cells(r, 6) Like &quot;*.jp*&quot; Then            newname = main_path &amp; .Cells(r, 4) &amp; .Cells(r, 6)        Else            newname = main_path &amp; .Cells(r, 4) &amp; .Cells(r, 6) &amp; &quot;.jpg&quot;        End If            If .Cells(r, 6) &lt;&gt; &quot;&quot; Then                        Debug.Print &quot;old:&quot; &amp; oldname            Debug.Print &quot;new:&quot; &amp; newname                        Name oldname As newname                    End If    NextEnd WithEnd Sub\r\n\r\nQA\r\nç›®å‰æœ‰ç¶²å‹è¡¨ç¤ºï¼Œè¼¸å‡ºçš„å ±è¡¨ç…§ç‰‡æœƒè®Šå½¢ï¼Œç¶“æŸ¥ç‚ºä»¥ä¸‹è©²æ®µç¨‹å¼ç¢¼çš„åŸå› ï¼Œå¯ä»¥å°‡é€™æ®µç¨‹å¼ç¢¼è“‹æ‰æœ¬ä¾†çš„å…§å®¹å°±å¥½ã€‚\r\n&#x27;ä½ç½®:ç‰©ä»¶é¡åˆ¥æ¨¡çµ„/clsReport/PastePhoto_giveRngSub PastePhoto_giveRng(ByVal rng As Object, ByVal photo_path As String, ByVal checkday As String)&#x27;é¡å¤–æ¥å…¥checkdayç•¶ä½œtextåŸºåº•æ–‡å­—With shtReport    &#x27;Set rng = .Range(coll_rng_address(Count))    If rng.MergeCells Then            myMergeArea = rng.MergeArea        dy = UBound(myMergeArea, 1)        dx = UBound(myMergeArea, 2)        End If        Set LastRng = .Cells(rng.Row + dy - 1, rng.Column + dx - 1).Offset(1, 1)        X0 = rng.Left    Y0 = rng.Top        X1 = LastRng.Left    Y1 = LastRng.Top    targetWidth = X1 - X0 - 4    targetHeight = Y1 - Y0 - 4      &#x27; åŠ å…¥åœ–ç‰‡ï¼Œå…ˆæ”¾å¤§ä¸€é»    Set pic = .Shapes.AddPicture(photo_path, True, True, X0 + 2, Y0 + 2, -1, -1)                                         &#x27; é–å®šæ¯”ä¾‹ä¸è®Š    pic.LockAspectRatio = msoTrue        &#x27; æ ¹æ“šåŸå§‹æ¯”ä¾‹æ±ºå®šæ˜¯ç¸®æ”¾å¯¬é‚„æ˜¯é«˜    If (pic.Width / pic.Height) &gt; (targetWidth / targetHeight) Then        &#x27; åœ–ç‰‡æ¯”è¼ƒå¯¬ï¼Œä»¥å¯¬åº¦ç‚ºä¸»        pic.Width = targetWidth    Else        &#x27; åœ–ç‰‡æ¯”è¼ƒé«˜ï¼Œä»¥é«˜åº¦ç‚ºä¸»        pic.Height = targetHeight    End If        &#x27; æ ¹æ“šèª¿æ•´å¾Œå¯¬åº¦é‡æ–°ç½®ä¸­ (optional)    pic.Left = X0 + ((X1 - X0) - pic.Width) / 2        Call AddText(X1 - 100, Y1 - 30, 25, 40, tranDate(checkday), 3) &#x27;é¡å¤–æ¥å…¥ä¹‹checkdayè¦é¡¯ç¤ºæ–¼ç…§ç‰‡å³ä¸‹è§’    End WithEnd Sub\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","æ–½å·¥ç…§ç‰‡"]},{"title":"æ˜æ¸ æ°´ç†è¨ˆç®—","url":"/posts/3021870975/","content":"ğŸ™Œå‰è¨€\r\næ˜æ¸ è¼¸æ°´æ¸ é“çš„è¨­è¨ˆé‡é»å¤§æ¦‚ç¾…åˆ—å¦‚ä¸‹å¹¾é»:\r\n\r\næ’æ°´æ¸ é“è¦æ³¨æ„æµé‡æ˜¯å¦å¯ä»¥æä¾›è¾²ç”°æ’æ°´10å¹´é‡ç¾æœŸè·1æ—¥æ’å‡ºã€‚\r\nçŒæº‰æ¸ é“è¦ç¢ºèªçŒæº‰è¨ˆç•«æ‰€éœ€è¨ˆç•«æµé‡ã€‚\r\nè¨­è¨ˆçš„æœ€å°å®¹è¨±æµé€Ÿä¸èƒ½ä½æ–¼æ°´è‰ç”Ÿé•·é€Ÿåº¦æˆ–æ·¤æ²™é€Ÿåº¦ã€‚\r\nè¨­è¨ˆçš„æœ€å¤§å®¹è¨±æµé€Ÿä¸èƒ½é«˜æ–¼è¦ç¯„æ‰€é™åˆ¶çš„é€Ÿåº¦ã€‚\r\nè¨­è¨ˆæ™‚éœ€æ³¨æ„ä¸èƒ½å¤ªæ¥è¿‘è‡¨ç•Œæµæ³ï¼Œå‹•æ°´å£“åŠ›å°æ§‹é€ ç‰©è¼ƒå®¹æ˜“ä¸ç©©å®šã€‚\r\næŒ‘é¸åˆå®œçš„å‡ºæ°´é«˜åº¦æé«˜å…¶ä»–å› ç´ æ‰€è‡´ä¹‹é¡å¤–æµé‡ã€‚\r\næª¢è¨å„ç”°å€æ‰€éœ€çŒæº‰æ°´é ­æ˜¯å¦è¶³å¤ ï¼Œç›¡é‡æ¸›å°‘åˆ¶æ°´æ±´ç‰ˆçš„ä½¿ç”¨ã€‚\r\n\r\næœ‰é—œè¾²ç”°æ’æ°´çš„æµé‡å¯ä»¥åƒè€ƒè¾²ç”°æ’æ°´å·¥ç¨‹è¦åŠƒè¨­è¨ˆåŸå‰‡åƒè€ƒæ‰‹å†Š(108ç‰ˆ)é€²è¡Œæ¨ç®—\r\n\r\næ¼”ç®—æµç¨‹å¯ä»¥åˆ©ç”¨Pythonä¸­çš„Streamlitå¥—ä»¶é€²è¡Œï¼Œå¾åƒæ•¸è¨­å®š&gt;æª¢æ ¸æµç¨‹&gt;å ±è¡¨ç”¢è£½éƒ½äº¤çµ¦é›»è…¦\r\n\r\n\r\nä¸»è¦æ“ä½œç•«é¢\r\n\r\n\r\nåœ–1.Streamlit æ“ä½œä»‹é¢\r\n\r\nè¨ˆç®—ä¾æ“š\r\n\r\nä¸­åœ‹è¾²æ¥­å·¥ç¨‹æ‰‹å†Š-è¾²æ¥­æ°´åˆ©ä¹‹éƒ¨(ä¸‹ç¨±è¾²å·¥æ‰‹å†Š)\r\nè¾²ç”°æ°´åˆ©æœƒæŠ€è¡“äººå“¡è¨“ç·´æ•™æçŒæº‰æ’æ°´å·¥ç¨‹é¡åˆè¨‚æœ¬(ä¸‹ç¨±åˆè¨‚æœ¬)\r\n\r\n\r\nåŸºæœ¬åƒæ•¸\r\n\r\n\r\n\r\nåè©\r\nä»£è™Ÿ\r\næ•¸å€¼\r\nå–®ä½\r\n\r\n\r\n\r\n\r\nè¨ˆç•«æµé‡\r\nq\r\n{q}\r\ncms\r\n\r\n\r\næ›¼å¯§ä¿‚æ•¸\r\nn\r\n{n}\r\n\r\n\r\n\r\næ¸ å¯¬\r\nb\r\n{B}\r\nm\r\n\r\n\r\nå¡«è§’\r\nF\r\n{F}\r\nm\r\n\r\n\r\nå¡åº¦\r\ns\r\n1/{s}\r\n\r\n\r\n\r\n\r\n\r\nè¨ˆç®—éç¨‹\r\nç›¸é—œè¨ˆç®—å…¬å¼å¦‚ä¸‹:\r\n\\[ P = (b - 2 \\cdot F) + 2\r\n\\sqrt2 \\cdot F + 2 \\cdot (y - F) \\]\r\n\\[ A = b \\cdot y -  F ^2 \\]\r\n\\[ R = \\frac{A}{P} \\]\r\n\\[ V = \\frac{1}{n} \\cdot R^\\frac{2}{3}\r\n\\cdot s ^ \\frac{1}{2} \\]\r\n\\[ Q = A \\cdot V \\]\r\n\\[ Fr^2 = \\frac{Q^2T}{gA^3} \\]\r\n\r\n\r\n\r\nåè©\r\nä»£è™Ÿ\r\n\r\n\r\n\r\n\r\næ½¤å‘¨\r\nP\r\n\r\n\r\né€šæ°´é¢ç©\r\nA\r\n\r\n\r\næ°´åŠ›åŠå¾‘\r\nR\r\n\r\n\r\næµé€Ÿ\r\nV\r\n\r\n\r\næµé‡\r\nQ\r\n\r\n\r\n\r\n\r\nè¨ˆç®—çµæœ\r\næª¢ç®—ç­‰é€Ÿæµæ³\r\n\r\nè¨­è¨ˆæµé‡Qéœ€å¤§æ–¼è¨ˆç•«æµé‡q\r\n\r\nç¶“è©¦èª¤æ³•å¾Œå¾—åˆ°\r\n\r\n\r\n\r\nåè©\r\nä»£è™Ÿ\r\næ•¸å€¼\r\nå–®ä½\r\n\r\n\r\n\r\n\r\næ°´æ·±\r\ny\r\n{y}\r\nm\r\n\r\n\r\nè¨­è¨ˆæµé‡\r\nQ\r\n{Q}\r\ncms\r\n\r\n\r\næµé€Ÿ\r\nV\r\n{V}\r\nm/s\r\n\r\n\r\nç¦ç¥¿æ•¸\r\nFr\r\n{Fr}\r\n\r\n\r\n\r\n\r\n\r\næª¢ç®—è‡¨ç•Œæµæ³\r\n\r\nè¨­å®šæ¢ä»¶ç‚º Fr=1\r\n\r\nç¶“è©¦èª¤æ³•å¾Œå¾—åˆ°\r\n\r\n\r\n\r\nåè©\r\nä»£è™Ÿ\r\næ•¸å€¼\r\nå–®ä½\r\n\r\n\r\n\r\n\r\nè‡¨ç•Œæ°´æ·±\r\nyc\r\n{yc}\r\nm\r\n\r\n\r\nè‡¨ç•Œæµé€Ÿ\r\nVc\r\n{Vc}\r\nm/s\r\n\r\n\r\n\r\n\r\næ°´ç†ç‰¹æ€§æª¢è¨\r\næœ€å°å®¹è¨±æµé€Ÿ\r\n\r\næ°´è‰ç”Ÿé•·é€Ÿåº¦ 0.7 m/s\r\næ³¥æ²™æ·¤ç©é€Ÿåº¦\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\næœ€å°å®¹è¨±æµé€Ÿ(m/s)\r\n0.19\r\n0.30\r\n0.38\r\n0.45\r\n0.56\r\n0.65\r\n0.69\r\n0.70\r\n0.77\r\n0.82\r\n\r\n\r\n\r\n\r\næ°´æ·±\r\n0.3\r\n0.6\r\n0.9\r\n1.2\r\n1.5\r\n1.8\r\n2.1\r\n2.4\r\n2.7\r\n3.0\r\n\r\n\r\n\r\næœ€å¤§å®¹è¨±æµé€Ÿ\r\n\r\nè¾²å·¥æ‰‹å†Šå»ºè­°\r\n\r\n\r\n\r\n\r\næè³ª\r\næœ€å¤§å®¹è¨±æµé€Ÿ(m/s)\r\n\r\n\r\n\r\n\r\nåšæ··å‡åœŸ(&gt;18cm)\r\n3.00\r\n\r\n\r\nè–„æ··å‡åœŸ(&lt;10cm)\r\n1.50\r\n\r\n\r\n\r\n\r\næ’æ°´è·¯ã€é€€æ°´è·¯ã€å´æº¢é“ å¯ä»¥ä¹˜1.5å€é€²è¡Œåˆ†æ\r\n\r\n\r\nåˆè¨‚æœ¬å»ºè­°\r\n\r\n\r\n\r\n\r\næè³ª\r\næœ€å¤§å®¹è¨±æµé€Ÿ(m/s)\r\n\r\n\r\n\r\n\r\næ··å‡åœŸ\r\n4.00\r\n\r\n\r\n\r\n\r\nè€ƒé‡å‹•æ°´å£“åŠ›\r\næ‡‰é¿å…æ¥è¿‘è‡¨ç•Œæµé€Ÿ(æ°´é¢æ˜“èµ·æ¿€ç›ª)\r\nè¾²å·¥æ‰‹å†Šå»ºè­°:\r\n\\[ V_\\text &lt;\r\n\\frac23 V_c \\]\r\nåˆè¨‚æœ¬è¨ˆç®—ä¾‹(P.450)å»ºè­°:\r\n\\[ V_\\text &lt; 0.8\r\n\\cdot V_c \\]\r\n\r\nå‡ºæ°´é«˜åº¦æª¢æ ¸\r\nç‚ºè€ƒé‡ä»¥ä¸‹æƒ…æ³äºˆä»¥èª¿æ•´\r\n\r\næ¸ é“ç³™ç‡ä¿‚æ•¸ä¹‹è®Šå‹•\r\næµé€Ÿæ°´é ­è®Šæ›ç‚ºéœæ°´é ­æ°´é¢ä¹‹ä¸Šå‡\r\nå°æ°´é¢æ³¢å‹•ç­‰æ‰€éœ€å¢åŠ ä¹‹é«˜åº¦\r\n\r\nåˆè¨‚æœ¬å»ºè­°:\r\n\r\nè¨ˆç•«æœ€é«˜æ°´æ·±ä¹‹1/3(ä½†ä¸èƒ½å°‘æ–¼15cm)\r\né‡è¦æ¸ é“å¯å¢è‡³æœ€å¤§æ°´æ·±ä¹‹1/2\r\nå½æ›²è™•éœ€è€ƒé‡æ°´é¢è¶…é«˜\r\n\\[ F_b = \\frac{B \\cdot V^2}{g \\cdot r}\r\n\\]\r\n\r\nB=æ°´é¢å¯¬åº¦(m)\r\nr=å½æ›²åŠå¾‘(m)\r\ng=9.81\r\n\r\n\r\nè¾²å·¥æ‰‹å†Šå»ºè­°:\r\n\r\nç´”æŒ–æ¸ é“æˆ–å…§é¢å·¥æ¸ é“\r\nFb=0.05d+hv+(0.05~0.15)\r\nåº§æ§½æˆ–æ¸¡æ§½\r\nFb=0.07d+hv+(0.05~0.15)\r\næœ‰æ´ªæ°´æµå…¥æ™‚ æœ€å°Fb=0.1\r\næš—æ¸ åŠéš§é“ A,Bå–å¤§å€¼ (A)æŒ‰è¨ˆç•«æµé‡ä¼°ç®—\r\nd/D=0.80~0.83(ä½†è‡³å°‘ç‚º0.30m)\r\n(B)æœ‰æ´ªæ°´æµå…¥æ™‚ d/D=0.90~0.93\r\n\r\nd=æ°´æ·±=y\r\nD=æš—æ¸ é«˜åº¦æˆ–éš§é“ç›´å¾‘\r\n\r\n\r\n\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["Python","Streamlit","æ˜æ¸ è¨ˆç®—"]},{"title":"Streamlitæ‰“é€ å·¥ç¨‹ä¼°ç®—ç³»çµ±","url":"/posts/2910899188/","content":"å‰è¨€\r\n\r\nå·¥ç¨‹ä¼°ç®—ç‚ºæå ±è¨ˆç•«å‰çš„å¿…è¦å…§å®¹ï¼Œæ‰€æå ±çš„æ¦‚ä¼°ç¶“è²»é—œä¹æ–¼è¨ˆç•«æ ¸å®šå¾Œæ˜¯å¦æœƒé€ æˆå¯¦éš›æ‰€éœ€ç¶“è²»æ˜¯å¦è¶³å¤ ã€åŸ·è¡Œç‡æœƒä¸æœƒæœ‰å•é¡Œã€‚\r\n\r\nå·¥ç¨‹ä¼°ç®—æ–¹æ³•æœ‰å…©ç¨®:ææ–™åŠé¡åˆ¥\r\n\r\nææ–™æ˜¯å°‡å–®å…ƒæ‹†åˆ†ç‚ºé‹¼ç­‹ã€æ¨¡æ¿ã€æ··å‡åœŸ...ç­‰ç­‰å¯ä»¥å¾æ¨™æº–æ–·é¢è¨ˆç®—è€Œå¾—çš„å…§å®¹ã€‚\r\né¡åˆ¥æ˜¯å°‡å·¥ç¨‹æ‹†åˆ†ç‚ºæ¸ é“å·¥ç¨‹ã€é“è·¯å·¥ç¨‹ã€æ©‹æ¢å·¥ç¨‹...ç­‰å¯ä»¥æ˜ç¢ºåˆ†é¡çš„å…§å®¹ã€‚\r\n\r\næœ¬ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¤ è—‰ç”±é›²ç«¯ä»‹é¢çš„æ“ä½œä¾†é”æˆä»¥ä¸‹å¹¾é»éœ€æ±‚\r\n\r\nå·¥ç¨‹ä¼°ç®—æ–¹æ³•å°‡ä»¥å¾€çš„ææ–™å°å‘ç‚ºé¡åˆ¥ã€‚\r\nå„é¡åˆ¥å–®å…ƒå…§å®¹è¨ˆç®—ç”±ç¨‹å¼æ¥æ‰‹ï¼Œæ¸›å°‘äººåŠ›èª¿é…åƒæ•¸ã€‚\r\nè¼¸å‡ºå ±è¡¨æ¡ç”¨æœ€æ–°ç‰ˆæœ¬è™Ÿï¼Œé¿å…å„åœ°ç‰ˆæœ¬ä¸ä¸€é€ æˆå›°æ“¾ã€‚\r\næ‰‹æ©Ÿä¹Ÿèƒ½åœ¨å·¥å€ç¾å ´ç²å¾—ç¶“è²»ä¼°ç®—æˆæœã€‚\r\n\r\n\r\nå·¥ç¨‹ä¼°ç®—æ–¹æ³•\r\nå·¥ç¨‹ä¼°ç®—æ–¹æ³•ä¸åŒæ˜¯ç›®å‰åœ¨è™•ç†è¨ˆç•«æå ±æ™‚å¸¸å¸¸é€ æˆæå ±ç¶“è²»èˆ‡å¯¦éš›ç¶“è²»æœ‰è½å·®çš„ä¸»å› ï¼Œç¶“æŸ¥ç™¼ç¾åŸä¾†æ˜¯å¤§å¤šæ•¸äººéƒ½ç”¨ææ–™ä½œç‚ºå“é …è€Œéç”¨å·¥ç¨‹é¡åˆ¥ä½œç‚ºå“é …ï¼Œå°è‡´åœ¨ä¼°ç®—éç¨‹å®¹æ˜“å¿½ç•¥é“è·¯é‹ªé¢ã€æ“‹åœŸè¨­æ–½é€™é¡å…§å®¹ã€‚\r\nä¼°å¤ªå°‘\r\nè¨­è¨ˆéç¨‹æœƒéœ€è¦æ±æ‰£è¥¿æ‰£ï¼Œç‚ºäº†ä¸»é«”å·¥ç¨‹èƒ½å¤ æ”¶å°¾å¿…é ˆè¦æ¨æ£„æ‰æŸäº›ä¹Ÿæ˜¯å¾ˆé‡è¦çš„é …ç›®ã€‚\r\nä¼°å¤ªå¤š\r\næœƒè¢«æª¢è¨ç‚ºä»€éº¼ç•¶åˆé»‘ç™½ä¼°é€ æˆåŸ·è¡Œç‡ä¸é«˜ï¼Œå¾ˆå¤šäººéƒ½æ˜¯å› ç‚ºè¢«åˆé›£éç¶“è²»ä¸èƒ½è¶…éä¸Šé™ï¼Œæ‰€ä»¥å°±çµ¦ä»–ç”¨åŠ›ä¼°ä¸‹å»ï¼Œé€ æˆé€™æ¨£çš„çµæœã€‚\r\né¡åˆ¥è¨ˆç®—å…§å®¹\r\næ¸ é“å·¥ç¨‹ã€ç‰ˆæ©‹å·¥ç¨‹\r\n\r\nçµ¦å®šæ¸ é“é•·å¯¬åŠé•·åº¦ï¼Œå›æ¨ç‰†åšåŠæ‰€éœ€é‹¼ç­‹\r\nçµ¦å®šç‰ˆæ©‹é•·å¯¬åŠåº§æ•¸ï¼Œå›æ¨ç‰ˆåšåŠæ‰€éœ€é‹¼ç­‹\r\n\r\næ“‹åœŸç‰†\r\n\r\næ‡¸è‡‚å¼æ“‹åœŸç‰†\r\né‡åŠ›å¼æ“‹åœŸç‰†\r\n\r\né“è·¯å·¥ç¨‹ã€ç‰ˆæ¨å·¥ç¨‹\r\nåˆ†ç‚ºACã€å†ç”ŸACã€ç¢çŸ³ç´šé…ã€CLSMçš„å„ç¨®æ’åˆ—çµ„åˆï¼Œé€éæ–°å¢çš„æ–¹å¼ä¾†é€è¡Œå¢åŠ ï¼Œä¹Ÿå¯ä»¥é€²è¡Œåˆªé™¤ã€‚\r\né›œé …åŠå…¶ä»–\r\nå°‡å‰è¿°å…§å®¹åŠ ç¸½å¾Œä¹˜ä¸Šé›œé …è²»ç”¨ä¿‚æ•¸(é è¨­ç‚º0.1)\r\né–“æ¥è²»ç”¨\r\nç‚ºå‰å¹¾é …çš„åŠ ç¸½å¾Œä¹˜ä¸Šé–“æ¥è²»ç”¨ä¿‚æ•¸(é è¨­ç‚º0.3)ï¼Œé€™éƒ¨åˆ†åŒ…å«è·å®‰ã€ç’°ä¿ã€å» å•†åˆ©æ½¤ã€å·¥ç¨‹ç®¡ç†è²»ç­‰\r\nè¼¸å‡ºå ±è¡¨\r\nå·¥ä½œæ™‚å¦‚æœ‰éœ€è¦è¼¸å‡ºå ±è¡¨çš„æ™‚å€™ï¼Œä¸å¤–ä¹æœƒæ¡ç”¨wordæˆ–è€…excelä¹‹é¡çš„å·¥å…·ï¼Œç•¶ç‰ˆæœ¬æœ‰æ›´æ–°çš„æ™‚å€™æœƒéœ€è¦è«‹åŒäº‹é‡æ–°ä¸‹è¼‰ä½¿ç”¨ï¼Œä¸¦åœ¨å ±è¡¨çš„æŸè™•å£“ä¸€å€‹ç‰ˆæœ¬è™Ÿä½œç‚ºè¾¨è­˜ï¼Œç„¶è€Œå¾€å¾€é ’å¸ƒé©ç”¨çš„æ™‚å€™ï¼Œé‚„æ˜¯æœƒæœ‰ä¸å°‘åŒäº‹ä»¥èˆŠçš„ç‰ˆæœ¬æé€å ±è¡¨ã€‚\r\nç‚ºè§£æ±ºä¸Šè¿°ç‰ˆæœ¬å·®ç•°å•é¡Œï¼Œé€™æ¬¡é¸æ“‡åˆ©ç”¨é›²ç«¯ç¶²é ä½œç‚ºå¯åŠæ™‚æ›´æ–°çš„å ±è¡¨è¼¸å‡ºåª’ä»‹ï¼Œä¸€æ—¦è¨ˆç®—è¦å‰‡æ”¹è®Šæˆ–å ±è¡¨æ ¼å¼è®ŠåŒ–å°±èƒ½å¤ åœ¨åŒäº‹è¼¸å…¥å®ŒåŸºæœ¬è³‡æ–™ä¹‹å¾Œï¼Œç¢ºä¿è¼¸å‡ºçš„å…§å®¹æœƒæ˜¯æ­£ç¢ºç‰ˆçš„ã€‚\r\nå¯¦ä½œæˆæœ\r\n\r\n\r\nç³»çµ±æ“ä½œæµç¨‹\r\n\r\n\r\n\r\n\r\nå·¥ç¨‹åŸºæœ¬è³‡æ–™\r\n\r\n\r\n\r\n\r\nå·¥ç¨‹æ–½ä½œä½ç½®\r\n\r\n\r\n\r\n\r\nå·¥ç¨‹å…§å®¹æ¦‚è¦\r\n\r\n","categories":["å°ˆæ¡ˆæˆæœ"],"tags":["Streamlit"]},{"title":"ç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-å¼•ç”¨ä¾†æº","url":"/posts/3212778286/","content":"ğŸ™Œå‰è¨€\r\nå·¥ç¨‹åƒ¹æ ¼è³‡æ–™åº«ä½œæ¥­è¾¦æ³•æœ‰æ˜å®šï¼Œæ–°å°å¹£1000è¬å…ƒä»¥ä¸Šä¹‹å…¬å…±å·¥ç¨‹æ–¼æ±ºæ¨™æ—¥èµ·30æ—¥å…§å¿…é ˆå°‡è³‡æ–™å‚³è¼¸åˆ°ä¸»ç®¡æ©Ÿé—œï¼Œè³‡æ–™å…§å®¹:\r\n\r\nå¾—æ¨™å» å•†ä¹‹å¥‘ç´„å–®åƒ¹\r\nç¶“æ©Ÿé—œæ ¸å®šä¹‹é ç®—å–®åƒ¹\r\nå…¶ä»–ç¶“ä¸»ç®¡æ©Ÿé—œæŒ‡å®šè€…\r\n\r\nåŒ…å«è©³ç´°åƒ¹ç›®è¡¨ã€å–®åƒ¹åˆ†æè¡¨åŠè³‡æºçµ±è¨ˆè¡¨ã€‚\r\næœ€å®¹æ˜“é”æˆçš„æ–¹å¼ä¾¿æ˜¯é€éå…¬å…±å·¥ç¨‹ç¶“è²»é›»è…¦ä¼°åƒ¹ç³»çµ±(PCCES)é€²è¡Œé ç®—æ›¸èˆ‡å¥‘ç´„ç·¨åˆ¶ã€‚\r\nå› ç‚ºå¤§å®¶éƒ½ä½¿ç”¨åŒä¸€å¥—ç³»çµ±ï¼Œé‚£éº¼è¼¸å‡ºæ ¼å¼å°±èƒ½å¤ é€šç”¨ï¼Œå¾ŒçºŒè¦å°‡å¥‘ç´„å…§å®¹å½™æ•´åˆ°å…¬å¸å…§éƒ¨æ‰€é–‹ç™¼çš„å ±è¡¨ç³»çµ±åªéœ€è¦åšä¸€æ¬¡å·¥å°±å¯ä»¥äº†ï¼Œç„¶è€Œéå…¬å…±å·¥ç¨‹çš„å…§å®¹æœƒå°±å› ç‚ºå€‹æ¡ˆä¸åŒè€Œéœ€è¦åšç´°å¾®èª¿æ•´ã€‚\r\n\r\nğŸ“”é ç®—æ›¸ç¯„ä¾‹\r\nä¸€èˆ¬åœ¨å…¬å…±å·¥ç¨‹è¨­è¨ˆéšæ®µï¼Œéœ€è¦è£½ä½œä»¥ä¸‹è¡¨æ ¼\r\n\r\né ç®—ç¸½è¡¨\r\né ç®—è©³ç´°è¡¨\r\né ç®—å–®åƒ¹åˆ†æè¡¨\r\né ç®—è³‡æºçµ±è¨ˆè¡¨(ä¸€å®šè¦æ¨¡æ‰è¦)\r\n\r\næ‰¿æ”¬å» å•†å¾—æ¨™å¾Œï¼Œå¥‘ç´„é …ç›®ã€æ•¸é‡ã€å–®ä½åŸºæœ¬ä¸ŠæœƒæŒ‰ç…§è¨­è¨ˆéšæ®µå…§å®¹ï¼Œåƒ…å–®åƒ¹éƒ¨åˆ†æœƒä¾ç…§æ¨™æ¯”é€²è¡Œèª¿æ•´ã€‚\r\n\r\næˆç«‹å¥‘ç´„å¾Œæ‰€å¾—åˆ°çš„å…§å®¹ä¾¿æ˜¯å¾ŒçºŒè¾¦ç†æ•¸é‡å¡«å¯«ã€è®Šæ›´è¨­è¨ˆã€ä¼°é©—è¨ˆåƒ¹ç­‰ç¨‹åºçš„ä¾æ“šã€‚\r\n\r\nå…¬å…±å·¥ç¨‹\r\nå¤§å¤šéƒ½æ˜¯æ¡ç”¨å…¬å…±å·¥ç¨‹ç¶“è²»é›»è…¦ä¼°åƒ¹ç³»çµ±(PCCES)é€²è¡Œï¼Œä»¥ç·¨ç¢¼æ­£ç¢ºç‡40%ç‚ºæ¨å‹•ç›®æ¨™ä¸¦åŠ ä»¥åˆ—ç®¡ï¼Œè‹¥æ˜¯ç”¨å‰äººç•™ä¸‹ä¾†çš„Excelé€²è¡Œæ¨¡ä»¿ï¼Œé€šå¸¸éƒ½æ¯”è¼ƒæœƒé›£ä»¥é”æˆæœ€ä½ç·¨ç¢¼æ­£ç¢ºç‡çš„è¦æ±‚ï¼Œå»ºè­°é‚„æ˜¯å­¸ç¿’PCCESå¦‚ä½•ä½¿ç”¨æ¯”è¼ƒå¥½ã€‚\r\nåœ¨å°‡é …ç›®ç§»è½‰è‡³å…§éƒ¨å ±è¡¨çš„éç¨‹ï¼Œæœƒé‡åˆ°æ¬„ä½åç¨±æ¯”è¼ƒé•·çš„å‡ºç¾è·³åˆ—çš„æƒ…æ³ï¼Œæ­¤æ™‚è¦å°‡é …ç›®æ¬ç§»è‡³å…§éƒ¨å ±è¡¨ç³»çµ±æ™‚æœƒéœ€è¦åšå…ˆè¡Œè™•ç†ï¼Œå¦å‰‡æœƒæœ‰é …ç›®åç¨±ä¸å®Œæ•´çš„ç‹€æ³ï¼Œè€Œé€™é€šå¸¸æœƒåœ¨æ—¥å¾Œæœƒå‡ºç¾ä¸€äº›å•é¡Œï¼Œå…ˆè¡Œè™•ç†é›–ç„¶éº»ç…©ä½†é‚„æ˜¯ä¸å¯å…ã€‚\r\n\r\n\r\nFig2.å¥‘ç´„é …ç›®è·³åˆ—\r\n\r\néå…¬å…±å·¥ç¨‹\r\néå…¬å…±å·¥ç¨‹é›–ç„¶æœªå¼·åˆ¶è¦æ±‚ç·¨ç¢¼æ­£ç¢ºç‡ï¼Œå› æ­¤æ‰€è¼¸å‡ºçš„é ç®—æ›¸æ ¼å¼æ¯”è¼ƒæœƒåƒå¥‡ç™¾æ€ªï¼Œä½†é€šå¸¸ä¹Ÿæ˜¯ä¸è„«é›¢å…¬å…±å·¥ç¨‹çš„åŸºæœ¬æ¦‚å¿µï¼Œæœ‰é—œå¥‘ç´„ç¸½è¡¨ã€å¥‘ç´„è©³ç´°è¡¨ã€å¥‘ç´„å–®åƒ¹åˆ†æè¡¨é€šå¸¸éƒ½æœƒå‡ºç¾ã€‚\r\nåœ¨å°‡é …ç›®ç§»è½‰è‡³å…§éƒ¨å ±è¡¨çš„éç¨‹ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥ç”¨æ‰‹å‹•çš„æ–¹å¼æŠŠè³‡æ–™PASSåˆ°å…§éƒ¨å ±è¡¨ç³»çµ±ä¸Šé¢ï¼Œä½†è‹¥åƒæ˜¯å»ºç¯‰å·¥ç¨‹æœ‰å¹¾ç™¾å¹¾åƒé …çš„ï¼Œå»ºè­°é€éVBAé€²è¡Œè™•ç†æœƒæ¯”è¼ƒç†æƒ³ï¼Œåªè¦æ˜¯Excelæ‡‰è©²éƒ½æœ‰æ©Ÿæœƒæ‰¾å‡ºç·¨è£½çš„è„ˆçµ¡é€²è¡Œç¨‹å¼æ’°å¯«ï¼Œé€™å°±éœ€è¦çœ‹å€‹æ¡ˆè€Œå®šï¼Œæ‰¾å‡ºå¥‘ç´„ä¸Šçš„è¦å¾‹ï¼Œé€éè¿´åœˆã€åˆ¤åˆ¥å¼ä¸€ä¸€æ‰¾å‡ºè„ˆçµ¡ä¸¦é€²è¡Œé …ç›®èƒå–ã€‚\r\nå¥‘ç´„é …ç›®\r\nåœ¨ç›£é€ å ±è¡¨ä¸Šè¦åŸ·è¡Œæ•¸é‡è¨ˆç®—æ™‚ï¼Œç‚ºæ§åˆ¶å ±è¡¨é•·åº¦ï¼Œé€šå¸¸æœƒä»¥å¥‘ç´„è©³ç´°è¡¨ä¸­çš„å…§å®¹ç‚ºä¸»ï¼Œå…¶ä¸­æœƒæœ‰ä»¥ä¸‹å¹¾ç¨®å‹æ…‹\r\n\r\nå¯é‡åŒ–å‹æ…‹\r\n\r\né‹¼ç­‹(Unit=T)ã€æ¨¡æ¿(Unit=m2)ã€æ··å‡åœŸ(Unit=m3)...ç­‰å…·å‚™æ˜ç¢ºå–®ä½ã€å¯è¢«é‡åŒ–ä¸”ç·¨åˆ—æ–¼è©³ç´°è¡¨ä¸Šçš„å…§å®¹\r\n\r\nä¸€å¼å‹æ…‹\r\n\r\nå› ç‰¹å®šå·¥ç¨‹é …ç›®ä¹‹åƒ¹æ ¼æˆ–æ•¸é‡ç·¨åˆ—ä¸æ˜“ï¼Œç„¡æ³•ä»¥æ˜ç¢ºå–®ä½åŠ ä»¥è¨ˆé‡ï¼Œé›£ä»¥ä¼°è¨ˆçš„å…§å®¹æœƒä»¥æ¦‚ä¼°çš„æ–¹å¼çµ¦å®šä¸€å¼çš„è²»ç”¨ï¼Œä¾‹å¦‚æ“‹æŠ½æ’æ°´è²»\r\n\r\nç™¾åˆ†æ¯”å‹æ…‹\r\n\r\nç’°å¢ƒä¿è­·è²»ã€è·æ¥­å®‰å…¨è¡›ç”Ÿè²»ã€å“ç®¡ä½œæ¥­è²»ã€å» å•†ç®¡ç†è²»ã€ç‡Ÿæ¥­ç¨…...ç­‰ï¼Œä¾æ“šé ç®—ç·¨åˆ—å…§å®¹å¾Œç¶“æ›ç®—æ¯”ä¾‹è€Œå¾—åˆ°çš„è²»ç”¨ã€‚\r\nåŒ¯å…¥å…§å®¹\r\nXML\r\nPCCESå¯ä»¥è¼¸å‡ºXMLæˆ–XLS\r\nXMLæ˜¯ä¸€ç¨®åŠçµæ§‹åŒ–è³‡æ–™ï¼Œä»¥&lt;...&gt;é–‹å§‹ã€&lt;/...&gt;çµæŸï¼Œä¸­é–“æ‰€å¤¾çš„å…§å®¹æœ‰å±¬æ€§(attribute)è·Ÿæ–‡å­—(text)ï¼Œå±¬æ€§ç‚ºä¸€å¥å€¼å°ï¼Œå¯é‡å°å±¬æ€§å€¼é€²è¡Œæ“ä½œï¼Œä¹Ÿå¯é‡å°æ–‡å­—é€²è¡Œä½¿ç”¨ã€‚\r\n\r\nç¯€éŒ„è‡ªPCCESç”¢å‡ºçš„XMLæª”æ¡ˆ\r\n\r\n&lt;PayItem itemKey=&quot;7&quot; itemNo=&quot;ä¸€&quot; refItemCode=&quot;       &quot; itemKind=&quot;mainItem&quot;&gt;        &lt;Description language=&quot;zh-TW&quot;&gt;ä¸»é«”å·¥ç¨‹&lt;/Description&gt;        &lt;Description language=&quot;en&quot;&gt;&lt;/Description&gt;        &lt;Unit language=&quot;zh-TW&quot;&gt;          &lt;/Unit&gt;        &lt;Unit language=&quot;en&quot;&gt;          &lt;/Unit&gt;        &lt;Quantity&gt;1&lt;/Quantity&gt;        &lt;Price fixed=&quot;false&quot; calculateDecimal=&quot;0&quot;&gt;11824021&lt;/Price&gt;        &lt;Amount fixed=&quot;true&quot; calculateDecimal=&quot;0&quot;&gt;11824021&lt;/Amount&gt;        &lt;Remark&gt;[ç™¼åŒ…]&lt;/Remark&gt;        &lt;Percent&gt;0&lt;/Percent&gt;        &lt;PayItem itemKey=&quot;15&quot; itemNo=&quot;1&quot; refItemCode=&quot;02300C00\r\nXLS\r\nXLSå°±æ˜¯æŒ‡Excelçš„æ´»é ç°¿ï¼Œå¤§å®¶æ‡‰è©²å¾ˆå¸¸è¦‹ï¼Œä¸å¤šåšè§£é‡‹ã€‚\r\nPCCESå¥‘ç´„é …ç›®å¾Œè™•ç†\r\nè·Ÿçœ¾å¤šç¶²å‹äº¤æµä¸‹ä¾†ï¼Œç™¼ç¾æœ€å¤šäººåœ¨ä½¿ç”¨ç›£é€ å ±è¡¨VBAæˆ–æ–½å·¥æ—¥èªŒVBAæ™‚éƒ½æ˜¯å¡åœ¨å¥‘ç´„é …ç›®çš„å»ºç«‹ï¼Œç•¶å¥‘ç´„é …ç›®ç„¡æ³•æ­£å¸¸å»ºç«‹æ™‚ï¼Œç¢ºå¯¦å°æ–¼æ•´å€‹å ±è¡¨å°±æœƒæ˜¯ä¸€å¤§é˜»ç¤™ï¼Œå› æ­¤æˆ‘é‡å°å…¬å…±å·¥ç¨‹çš„é ç®—æ›¸æœ‰åšäº†ä¸€å€‹å¾Œè™•ç†çš„è½‰æ›å·¥å…·(XMLåˆ°XLS)ï¼Œä¹‹å¾Œå†å°‡è½‰æ›æ‰€å¾—çš„è³‡æ–™è²¼åˆ°è‡ªè¨‚çš„VBAå·¥å…·å³å¯æ­£å¸¸ä½¿ç”¨ã€‚\r\nè©³æƒ…è«‹åƒè€ƒ ExcelVBA@PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†å·¥å…·\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","ç›£é€ å ±è¡¨"]},{"title":"ç›£é€ å ±è¡¨è¦åŠƒ-æ•¸é‡è¨ˆç®—","url":"/posts/1952534825/","content":"ğŸ™Œå‰è¨€\r\nå¥‘ç´„é …ç›®ã€å–®åƒ¹ã€æ•¸é‡ã€å–®ä½æ˜¯æ•´å€‹å·¥ç¨‹é€²è¡Œä¸­çš„æ•¸é‡è¨ˆç®—æ ¸å¿ƒã€‚\r\nå¥‘ç´„é …ç›®çš„èµ·æºæ–¼è¨­è¨ˆéšæ®µæœƒæˆç«‹é ç®—æ›¸ä¾¿é–‹å§‹ï¼Œæ‹›æ¨™éšæ®µæœƒä»¥æ¨™å–®çš„å½¢å¼è®“å» å•†é€²è¡Œå¡«åˆ—æŠ•æ¨™ï¼Œæ±ºæ¨™æ™‚å†ä»¥æ¨™æ¯”èª¿æ•´å¥‘ç´„å–®åƒ¹ï¼Œçˆ¾å¾Œæˆç«‹å¥‘ç´„å¾Œä¾¿ä»¥æ­¤ç•¶è¨ˆåƒ¹ä¾æ“šã€‚\r\nå·¥ç¨‹é€²è¡Œè¦åšåˆ°å®Œå…¨ä¸è®Šæ›´è¨­è¨ˆå¯¦åœ¨ç›¸ç•¶å›°é›£ï¼Œå› ç‚ºç¾å ´æ¢ä»¶æ”¹è®Šã€å±…æ°‘ç‰¹æ®Šéœ€æ±‚ã€ç”šè‡³ç·¨åˆ¶é ç®—æ›¸çš„éŒ¯èª¤æœªè¢«ç™¼ç¾éƒ½å¯èƒ½å°è‡´è®Šæ›´è¨­è¨ˆçš„ç™¼ç”Ÿï¼Œæ­¤æ™‚è®Šæ›´è¨­è¨ˆéœ€æ±‚é …ç›®æ²’æœ‰åˆ—æ–¼å¥‘ç´„é …ç›®ï¼Œå‰‡æœƒä¼´éš¨æ–°å¢é …ç›®æ–°å¢å–®åƒ¹ç¨‹åºåŒæ­¥é€²è¡Œã€‚\r\nå·¥ç¨‹åŸ·è¡Œä¸€å®šæ¯”ä¾‹å¾Œï¼Œå» å•†å¯æå‡ºä¼°é©—è¨ˆåƒ¹ï¼Œæ­¤æ™‚ä¹Ÿæ˜¯ä»¥ç•¶æœŸå¥‘ç´„é …ç›®ã€å–®åƒ¹ã€å¯¦éš›æ•¸é‡ä½œç‚ºä»˜æ¬¾ä¾æ“šï¼Œé…åˆç´¯ç©é€²åº¦ç›¸äº’å‹¾ç¨½ï¼Œé¿å…è¶…ä¼°ç™¼ç”Ÿã€‚\r\n\r\nğŸ“”å¼•ç”¨ä¾†æº\r\nå…¬å…±å·¥ç¨‹æ‰€ä½¿ç”¨çš„PCCESå¯ä»¥ç”ŸæˆXMLæˆ–XLSï¼Œå¯ä»¥é€éVBAçš„æ–¹å¼åŒ¯å…¥æˆç›£é€ å ±è¡¨çš„å¥‘ç´„é …ç›®ï¼Œåœ¨å¼•å…¥éç¨‹ä¸­ï¼Œå°æ–¼ç›£é€ å ±è¡¨ä¸­çš„å¥‘ç´„é …ç›®æ¬„ä½è¦åŠƒï¼Œéœ€è¦ç‰¹åˆ¥æ³¨æ„çµæ§‹æ€§èˆ‡æ“´å……æ€§æ‰æœƒæ–¹ä¾¿ä½œæ¥­ã€‚\r\nå¥‘ç´„é …ç›®æ¬„ä½è¦åŠƒ\r\n\r\nçµæ§‹æ€§\r\n\r\nåœ¨è³‡æ–™åº«çš„è¨­è¨ˆä¸Šæœ‰æ‰€è¬‚æ­£è¦åŒ–çš„æ¦‚å¿µï¼Œå„²å­˜æ ¼ä»¥æ¯æ ¼å­˜æ”¾ä¸€å€‹è³‡æ–™ç‚ºåŸå‰‡ï¼Œé¿å…è·¨æ ¼åˆä½µçš„æ–¹å¼é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œé€šå¸¸è³‡æ–™åº«åªç´€éŒ„æ–‡å­—å…§å®¹è€Œå·²ï¼Œåœ–ç‰‡æˆ–æª”æ¡ˆå‰‡ç´€éŒ„å¤–éƒ¨é€£çµè·¯å¾‘æ›¿ä»£ã€‚\r\n\r\næ“´å……æ€§\r\n\r\nå·¥ä½œè¡¨å‰‡æ˜¯ä»¥ä¸åŒé¡åˆ¥åšæ‹†åˆ†ï¼Œä¾‹å¦‚:å¥‘ç´„é …ç›®ã€æ–½ä½œæ•¸é‡ã€è©¦é©—çµ±è¨ˆã€åŸºæœ¬è³‡æ–™æ”¾æ–¼ä¸åŒå·¥ä½œè¡¨ï¼Œå„å·¥ä½œè¡¨ç”±ä¸Šè€Œä¸‹ç™¼å±•ï¼Œä»¥ç¬¬ä¸€åˆ—ç‚ºè¡¨é ­é€²è¡Œè¨˜éŒ„ã€‚(å¦‚æœè¦æ”¾ç½®æŒ‰éˆ•å‰‡å¦ç•¶åˆ¥è«–)\r\n\r\n\r\nFig1.é ç®—è©³ç´°è¡¨ç¯„ä¾‹\r\n\r\nğŸš¸é€²åº¦ä¾æ“š\r\nå·¥åœ°ç¾å ´æœƒæœ‰ç•¶æ—¥æ–½ä½œé …ç›®ï¼Œæ–½å·¥å» å•†æœƒå¦è£½ä½œä¸€ä»½æ–½å·¥æ—¥èªŒåŠè‡ªä¸»æª¢æŸ¥è¡¨ï¼Œé”æŠ½æŸ¥é »ç‡æ™‚æœƒæå‡ºæª¢é©—åœç•™é»ç”³è«‹å–®æœƒåŒç›£é€ å‰å¾€æŠ½æŸ¥ï¼Œä¸¦å°‡å·²æŠ½æŸ¥å®Œæˆçš„æ•¸é‡å¡«å ±ä¸Šå»ç›£é€ æ—¥å ±ä½œç‚ºæ–½ä½œæ•¸é‡ï¼Œæ­¤æ™‚çš„æ•¸é‡å‰‡ç‚ºæ›ç®—å¯¦éš›é€²åº¦çš„ä¾æ“šã€‚\r\nç•¶åˆåœ¨é ç®—æ›¸éšæ®µæ™‚ä»¥æ¯”ä¾‹è¨ˆç®—ä¹‹é …ç›®å‰‡æ­¸é¡ç‚ºç™¾åˆ†æ¯”é …ç›®(è·æ¥­å®‰å…¨ã€ç’°å¢ƒä¿è­·ã€å“ç®¡ä½œæ¥­è²»ã€å» å•†åˆ©æ½¤ã€ç‡Ÿæ¥­ç¨…)ï¼Œæœƒä¾ç…§ç•¶åˆåœ¨æ›ç®—æ¯”ä¾‹æ™‚çš„å¥‘ç´„é …ç›®ä¹‹å¯¦ä½œæ•¸é‡å å¥‘ç´„æ•¸é‡ä¹‹é‡‘é¡æ¯”ä¾‹å¡«å¯«ã€‚\r\n\r\nEX:ç’°å¢ƒä¿è­·è²»ç”¨æœƒä¾(ä¸»é«”å·¥ç¨‹+é›œé …å·¥ç¨‹)ä¹‹å¯¦ä½œé‡‘é¡/(ä¸»é«”å·¥ç¨‹+é›œé …å·¥ç¨‹)ä¹‹å¥‘ç´„é‡‘é¡å¡«åˆ—\r\n\r\n\r\n\r\nFig2.ç™¾åˆ†æ¯”é …ç›®ç¯„ä¾‹\r\n\r\nâœ‚ï¸è®Šæ›´è¨­è¨ˆ\r\nç•¶å·¥ç¨‹éœ€è¦æ”¹å‹•å¥‘ç´„é …ç›®æˆ–æä¾›æ–°çš„å¥‘ç´„é …ç›®æ™‚ï¼Œæœƒè¾¦ç†è®Šæ›´è¨­è¨ˆæˆ–æ–°å¢é …ç›®æ–°å¢å–®åƒ¹ï¼Œæå ±æ¦‚ä¼°è¡¨åŠè®Šæ›´è¨­è¨ˆé ç®—æ›¸ä¾†å®Œæˆè®Šæ›´è¨­è¨ˆæµç¨‹ï¼Œå¦‚æœ‰æ–°å¢å¥‘ç´„é …ç›®æ™‚å‰‡é ˆå…ˆè¡Œè¾¦ç†æ–°å¢é …ç›®æ–°å–®åƒ¹ã€‚\r\nè‹¥é ç®—æ›¸éšæ®µæœ‰å…ˆæ•˜æ˜ï¼Œå¯¦ä½œæ•¸é‡è¨ˆåƒ¹å‰‡æœƒåœ¨å·¥ç¨‹å®Œå·¥å‰è¾¦ç†ä¸€æ¬¡ä¿®æ­£é ç®—ï¼Œä¾ç…§å¥‘ç´„é …ç›®å¡«åˆ—å¯¦ä½œæ•¸é‡ç­‰å€™ç«£å·¥çµç®—ï¼Œè‹¥å·²ç¶“æœ‰ç™¼ç”Ÿè®Šæ›´è¨­è¨ˆï¼Œå‰‡å¾ŒçºŒçš†å·²è®Šæ›´è¨­è¨ˆç¨‹åºé€²è¡Œï¼Œä¸å†ä»¥ä¿®æ­£é ç®—ç¨‹åºè¾¦ç†ã€‚\r\nåŒæ™‚æœƒéœ€è¦ä¾ç…§è®Šæ›´å‰å¾Œçš„æ•¸é‡å·®ç•°ã€é‡‘é¡å·®ç•°å¦è£½æˆè®Šæ›´è¨­è¨ˆç¸½è¡¨ã€è®Šæ›´è¨­è¨ˆæ˜ç´°è¡¨ï¼Œé€™äº›å ±è¡¨å…§å®¹éƒ½æ˜¯èˆ‡å¥‘ç´„é …ç›®ã€å–®åƒ¹æœ‰å¾ˆé«˜çš„é—œè¯æ€§ã€‚\r\n\r\n\r\nFig3.è®Šæ›´è¨­è¨ˆä»‹é¢\r\n\r\nğŸ’°ä¼°é©—è¨ˆåƒ¹\r\nå·¥ç¨‹åŸ·è¡Œä¸€å®šæ¯”ä¾‹å¾Œï¼Œå» å•†å¯ä»¥æå‡ºä¼°é©—è¨ˆåƒ¹ä¾†æ”¯ä»˜å·¥ç¨‹æ¬¾ï¼Œç›£é€ æ­¤æ™‚éœ€è¦å°ç…§å¥‘ç´„é …ç›®ã€æ•¸é‡ã€å–®åƒ¹ï¼Œä¼°é©—æ•¸é‡ä¸å¾—è¶…éæ—¥å ±æ–½ä½œæ•¸é‡ï¼Œä¸¦ä¸”ç´¯ç©ä¼°é©—é€²åº¦äº¦ä¸å¾—è¶…éç´¯ç©å¯¦éš›é€²åº¦ã€‚\r\néœ€è¦ä¾ç…§è©²æœŸåˆ¥çš„å·¥ç¨‹ä¼°é©—å…§å®¹å¦è£½æˆå·¥ç¨‹ä¼°é©—ç¸½è¡¨ã€å·¥ç¨‹ä¼°é©—è©³ç´°è¡¨ï¼Œé€™äº›å ±è¡¨å…§å®¹ä¹Ÿéƒ½æ˜¯èˆ‡å¥‘ç´„é …ç›®ã€å–®åƒ¹æœ‰å¾ˆé«˜çš„é—œè¯æ€§ã€‚\r\n\r\n\r\nFig4.ä¼°é©—è¨ˆåƒ¹ä»‹é¢\r\n\r\nğŸé–‹ç™¼ä¸­é‡éçš„å°å•é¡Œ\r\n\r\nå¼•å…¥é …ç›®æ™‚å¼•åˆ°é‡è¦†é …ç›®\r\nå¯¦éš›é€²åº¦çš„è¨ˆç®—åˆ†æ¯éœ€å°‡å» å•†åˆ©æ½¤ã€ç‡Ÿæ¥­ç¨…é€²è¡Œæ’é™¤\r\nè®Šæ›´è¨­è¨ˆæœªå°‡è©¦é©—æ•¸é‡åŒæ­¥è®Šæ›´\r\nè®Šæ›´è¨­è¨ˆå¾Œé€²åº¦ä¸å‡åé™\r\nä¼°é©—è¨ˆåƒ¹çš„ä»¥å‰ä¼°é©—åƒ¹å€¼å› ç‚ºè®Šæ›´è¨­è¨ˆè€Œæ›´å‹•\r\n\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","ç›£é€ å ±è¡¨"]},{"title":"ç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-æ•¸é‡å¡«å¯«","url":"/posts/2699779571/","content":"ğŸ™Œå‰è¨€\r\nç›£é€ å ±è¡¨çš„æ•¸é‡å¡«å¯«ç‚ºæ–½å·¥ç´€éŒ„æ™‚æœ€é‡è¦çš„åŸºæœ¬åŠŸï¼Œå¡«å¯«æ–¹å¼å¯åˆ†ç‚ºä»¥å„²å­˜æ ¼å¡«å¯«ã€ä½¿ç”¨è€…è¡¨å–®å¡«å¯«ï¼Œå¦‚æœæŒç®¡å·¥åœ°ç¾å ´çš„å·¥åœ°ä¸»ä»»å°è³‡è¨Šæ¯”è¼ƒä¸äº†è§£çš„ï¼Œä¹Ÿå¾ˆæœ‰å¯èƒ½æœƒå°‡å…§å®¹å¯«åœ¨ç´™æœ¬æˆ–ç™½æ¿ä¸Šæ‹ç…§ä¸Šå‚³ç¾¤çµ„å›å ±ï¼Œå†ç”±å…§æ¥­å·¥ç¨‹äººå“¡é€²è¡Œè³‡æ–™ç™»æ‰“ï¼Œç„¡è«–å“ªç¨®æ–¹å¼ï¼Œå¡«å¯«å…§å®¹éƒ½é‚„æ˜¯ä»¥å¥‘ç´„é …ç›®ç‚ºä¾æ“šï¼Œåªåœ¨æ•¸é‡éƒ¨åˆ†åšç¢ç£¨è€Œå·²ã€‚\r\nå¥‘ç´„é …ç›®ä»¥å¯é‡åŒ–å‹æ…‹ã€ä¸€å¼å‹æ…‹ã€ç™¾åˆ†æ¯”å‹æ…‹ç‚ºä¸»ï¼Œé€™éƒ¨åˆ†è«‹åƒè€ƒå‰æ–‡ï¼Œä¸å†å¦å¤–é—¡è¿°ï¼Œæœ¬ç¯‡å…§å®¹ä¸»è¦ä»‹ç´¹å¡«å¯«æ™‚é€éå–®å…ƒçš„æ¦‚å¿µé€²è¡Œçµ„åˆé …ç›®çš„éç¨‹ï¼Œç•¶å…§å®¹ä»¥å–®å…ƒé€²è¡Œæ™‚ï¼Œé™¤äº†å·¥åœ°ä¸»ä»»çš„å›å ±æœƒæ¯”è¼ƒæ˜ç¢ºï¼ŒåŒæ™‚ä¹Ÿå¯ä»¥é‡å°å–®å…ƒçš„é€²è¡Œè¼”ä»¥ç›¸å°çš„æª¢æ ¸æ©Ÿåˆ¶èˆ‡é˜²å‘†æ©Ÿåˆ¶ï¼Œæœƒçœä¸‹å¾ˆå¤šéº»ç…©ã€‚\r\n\r\nâœ’ï¸å¡«å¯«æ–¹å¼\r\nå„²å­˜æ ¼å¡«å¯«\r\nå„²å­˜æ ¼å¯èƒ½æ˜¯æ–‡å­—ã€æ•¸å­—ã€æ—¥æœŸ...ç­‰ï¼Œé™¤éæœ‰å…ˆä¿®æ”¹å„²å­˜æ ¼æ ¼å¼ï¼Œå¦å‰‡ä»–æœƒæ ¹æ“šç•¶ä¸‹çš„ç‹€æ³è‡ªå‹•åˆ¤æ–·è¦ä»¥å“ªç¨®æ–¹å¼å­˜åœ¨ï¼Œé€™é€šå¸¸æœƒé€ æˆä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œä¾‹å¦‚åŸæœ¬è¼¸å…¥æ—¥æœŸ2023/2/5é¡¯ç¤ºå»è®Šæˆ44962ï¼Œé‚„æœ‰è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼çš„æ™‚å€™ï¼Œæœ€å‰é¢çš„0æœƒè¢«å»æ‰ï¼Œæ­¤æ™‚å°±éœ€è¦å°‡æ•¸å­—è®Šæˆå­—ä¸²(åœ¨æ‰‹æ©Ÿè™Ÿç¢¼æœ€å‰é¢æ‰“ä¸Š')æ‰èƒ½æ­£ç¢ºé¡¯ç¤ºã€‚\r\nå³ä¾¿å¯ä»¥å°‡å„²å­˜æ ¼çš„æ ¼å¼å•é¡Œæ’é™¤ï¼Œå»ºè­°è¤‡é›œè³‡æ–™é‚„æ˜¯ä¸è¦è®“ä½¿ç”¨è€…ç›´æ¥ç”¨å„²å­˜æ ¼é€²è¡Œå¡«å¯«ï¼Œä½ æ°¸é ä¸çŸ¥é“ä½¿ç”¨è€…ä»–å€‘æœƒæ€éº¼äº‚çµ¦è³‡æ–™ï¼Œå¾ŒçºŒçš„è³‡æ–™å†åˆ©ç”¨æœƒæœ‰å¾ˆå¤šé™åˆ¶ã€‚\r\nä½¿ç”¨è€…è¡¨å–®å¡«å¯«\r\nä½¿ç”¨è€…è¡¨å–®ç‚ºVBAæ‰€æä¾›çš„ä»‹é¢ï¼Œé€éæ‹–æ›³çš„æ–¹å¼å°‡æ§åˆ¶é …æ”¾å…¥è¡¨å–®ç•«é¢ï¼Œä¸¦ä¸”é‡å°å„æ§åˆ¶é …çš„äº‹ä»¶é€²è¡Œé‚è¼¯åˆ¤æ–·èˆ‡å¾ŒçºŒè™•ç†ï¼Œéœ€è¦ä¸€é»VBAçš„åŸºæœ¬åŠŸæ‰æœ‰è¾¦æ³•æŒæ¡ï¼Œä»¥ä¸‹ä»‹ç´¹ç”¨çš„åˆ°çš„æ§åˆ¶é …ã€äº‹ä»¶åç¨±ã€ç”¨é€”èªªæ˜ï¼Œé—œæ–¼ä½¿ç”¨è€…è¡¨å–®çš„æ•™å­¸å†å¦é–‹ä¸€ç¯‡å°ˆæ–‡èªªæ˜ã€‚\r\n\r\n\r\n\r\næ§åˆ¶é …ç›®\r\nç”¨é€”èªªæ˜\r\n\r\n\r\n\r\n\r\nLable\r\né¡¯ç¤ºå…§å®¹\r\n\r\n\r\nTextBox\r\næä¾›ä½¿ç”¨è€…å¡«å¯«å…§å®¹\r\n\r\n\r\nComboBox\r\næä¾›æ—¢æœ‰å…§å®¹è®“ä½¿ç”¨è€…é¸æ“‡\r\n\r\n\r\nCheckBox\r\nè¨»è¨˜åŠŸèƒ½æ˜¯å¦é€²è¡Œ\r\n\r\n\r\nCommandButton\r\nåŸ·è¡ŒåŠŸèƒ½\r\n\r\n\r\n\r\nå¥½è™•æ˜¯å¯ä»¥æœ‰æ•ˆæ§åˆ¶ä½¿ç”¨è€…å¡«å¯«å…§å®¹çš„æ­£ç¢ºæ€§ï¼Œå¾ŒçºŒè³‡æ–™å†åˆ©ç”¨æ™‚æ¯”è¼ƒä¸æœƒæœ‰å›°æ“¾ï¼Œç›¡å¯èƒ½åœ¨æ”¶é›†è¤‡é›œè³‡æ–™çš„éç¨‹éƒ½æ¡ç”¨é€™ç¨®æ–¹å¼ï¼Œç°¡å–®è³‡æ–™é‚„æ˜¯å¯ä»¥é€éç›´æ¥å¡«å¯«å„²å­˜æ ¼å®Œæˆæ²’æœ‰é—œä¿‚ã€‚\r\n\r\n\r\nFig1. å¡«å¯«æ–½ä½œè³‡æ–™ä»‹é¢\r\n\r\nç´™æœ¬å¡«å¯«\r\nç•¶å·¥ç¨‹è³‡æ–™å¤§å¤šéƒ½ä»¥ç´™æœ¬é€²è¡Œæ™‚ï¼Œå¦‚æœè¦é€²è¡Œçµ±è¨ˆåˆ†ææ™‚æœƒæ¶ˆè€—å¾ˆå¤šäººåŠ›ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼EXCELé€™é¡çš„è©¦ç®—è¡¨æœƒè¢«ç™¼å±•å‡ºä¾†çš„åŸå› ï¼Œä¹Ÿå› æ­¤ç´™æœ¬è³‡æ–™è½‰æ›å°æ–¼è³‡æ–™é›»è…¦åŒ–æœƒæ˜¯ä¸€ä»¶å¾ˆç—›è‹¦çš„äº‹æƒ…ï¼Œæ¯æ¬¡çš„è³‡æ–™æ¬é·éƒ½å¯èƒ½æœƒæœ‰è³‡æ–™ä¸Ÿå¤±è·Ÿè³‡æ–™èª¤ç¹•çš„å¯èƒ½ï¼Œä½†ç‡Ÿå»ºç”¢æ¥­é€™æ¨£çš„æƒ…æ³å¯èªªæ˜¯å¾ˆå¸¸è¦‹ã€‚\r\nå°æ–¼ä¸å¤ªæœƒä½¿ç”¨é›»è…¦çš„å·¥åœ°äººå“¡è€Œè¨€ï¼Œäººäººæœ‰ä¸€éš»æœ‰ç¶²è·¯çš„æ‰‹æ©Ÿï¼Œä¹Ÿæ˜¯æ»¿åˆæƒ…åˆç†çš„ï¼Œåªè¦æœ‰ç¶²è·¯å°±å¯ä»¥å°‡æ‰‹æ©Ÿä½œç‚ºè¡¨å–®çš„å¡«å¯«åª’ä»‹å…ˆé€åˆ°é›²ç«¯ä¸Šé¢ï¼Œå†ç”±å…§æ¥­äººå“¡å°‡è³‡æ–™å½™æ•´å‡ºä¾†ï¼Œå­—å¤ªå°å¯ä»¥ç”¨å¹³æ¿é›»è…¦å…‹æœï¼Œç”šè‡³ç”¨éŸ¿æ‡‰å¼ç¶²ç«™çš„æ–¹å¼é€²è¡Œèª¿æ•´ï¼Œè³‡æ–™èƒ½å¤ æ¸›å°‘ä¸€æ¬¡æ¬é·å°æ–¼å¾ŒçºŒéƒ½æœƒæ˜¯ä¸€ä»¶å¥½äº‹ã€‚\r\n\r\n\r\nFig2. Googleè¡¨å–®+Sheets\r\n\r\nğŸ“”å¥‘ç´„é …ç›®\r\nä¸€èˆ¬é …ç›®\r\né€éç›´æ¥æ¡ç”¨å¥‘ç´„é …ç›®ä¹‹å¯é‡åŒ–å‹æ…‹ã€ä¸€å¼å‹æ…‹é€²è¡Œå¡«å¯«ï¼Œç™¾åˆ†æ¯”å‹æ…‹å‰‡å¾ŒçºŒå ±è¡¨ç”¢è£½æ™‚æ ¹æ“šæ¯”ä¾‹é€²è¡Œæ›ç®—ã€‚\r\nç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-å¼•ç”¨ä¾†æº\r\nçµ„åˆé …ç›®\r\nåœ¨é€²è¡Œç¶“è²»ä¼°ç®—æ™‚ï¼Œæ•¸é‡è¨ˆç®—è¡¨çš„ç”¢è£½ç‚ºé™ä½éŒ¯èª¤ï¼Œé€šå¸¸æœƒçµ¦åœ–èªªä¸Šå‡ºç¾çš„çµ„åˆæ§‹ä»¶é€²è¡Œç·¨è™Ÿï¼Œå°æ–¼å¸¶ç‹€å·¥ç¨‹å‰‡æœƒæœ‰æ¯é€²è¡Œç±³çš„æ¦‚å¿µï¼Œå› ç‚ºä¸ç®¡åœ¨å“ªå€‹æ¨è™Ÿå…¶å¯¦éƒ½é•·å¾—å·®ä¸å¤šï¼Œåªè¦ç®—å‡ºæ¯é€²è¡Œç±³æœ‰å¤šå°‘ææ–™ï¼Œè¨ˆç®—æ™‚ä¹˜ä¸Šç¸½é•·åº¦å³å¯å¾—åˆ°ç­”æ¡ˆã€‚\r\n\r\nå–®å…ƒæ§‹ä»¶\r\n\r\nå»ºç¯‰å·¥ç¨‹å¸¸è¦‹çš„æ§‹ä»¶æ˜¯æŸ±æ¢æ¿ç‰†ï¼Œæ©‹æ¢å·¥ç¨‹å¸¸è¦‹çš„æ§‹ä»¶æ˜¯å¢©æŸ±ã€ç¯€å¡Šï¼Œå–®å…ƒå¯ä»¥è‡ªè¡Œå®šç¾©ï¼Œä¸»è¦æ˜¯ç‚ºäº†æ–¹ä¾¿æ’¿æ–™åŠå·¥ç­èªªæ˜è€Œå·²ã€‚\r\n\r\næ¯é€²è¡Œç±³\r\n\r\nçŒæº‰æ’æ°´å·¥ç¨‹æœƒä»¥çŸ©å‹æºä½œç‚ºæ¯é€²è¡Œç±³çš„æ’¿æ–™æ¨™æº–ï¼Œé“è·¯å·¥ç¨‹å‰‡æœƒä»¥é‹ªé¢å‰–é¢æˆ–æ“‹åœŸæ§‹é€ ç‰©(é‡åŠ›å¼æ“‹åœŸç‰†ã€æ‡¸è‡‚å¼æ“‹åœŸç‰†...ç­‰)ç‚ºæ¯é€²è¡Œç±³çš„æ’¿æ–™æ¨™æº–ï¼Œæ•´é«”æœƒè€ƒæ…®æ¼¸è®Šæ®µï¼Œæ¡ç”¨å¹³å‡å€¼è¨ˆç®—ï¼Œå·¥ç¨‹ç´°ç¯€å¦‚è¦å†é€²è¡Œæ‹†åˆ†ï¼Œå‰‡åˆæœƒåˆ†æˆè¥¯åº•ã€æ¸ åº•ã€é‹¼ç­‹çµ„ç«‹ã€å·¦å³ç‰†èº«...ç­‰é€²è¡Œæ¯é€²è¡Œç±³çš„å¡«å¯«ä¾æ“šã€‚\r\nâ˜‘ï¸æª¢æ ¸æ©Ÿåˆ¶\r\nå°‡åœ–é¢å…§å®¹è½‰ç‚ºå–®å…ƒå»é€²è¡Œåˆ†æï¼Œæœ€å¤§çš„å¥½è™•å°±æ˜¯å¯ä»¥é€²è¡Œå–®å…ƒçµ±è¨ˆäº†è§£èˆ‡æ•¸é‡è¨ˆç®—è¡¨ä¹‹é–“çš„å·®ç•°ã€é€éè¨ˆç®—æ¨è™Ÿå€æ®µç¹ªè£½æ¢ç‹€åœ–ç†è§£ç›®å‰æ–½å·¥å·¥åºåŠé æ¸¬ä¸‹éšæ®µæ–½ä½œæ¨è™Ÿã€é”æˆæ¨è™Ÿé‡è¦†å¡«å¯«çš„é˜²å‘†ï¼Œæ›´é‡è¦çš„æ˜¯è—‰ç”±å·¥é …æ›´æ­£å¯ä»¥æ‰¹æ¬¡èª¿æ•´å·²ç¶“ç´€éŒ„çš„å…§å®¹ï¼Œå³æ™‚ä¿®æ­£å–®å…ƒçš„æ•¸é‡è¨ˆç®—ã€‚\r\nå–®å…ƒçµ±è¨ˆ\r\nç•¶ç™¼ç”Ÿå–®å…ƒå¡«å¯«å®Œç•¢å»èˆ‡å¥‘ç´„æ•¸é‡ä¸ç¬¦æ™‚ï¼Œå¯ä»¥ä½¿ç”¨å–®å…ƒçµ±è¨ˆï¼Œå…ˆå°‡æ‰€æœ‰å–®å…ƒåç¨±ææ–™é€²è¡Œç¸½è¨ˆï¼Œç¢ºèªå¥‘ç´„æ•¸é‡èˆ‡å–®å…ƒçµ±è¨ˆç¸½è¨ˆæ‰€å¾—ä¹‹ç¸½æ•¸é‡æ˜¯å¦ç›¸ç¬¦ï¼Œå¦‚æœä¸ç›¸ç¬¦å‰‡æ˜¯ç•¶åˆåœ¨åˆ‡åˆ†å–®å…ƒçš„æ™‚å€™å°±å·²ç¶“å­˜åœ¨éŒ¯èª¤ã€‚\r\nç¢ºå®šæ˜¯åˆ‡åˆ†å–®å…ƒçš„æ™‚å€™çš„éŒ¯èª¤å¾Œï¼Œå¯ä»¥æ ¹æ“šä¸åŒå–®å…ƒåç¨±ä½œç‚ºåˆ†é¡ï¼Œå°‡è©²åˆè¨ˆå…§å®¹ç¸½æ•¸é‡èˆ‡æ•¸é‡è¨ˆç®—è¡¨çš„ç›¸é—œå·¥é …åç¨±é€è¡Œåˆ—è¡¨é€²è¡Œæ¯”å°ï¼Œå¾æœ€å°å–®å…ƒé€²è¡ŒéŒ¯èª¤æŸ¥æ‰¾ï¼Œé€šå¸¸éƒ½æœƒæŠ“åˆ°ä¸€äº›å•é¡Œï¼Œå¯ä»¥é€²è¡Œå¾ŒçºŒçš„å·¥é …æ›´æ­£ã€‚\r\n\r\n\r\nFig3. å–®å…ƒçµ±è¨ˆç¯„ä¾‹\r\n\r\nå·¥é …æ›´æ­£\r\nå·¥é …æ›´æ­£å‰‡æ˜¯åˆ©ç”¨å–®å…ƒåç¨±æ–¼æ–½å·¥ç´€éŒ„è¡¨ä¸Šçš„è¨»è¨˜ï¼Œå°‡æ­£ç¢ºçš„å–®å…ƒææ–™å›æ¨è‡³æ–½å·¥ç´€éŒ„è¡¨ä¸Šçš„æ•¸é‡ï¼Œè—‰æ­¤æ›´æ–°è³‡è¨Šä¸¦æç¤ºä½¿ç”¨è€…æ›´æ­£æ˜ç´°ã€‚\r\næœ‰äº›å…§æ¥­äººå“¡æœƒæ“”å¿ƒå·¥é …æ›´æ­£å¾Œæœƒå½±éŸ¿å·²ç¶“è£½ä½œçš„æ—¥å ±å…§å®¹ï¼Œå¸Œæœ›å¯ä»¥é€ééŒ¯èª¤æš«å­˜çš„æ–¹å¼ï¼Œåœ¨æœªä¾†å¡«å¯«æ–°çš„æ—¥å ±æ™‚åšäº›å¾®çš„å¢åˆªä¾†èª¿æ•´ï¼Œè¦é»é¸é€™é¡†æŒ‰éˆ•æ™‚è¦æ…æ€ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥åœ¨å·¥ç¨‹å‰›é–‹å§‹å°±å…ˆå…¨éƒ¨ç´€éŒ„ä¸Šå»è©¦è©¦ï¼Œæœ‰ç™¼ç¾èˆ‡å¥‘ç´„æ•¸é‡ä¸ç¬¦æ™‚é¦¬ä¸Šæ›´æ­£ï¼Œä½†è‹¥æ˜¯é‡åˆ°è®Šæ›´è¨­è¨ˆå°±æ²’è½ï¼Œè®Šæ›´è¨­è¨ˆé‚„æ˜¯æœ‰å¯èƒ½æœƒæ›´æ”¹åˆ°å–®å…ƒææ–™ã€‚\r\n\r\n\r\nFig4. å·¥é …æ›´æ­£ç¯„ä¾‹\r\n\r\næ¢ç‹€åœ–æŸ¥çœ‹\r\né€éæ–½å·¥é€²ç¨‹çš„æ‹†åˆ†ã€é€²è¡Œæ¨è™Ÿå€é–“çš„ç¹ªè£½ï¼Œæ­é…æ¨è™Ÿé˜²å‘†æ©Ÿåˆ¶ï¼Œèƒ½å¤ æœ‰æ•ˆæª¢æ ¸æ–½å·¥é€²ç¨‹çš„åˆç†æ€§ï¼Œé€šå¸¸ä»¥çŒæº‰æ’æ°´å·¥ç¨‹ç‚ºä¾‹ï¼Œå·¥åºç‚ºè¥¯åº•&gt;é‹¼ç­‹çµ„ç«‹&gt;å¤§åº•&gt;å·¦å³ç‰†èº«ï¼Œæ­¤å¤–å› æ‡‰æ–½å·¥è¦ç¯„è¦æ±‚éœ€è¦ä»¥éš”æ®µæ–½å·¥é€²è¡Œï¼Œä¸¦é ç•™æ¨¡æ¿æ‹†é™¤æ™‚é–“ï¼Œå¾æ–½å·¥é€²åº¦æ¢ç‹€åœ–ä¸Šæ‰€ç™»è¼‰çš„æ—¥æœŸèˆ‡å–®å…ƒåç¨±ä¾¿å¯æŒæ¡æ•´é«”æ–½å·¥é †åºã€‚\r\n\r\n\r\nFig5. æ¢ç‹€åœ–ç¯„ä¾‹\r\n\r\næ¨è™Ÿé˜²å‘†\r\nå¸¶ç‹€å·¥ç¨‹æœ€å®¹æ˜“å‡ºç¾çš„å•é¡Œå°±æ˜¯é‡è¤‡ç´€éŒ„æ¨è™Ÿå€é–“ï¼Œåœ¨å–®å…ƒçµ±è¨ˆçš„æ™‚åªèƒ½çŸ¥é“ç›®å‰ç¸½é•·åº¦ç‚ºå¤šå°‘ï¼Œä½†å»ç„¡æ³•çŸ¥é“å€é–“æ˜¯å¦é‡ç–Šï¼Œå°¤å…¶ç•¶å·¥åºç›¸ç•¶è¤‡é›œæ™‚ï¼Œæ²’æœ‰å°‡å€é–“é€²è¡Œå¯è¦–åŒ–æ›´æ˜¯é›£ä»¥åˆ¤åˆ¥ï¼Œå› æ­¤æœ€æ–¹ä¾¿çš„æ–¹å¼ä¾¿æ˜¯åœ¨å¡«å¯«æ¨è™Ÿæ™‚å°±å…ˆåˆ¤å®šæ˜¯å¦æœ‰é‡è¤‡ï¼Œé‡è¤‡çš„åŸå› å¯èƒ½æ˜¯èµ·å§‹æ¨è™Ÿä½æ–¼æ—¢è¨­æ¨è™Ÿå€é–“(A)ã€çµæŸæ¨è™Ÿä½æ–¼æ—¢è¨­æ¨è™Ÿå€é–“(B)ã€èµ·è¨–æ¨è™ŸåŒ…å«æ—¢è¨­æ¨è™Ÿå€é–“(C)ã€‚\r\n\r\n\r\nFig6. æ¨è™Ÿå€é–“è¡çªæƒ…å¢ƒ\r\n\r\n\r\nç¨‹å¼ç¢¼é‹ä½œä¸Šæœƒå…ˆæŠŠæ¨è™Ÿè½‰æˆæ•¸å­—å†é€²è¡Œå€é–“åˆ¤æ–·ï¼Œç¯€éŒ„è‡ªæˆ‘çš„Github\r\n\r\nFunction TranLoc(ByVal Data As String) As Double&#x27;æ¨è™Ÿå‹æ…‹è½‰æˆå¯è¨ˆç®—ä¹‹æ¨è™Ÿtmp = split(Data, &quot;+&quot;)If UBound(tmp) = -1 Or Data = &quot;&quot; Then Exit Function &#x27; TranLoc = CDbl(Data): Exit Functiontloc = tmp(0) &#x27;åƒä½æ•¸dloc = tmp(1)If dloc Like &quot;*(*&quot; Then    tmp2 = split(dloc, &quot;(&quot;)    If tmp2(0) Like &quot;*.*&quot; Then        tmp3 = split(tmp2(0), &quot;.&quot;)        dloc = tmp3(0) + tmp3(1) / 10        Else            dloc = tmp2(0)        End If        If dloc &gt; 1000 Then Exit Function    End IfFor i = 1 To Len(tloc)    loc_ch = mid(tloc, i, 1)    If IsNumeric(loc_ch) Then ref = ref &amp; loc_chNextTranLoc = CDbl(ref) * 1000 + CDbl(dloc)    End FunctionFunction IsRecLocPass(ByVal rec_loc As String, ByVal item_loc As String) &#x27;, ByVal r As Integer)IsRecLocPass = FalseDim myfunc As New clsMyfunctiontmp = split(rec_loc, &quot;~&quot;)rec_sloc = myfunc.TranLoc(tmp(0))rec_eloc = myfunc.TranLoc(tmp(1))tmp2 = split(item_loc, &quot;~&quot;)item_sloc = myfunc.TranLoc(tmp2(0))item_eloc = myfunc.TranLoc(tmp2(1))If item_sloc &gt;= rec_sloc And item_sloc &lt; rec_eloc Then    err_prompt = &quot;ç¬¬&quot; &amp; r &amp; &quot;åˆ—è¡çª=&gt;ç´€éŒ„èµ·é»ã€&quot; &amp; tmp2(0) &amp; &quot;ã€‘å·²åŒ…å«æ–¼æœ¬æ¬¡å¡«å ±ã€&quot; &amp; rec_loc &amp; &quot;ã€‘&quot;    If err_prompt &lt;&gt; &quot;&quot; Then p = p &amp; err_prompt &amp; vbNewLineEnd IfIf item_eloc &gt; rec_sloc And item_eloc &lt;= rec_eloc Then    err_prompt = &quot;ç¬¬&quot; &amp; r &amp; &quot;åˆ—è¡çª=&gt;ç´€éŒ„çµ‚é»ã€&quot; &amp; tmp2(1) &amp; &quot;ã€‘å·²åŒ…å«æ–¼æœ¬æ¬¡å¡«å ±ã€&quot; &amp; rec_loc &amp; &quot;ã€‘&quot;    If err_prompt &lt;&gt; &quot;&quot; Then p = p &amp; err_prompt &amp; vbNewLineEnd IfIf rec_sloc &gt;= item_sloc And rec_sloc &lt; item_eloc Then    err_prompt = &quot;ç¬¬&quot; &amp; r &amp; &quot;åˆ—è¡çª=&gt;å¡«å ±èµ·é»ã€&quot; &amp; tmp(0) &amp; &quot;ã€‘å·²åŒ…å«æ–¼èˆŠæœ‰ç´€éŒ„ã€&quot; &amp; item_loc &amp; &quot;ã€‘&quot;    If err_prompt &lt;&gt; &quot;&quot; Then p = p &amp; err_prompt &amp; vbNewLineEnd IfIf rec_eloc &gt; item_sloc And rec_eloc &lt;= item_eloc Then    err_prompt = &quot;ç¬¬&quot; &amp; r &amp; &quot;åˆ—è¡çª=&gt;å¡«å ±çµ‚é»ã€&quot; &amp; tmp(1) &amp; &quot;ã€‘å·²åŒ…å«æ–¼èˆŠæœ‰ç´€éŒ„ã€&quot; &amp; item_loc &amp; &quot;ã€‘&quot;    If err_prompt &lt;&gt; &quot;&quot; Then p = p &amp; err_prompt &amp; vbNewLineEnd IfIf p = &quot;&quot; Then IsRecLocPass = TrueEnd Function\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","ç›£é€ å ±è¡¨"]},{"title":"è·¨ç³»çµ±ç¶²é è‡ªå‹•åŒ–å¡«å¯«åšæ³•","url":"/posts/706100979/","content":"èƒŒæ™¯\r\nä¸Šç´šå–®ä½éœ€è¦ç®¡è€ƒç›®å‰ç®¡ç†è™•åŸ·è¡Œä¸­çš„å·¥ç¨‹æ¡ˆä»¶ï¼Œå»ºç«‹è¾²ç”°æ°´åˆ©è¨­æ–½å·¥ç¨‹ç®¡è€ƒç³»çµ±(ä»¥ä¸‹ç¨±å¤–éƒ¨ç³»çµ±)ä¾›å„ç®¡ç†è™•é€²è¡Œå¡«å ±ï¼Œç„¶è€Œç®¡ç†è™•æ–¼å‰æœŸä¾¿å·²å»ºç«‹å·¥ç¨‹ç®¡è€ƒEåŒ–ç³»çµ±(ä»¥ä¸‹ç¨±å…§éƒ¨ç³»çµ±)åšç‚ºå…§éƒ¨è³‡æ–™çš„æ”¶é›†ï¼Œç›£é€ å–®ä½éœ€è¦åœ¨å…§éƒ¨ç³»çµ±å…ˆé€²è¡Œå¡«å¯«å¾Œï¼Œå†ç”±ç®¡ç†å–®ä½é€²å…¥å¤–éƒ¨ç³»çµ±å°‡å…§éƒ¨ç³»çµ±è³‡æ–™å†é‡æ–°è¬„æ‰“ä¸€æ¬¡ã€‚\r\nç‚ºé€²è¡Œå¤–éƒ¨ç³»çµ±è³‡æ–™å¡«å ±ï¼Œæœ€ç†æƒ³çš„ç‹€æ³ç•¶ç„¶æ˜¯èƒ½é€éå…§éƒ¨ç³»çµ±è‡ªèº«è§¸ç™¼å™¨(Trigger)åŸ·è¡Œå¤–éƒ¨ç³»çµ±APIç™¼é€ï¼Œå…§éƒ¨ç³»çµ±è³‡æ–™åº«ç•°å‹•æ™‚ä¹Ÿèƒ½ä¸€ä½µä¿®æ”¹åˆ°å¤–éƒ¨ç³»çµ±çš„å…§å®¹ã€‚\r\nç„¶è€Œä»Šæ—¥æ²’æœ‰å¤–éƒ¨ç³»çµ±APIä½¿ç”¨ï¼Œéœ€è¦å¦å¤–æƒ³è¾¦æ³•å¾åŸæœ¬çš„è³‡æ–™åº«æ’ˆå–è³‡æ–™é€²è¡Œç¶²é è‡ªå‹•åŒ–å¡«å ±æ‰èƒ½çœäº‹ï¼Œé¦–å…ˆè¦ç¢ºèªå…§éƒ¨ç³»çµ±çš„è³‡æ–™åº«æ¬„ä½æ˜¯å¦èƒ½é€²è¡Œè³‡æ–™æ¢³ç†ï¼Œå†è€…ç¢ºèªç¶²é è‡ªå‹•åŒ–å¡«å ±åšæ³•ç‚ºä½•ã€‚\r\n\r\n\r\nå¤–éƒ¨ç³»çµ±æ“ä½œç•«é¢\r\n\r\n\r\nFig1. æ–°å¢è¨ˆç•«å·¥ç¨‹\r\n\r\n\r\n\r\n\r\nFig2. è¨ˆç•«å·¥ç¨‹æˆæœ\r\n\r\n\r\n\r\n\r\nFig3. æ–°å¢åˆ†é …å·¥ç¨‹\r\n\r\n\r\n\r\n\r\nFig4. åˆ†é …å·¥ç¨‹æˆæœ\r\n\r\n\r\n\r\n\r\nFig5. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(ä¸€)\r\n\r\n\r\n\r\n\r\nFig6. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(äºŒ)\r\n\r\nå…§éƒ¨ç³»çµ±è³‡æ–™åº«\r\nç¶“æŸ¥å¤–éƒ¨ç³»çµ±ç›¸é—œè³‡æ–™æ¬„ä½åˆ†æ•£æ–¼å…§éƒ¨ç³»çµ±è³‡æ–™åº«(SQLserver)å„å€‹ä¸åŒè³‡æ–™è¡¨ï¼Œé›–ç„¶é€éJOINçš„æ–¹å¼ä¹Ÿå¯ä»¥ç”¢å‡ºä¸€å€‹æ»¿æ¥è¿‘å¯ä»¥ç›´æ¥è¼¸å…¥çš„æˆæœï¼Œä½†ç­†è€…å°æ–¼è³‡æ–™åº«çš„æ“ä½œç¶“é©—å°šé¡¯ä¸è¶³ï¼ŒæœŸç¨‹è¿«åœ¨çœ‰ç«ï¼Œåªå¥½å…ˆå°‡å…§éƒ¨ç³»çµ±ç›¸é—œå„è¡¨å…ˆåŒ¯å‡ºæˆexcelï¼Œå†é€éç†Ÿæ‚‰çš„VBAé€²è¡Œè³‡æ–™æ¢³ç†ï¼Œæ•´ç†æˆæœªä¾†ç¶²é è‡ªå‹•åŒ–å¡«å ±å¾…è¼‰å…¥çš„å…§å®¹ã€‚\r\nç‚ºä¸å½±éŸ¿æ—¢æœ‰è³‡æ–™åº«é‹ä½œï¼Œå…ˆè«‹å„åŒä»å°‡æ¬²å¡«å ±è³‡æ–™å…§å®¹å¡«å¯«å®Œå¾Œé€²è¡Œè³‡æ–™åº«å‚™ä»½ï¼Œæ–¼æœ¬åœ°ç«¯é‡å•Ÿä¸€å€‹è³‡æ–™åº«æœå‹™ä¸¦å°å…¥å‚™ä»½å…§å®¹é€²è¡Œå¾ŒçºŒæ“ä½œã€‚\r\nè³‡æ–™æ¢³ç†ç´°ç¯€\r\n\r\n\r\n\r\nå¤–éƒ¨ç³»çµ±é é¢\r\næ¬„ä½åç¨±\r\nå…§éƒ¨ç³»çµ±è³‡æ–™è¡¨\r\n\r\n\r\n\r\n\r\nå·¥ç¨‹ç ”æ\r\nå·¥ç¨‹ç·¨è™Ÿ(è‡ªè¨‚)\r\nAPMFORM\r\n\r\n\r\n\r\nå·¥ç¨‹åç¨±\r\n\r\n\r\n\r\n\r\né„‰é®å¸‚\r\n\r\n\r\n\r\n\r\næ°´è·¯åç¨±åˆ—è¡¨(è‡ªè¨‚)\r\n\r\n\r\n\r\nåˆ†é …å·¥ç¨‹\r\næ°´è·¯åç¨±\r\nMONFORM\r\n\r\n\r\nå·¥ç¨‹æ¦‚è¦è¡¨\r\nå—ç›Šé¢ç©\r\n\r\n\r\n\r\n\r\næ”¹å–„é¡åˆ¥\r\n\r\n\r\n\r\n\r\næ”¹å–„æ•ˆç›Š\r\n\r\n\r\n\r\n\r\nç”¨åœ°æƒ…å½¢\r\n\r\n\r\n\r\n\r\nè¦åŠƒæƒ…å½¢\r\n\r\n\r\n\r\n\r\nç›¸é—œæƒ…å½¢\r\n\r\n\r\n\r\n\r\nè¾²æ°‘æ„é¡˜\r\n\r\n\r\n\r\n\r\næ°´æºæƒ…å½¢\r\n\r\n\r\n\r\n\r\næ°´æ¬Šæƒ…å½¢\r\n\r\n\r\n\r\n\r\næ˜¯å¦éœ€é…åˆæ–·æ°´æœŸæ–½å·¥\r\n\r\n\r\n\r\n\r\nå·¥ç¨‹é‡è¦æ€§\r\n\r\n\r\n\r\n\r\nç¶“è²»æ¦‚ä¼°é …ç›®\r\nMONFUND\r\n\r\n\r\n\r\nç¾æ³ç…§ç‰‡åŠè¨­è¨ˆç°¡åœ–\r\nMONFPIC\r\n\r\n\r\n\r\nç…§ç‰‡è™•ç†\r\nåœ¨è™•ç†ç…§ç‰‡å°æ˜ æ™‚ï¼Œç™¼ç¾è³‡æ–™åº«ä¸­çš„ç…§ç‰‡å­˜æˆäºŒé€²ä½ï¼Œéœ€å…ˆæŠŠäºŒé€²ä½è½‰æˆåœ–ç‰‡æ‰æœ‰è¾¦æ³•é€²è¡Œå¾ŒçºŒè™•ç†ã€‚\r\ndef get_photos():    conn = get_db_connection()    cursor = conn.cursor()    query=&quot;&quot;&quot;    SELECT          mf.[MN_ID],        mf.[WRD_NAME],        mp.[PIC_FILE],  -- å‡è¨­ä½ æƒ³è¦é¸æ“‡åœ–ç‰‡æ¬„ä½        mp.[PIC_PATH]    FROM         [CMPSGS].[dbo].[MONFORM] mf    JOIN         [CMPSGS].[dbo].[MONFPIC] mp        ON mf.[MN_ID] = mp.[MN_ID]    WHERE         mf.[ADD_DT] &gt; &#x27;2024-11-01&#x27;    ORDER BY        mf.[MN_ID]&quot;&quot;&quot;    cursor.execute(query)    # ç²å–åˆ—å    columns = [column[0] for column in cursor.description]        # å°‡çµæœè½‰æ›ç‚ºå­—å…¸åˆ—è¡¨    results = [dict(zip(columns, row)) for row in cursor.fetchall()]        # print(&quot;Results:&quot;, results)  # æ–°å¢é€™ä¸€è¡Œ    # å°‡çµæœè½‰æ›ç‚º DataFrame    df = pd.DataFrame(results)    for index, row in df.iterrows():                if index %3==0:            print(row[&quot;WRD_NAME&quot;])            folder_name=row[&quot;WRD_NAME&quot;]            os.makedirs(&quot;./data/&quot;+folder_name, exist_ok=True)                    with open(&quot;./data/&quot;+folder_name+&quot;/&quot;+row[&quot;WRD_NAME&quot;]+&quot;-&quot;+row[&quot;PIC_PATH&quot;], &quot;wb&quot;) as image_file:            image_file.write(row[&quot;PIC_FILE&quot;])            print(str(index)+&quot;...OK!&quot;)    cursor.close()    conn.close()        return df\r\n \r\n\r\nç¶²é è‡ªå‹•åŒ–å¡«å ±\r\nåŸæœ¬æƒ³åƒä¸­çš„Seleniumæœƒéœ€è¦å¾ç„¡åˆ°æœ‰é–‹å•Ÿä¸€å€‹ç¶²ç«™å¾Œé–‹å§‹é€²è¡Œè³‡æ–™å¡«å¯«ï¼Œå¤§å¤šæ•¸çš„ç¶²ç«™éƒ½æœƒæœ‰å¸³è™Ÿå¯†ç¢¼é©—è­‰æ©Ÿåˆ¶ï¼Œç”šè‡³ç¥­å‡ºé©—è­‰ç¢¼ã€é¸æ“‡æ±½è»Šåœ–ç‰‡ã€ç§»å‹•æ»‘é¼ åˆ°æŒ‡å®šä½ç½®...ç­‰åçˆ¬èŸ²æ©Ÿåˆ¶ä¾†ç¢ºèªæ˜¯å¦ç‚ºæ©Ÿå™¨äººï¼Œä½†è‹¥ç¶²é å¯ä»¥è¢«æ¥ç®¡ç¹é–‹é€™äº›æ©Ÿåˆ¶çš„è©±ï¼Œé‚£æ•´å€‹è³‡æ–™å¡«å ±ä½œæ¥­å°±æœƒå¾ˆæœ‰æ©Ÿæœƒè®“é›»è…¦ä»£å‹ï¼Œé€™å°±æ˜¯å¯«ç¨‹å¼çš„è¶£å‘³ä¾†æºï¼Œç•¶ç„¶é‚„æ˜¯è¦å°å¿ƒä¸èƒ½é»å¤ªå¿«ï¼Œå¦å‰‡ç¶²ç«™å¯èƒ½æœƒè² è·ä¸éä¾†ã€‚\r\nChrome\r\nç¶²é ç€è¦½å™¨ï¼Œé€éä»¥ä¸‹æŒ‡ä»¤å³å¯é€²è¡Œç¶²ç«™æ“ä½œæ¥ç®¡ï¼Œéœ€è¦æ ¹æ“šè‡ªèº«é›»è…¦çš„chromeå®‰è£è·¯å¾‘åŸ·è¡Œï¼Œå»ºè­°å°‡åŸæœ¬æ‰€é–‹å•Ÿä¸­çš„chromeç•«é¢é€šé€šé—œé–‰å¾Œå†åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚\r\n\r\nWIN10\r\n\r\n\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\" â€“remote-debugging-port=9222\r\n\r\nWIN11\r\n\r\n\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" â€“remote-debugging-port=9222\r\nNOTE:å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ç€è¦½å™¨çš„åŸ·è¡Œè·¯å¾‘ï¼Œå¯ä»¥åœ¨åŸæœ¬æ¡Œé¢ç€è¦½å™¨æ·å¾‘æ‰¾å°‹å…§å®¹\r\n\r\n\r\nFig9. ç€è¦½å™¨ç•«é¢\r\n\r\n\r\næ›´å¤šç´°ç¯€è«‹åƒè€ƒ.Seleniumè©³ç´°æ“ä½œæ­¥é©Ÿ\r\næ“ä½œDEMO\r\n\r\n\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Python","SQL","Selenium"]},{"title":"ç›£é€ æ—¥å ±è¡¨è¨­è¨ˆè¦åŠƒ","url":"/posts/168906144/","content":"ğŸ™Œå‰è¨€\r\n\r\nç›£é€ å ±è¡¨ç‚ºå…¬å…±å·¥ç¨‹ä¸‰ç´šå“ç®¡åˆ¶åº¦ä¸‹çš„å¿…å‚™è¡¨å–®\r\n\r\nä¾å…¬å…±å·¥ç¨‹æ–½å·¥å“è³ªç®¡ç†ä½œæ¥­è¦é»ç¬¬åä¸€ã€ç›£é€ å–®ä½åŠå…¶æ‰€æ´¾é§ç¾å ´äººå“¡å·¥ä½œé‡é»å¦‚ä¸‹:(åäº”)ä¾è¦å®šå¡«å ±ç›£é€ å ±è¡¨\r\n\r\næ ¼å¼ä¾†æºè«‹åƒè€ƒç›£é€ å ±è¡¨(é™„è¡¨äº”)\r\n\r\nç›£é€ å ±è¡¨æ‰€éœ€ç™»è¼‰å…§å®¹é™¤åŸºæœ¬è³‡æ–™å¤–ï¼Œå…¶é¤˜é‡é»ç°¡è¿°å¦‚ä¸‹:\r\n\r\nå·¥ç¨‹é€²åº¦\r\næ•¸é‡è¨ˆç®—\r\næ–½å·¥æŠ½æŸ¥\r\nå“è³ªè©¦é©—\r\næ–‡ä»¶ç®¡ç†\r\n\r\næœ¬ç¯‡ç‚ºæˆ‘æ‰€é–‹ç™¼çš„ç›£é€ æ—¥å ±è¡¨VBAçš„ä¸€äº›å°ˆæ¡ˆè¨­è¨ˆæ¶æ§‹ç°¡è¿°ï¼Œ\r\næœ‰èˆˆè¶£è«‹ç¹¼çºŒè§€çœ‹...\r\n\r\n\r\n\r\nFig1. ç›£é€ å ±è¡¨ç•«é¢\r\n\r\n\r\nğŸš¸å·¥ç¨‹é€²åº¦\r\né å®šé€²åº¦\r\n\r\næ­¤è™•çš„ç´€éŒ„å…§å®¹ç‚ºæå ±æ–½å·¥è¨ˆç•«æ›¸æ™‚çš„æ–½å·¥é€²åº¦ç¶²åœ–å…§å®¹\r\n\r\nè¤‡é›œçš„æ¡ˆå­å¯èƒ½æœƒæ˜¯ç®­ç·šç¶²åœ–ç•«ã€ç°¡å–®çš„æ¡ˆå­é€šå¸¸ç”¨ç”˜ç‰¹åœ–ï¼Œä¸ç®¡å¦‚ä½•ï¼Œæœ€åº•ä¸‹çš„ç´¯ç©é€²åº¦é€šå¸¸æ¯åŠå€‹æœˆæœƒæœ‰ä¸€å€‹æ•¸å€¼ï¼Œé€™å°±æ˜¯å ±è¡¨ä¸Šæ‰€éœ€çš„é å®šé€²åº¦ï¼Œå¦‚æœæ¯”è¼ƒç°¡å–®çš„æ¡ˆå­å¯ä»¥ç”¨å…§æ’å€¼çš„æ–¹å¼å»è£œæ•¸å€¼ã€‚\r\nç´¯ç©é€²åº¦ä»¥å…§æ’æ–¹å¼é€²è¡Œæ™‚ï¼Œåœ¨æŸäº›å¤§æ¡ˆå­ä¸­å¯èƒ½ç„¡æ³•è²¼è¿‘é æ’é€²åº¦ï¼Œå»ºè­°é€éæ§‹é€ ç‰©çš„æ‹†é …é æ’ï¼Œç”±æ§‹é€ ç‰©çš„å–®å…ƒåˆ†æå»æ›ç®—å¥‘ç´„åƒ¹é‡‘ï¼Œå†ä»¥è©²åƒ¹é‡‘é€²è¡Œé å®šé€²åº¦çš„æ›ç®—æœƒæ¯”è¼ƒæº–ç¢ºã€‚\r\n\r\nå¯¦éš›é€²åº¦\r\n\r\næŒ‰å¥‘ç´„è©³ç´°è¡¨é …ç›®å·²ç¶“æŠ½æŸ¥å®Œæˆéƒ¨åˆ†æ‰€æ›ç®—ä¹‹é‡‘é¡ä½”å¥‘ç´„åƒ¹é‡‘ä¹‹é‡‘é¡ç™¾åˆ†æ¯”ã€‚\r\n\r\næœ‰äº›æ¥­ä¸»æœƒè¦æ±‚è¨ˆç®—å·¥ç¨‹é€²åº¦åˆ†æ¯æ™‚ï¼Œä¸è¦è¨ˆå…¥å» å•†ç®¡ç†è²»åŠç‡Ÿæ¥­ç¨…ï¼Œä½†å»åˆè¦æ±‚è¦é¡¯ç¤ºæ–¼ç›£é€ å ±è¡¨çš„è©³ç´°è¡¨ä¸Š...\r\nçªç™¼æƒ…å½¢\r\nåœ¨å·¥ç¨‹åŸ·è¡ŒæœŸé–“ï¼Œå¯èƒ½æœ‰è«¸å¤šåŸå› å°è‡´å±•å»¶å·¥æœŸã€åœå·¥ç­‰æƒ…æ³ï¼Œæ­¤æ™‚ä¹Ÿéœ€è¦é‡æ–°èª¿æ•´æ–½å·¥ç¶²åœ–ä¸¦å°‡æ­£ç¢ºä¹‹é å®šé€²åº¦ç´€éŒ„ä¸Šå»ã€‚\r\n\r\nâœï¸æ•¸é‡è¨ˆç®—\r\n\r\nå°æ‡‰æ–¼ ä¸€ã€å·¥ç¨‹é€²è¡Œæƒ…æ³(å«ç´„å®šä¹‹é‡è¦æ–½å·¥é …ç›®åŠæ•¸é‡)\r\n\r\nåœ¨ç›£é€ è¨ˆç•«æ›¸ä¸­æœƒæåŠé‡è¦æ–½å·¥é …ç›®åŠæ•¸é‡ï¼Œå¯ä»¥ç”¨é€™éƒ¨åˆ†çš„å…§å®¹ä¾†é€²è¡Œç´€éŒ„\r\nç´€éŒ„å…§å®¹å¯èƒ½æœƒæœ‰ä»¥ä¸‹æƒ…æ³\r\n\r\nç´€éŒ„ç´¯ç©æ•¸é‡ä¸ç‚º0çš„å¥‘ç´„é …ç›®(å³éƒ¨åˆ†å‘ˆç¾)\r\nç´€éŒ„å¥‘ç´„æ•¸é‡ä¸ç‚º0çš„å¥‘ç´„é …ç›®(å³å…¨éƒ¨å‘ˆç¾)\r\nç´€éŒ„ç•¶æ—¥æ–½ä½œå…§å®¹ï¼Œå†å¦æª¢é™„ç¬¬äºŒè¯è©³ç´°è¡¨(å³å…¨éƒ¨å‘ˆç¾åœ¨ç¬¬äºŒè¯)\r\n\r\né€™éƒ¨åˆ†çš„å·®ç•°è®ŠåŒ–æ¯”è¼ƒå¤§ï¼Œæˆ‘çš„å°ˆæ¡ˆéƒ½æœƒæŠŠé€™äº›é‚è¼¯å»ºç«‹èµ·ä¾†ï¼Œåˆ°æ™‚å†ä¾†é¸è¦å“ªä¸€ç¨®å³å¯\r\n\r\nâš’ï¸æ–½å·¥æŠ½æŸ¥\r\n\r\nå°æ‡‰æ–¼\r\näºŒã€ç›£ç£ä¾ç…§è¨­è¨ˆåœ–èªªåŠæ ¸å®šæ–½å·¥åœ–èªªæ–½å·¥(å«ç´„å®šä¹‹æª¢é©—åœç•™é»åŠæ–½å·¥æŠ½æŸ¥ç­‰æƒ…å½¢)\r\n\r\nä¾ç…§ç›£é€ è¨ˆç•«æ›¸æ‰€æåŠçš„æª¢é©—é »ç‡é€²è¡Œæª¢é©—åœç•™é»æŠ½æŸ¥æˆ–éš¨æ©ŸæŠ½æŸ¥ã€‚\r\nç´€éŒ„å…§å®¹ç‚ºæŠ½æŸ¥ç´€éŒ„è¡¨çš„ç·¨è™Ÿã€é …ç›®ã€åˆæ ¼èˆ‡å¦ã€‚\r\nå¾ˆå¤šå§”å“¡éƒ½æœƒèªç‚ºç´€éŒ„è¡¨å°±æ˜¯è¦ç”¨æ‰‹å¯«æ‰æœ‰FUï¼Œå› æ­¤åœ¨é€²è¡Œæ–½å·¥æŠ½æŸ¥çš„æ­¸æª”æ™‚ï¼Œæœƒéœ€è¦å†å¦å¤–æƒæã€‚\r\nğŸ“‹å“è³ªè©¦é©—\r\n\r\nå°æ‡‰æ–¼\r\nä¸‰ã€æŸ¥æ ¸ææ–™è¦æ ¼åŠå“è³ª(å«ç´„å®šä¹‹æª¢é©—åœç•™é»ã€ææ–™è¨­å‚™ç®¡åˆ¶åŠæª¢(è©¦)é©—ç­‰æŠ½é©—æƒ…å½¢)\r\n\r\nä¾ç…§å“è³ªè¨ˆç•«æ›¸æ‰€æåŠçš„ææ–™è¨­å‚™å“ç®¡é »ç‡é€²è¡Œå» é©—æˆ–æŠ½é©—ã€‚\r\nç´€éŒ„å…§å®¹ç‚ºææ–™è¨­å‚™ç®¡åˆ¶åç¨±ã€å¥‘ç´„æ•¸é‡ã€å·²ä½œæ•¸é‡ã€‚\r\né€™éƒ¨åˆ†è·Ÿæ–½å·¥æŠ½æŸ¥æœ‰é»é¡ä¼¼ï¼Œè©¦é©—å ±å‘Šé€šå¸¸ä¹Ÿæœƒæ˜¯ç´™æœ¬çš„å…§å®¹ï¼Œå› æ­¤åœ¨å“è³ªè©¦é©—çš„æ­¸æª”ï¼Œä¸€æ¨£ä¹Ÿæ˜¯è¦å¦å¤–æƒæèµ·ä¾†ã€‚\r\nğŸ“šæ–‡ä»¶ç®¡ç†\r\n\r\nå°æ‡‰æ–¼\r\näº”ã€å…¶ä»–ç´„å®šç›£é€ äº‹é …(å«é‡è¦äº‹é …ç´€éŒ„ã€ä¸»è¾¦æ©Ÿé—œæŒ‡ç¤ºåŠé€šçŸ¥å» å•†è¾¦ç†äº‹é …)\r\n\r\n\r\næ©Ÿé—œå…¬æ–‡(è®Šæ›´ã€æ–°å¢ã€å±•å»¶ã€åœå·¥ã€ææ–™ã€ä¼°é©—ã€è¡Œæ”¿æ–‡ä»¶...ç­‰)\r\nç£å°æŸ¥æ ¸\r\næœƒè­°è¨˜éŒ„\r\näº¤è¾¦äº‹é …\r\nå…¶ä»–è¦ºå¾—æ‡‰è©²è¦ç´€éŒ„çš„å…§å®¹\r\n\r\næ¯å€‹å·¥ç¨‹æ¡ˆæ‡‰è©²éƒ½æœƒæœ‰ç„¡æ•¸å€‹æœƒè­°ã€ç„¡æ•¸å€‹ä¾†å¾€å…¬æ–‡ï¼Œç„¡è«–æ˜¯å°æ¥­ä¸»é‚„æ˜¯å°å» å•†éƒ½æ˜¯ï¼Œè€Œé€™äº›éƒ½æœƒéœ€è¦ç´€éŒ„åœ¨ç›£é€ å ±è¡¨ä¸­\r\né æœŸæ¯å€‹å°å·¥ç¨‹æ¡ˆä¸äº†è§£çš„äººï¼Œé€éç¿»æ‰¾ç›£é€ å ±è¡¨ï¼Œå°±èƒ½å¤ äº†è§£æ•´å€‹å·¥ç¨‹çš„å¤§è‡´å…§å®¹ï¼Œé€™å°±æ˜¯æ’°å¯«çš„ä¸»è¦ç›®çš„ã€‚\r\nğŸ’¥ç›£é€ å ±è¡¨VBAç³»çµ±æ¶æ§‹åœ–\r\n\r\n\r\nFig2. ç›£é€ å ±è¡¨VBAç³»çµ±æ¶æ§‹åœ–\r\n\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["Excel VBA","ç›£é€ å ±è¡¨"]},{"title":"ç¸±æ–·é¢æ’æ——æ–‡å­—é‡ç–Šå•é¡Œ","url":"/posts/2767553795/","content":"ğŸ™Œå‰è¨€\r\nğŸ‘‰ç¸±æ–·é¢ç™¼å±•ä¾†æº\r\nAutoCAD VBA\r\nç¸±æ–·é¢ç¹ªè£½è‡ªå‹•åŒ–\r\nğŸé–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ\r\nç¸±æ–·é¢ç¹ªè£½æ™‚æœƒé‡å°éœ€è¦æ–‡å­—èªªæ˜çš„æ¨è™Ÿé€²è¡Œæ’æ——ç¹ªè£½ï¼Œå¯èƒ½æœƒé€ æˆæ’æ——æ–‡å­—å‡ºç¾é‡ç–Šçš„åŸå› æœ‰å…©å€‹\r\n\r\næ’æ——èªªæ˜æ¨è™Ÿè·é›¢å¤ªè¿‘(0+200ã€0+205)\r\nç¹ªè£½Xè»¸æ¯”ä¾‹å¤ªå°(1:1000 vs 1:5000)\r\n\r\nç¹ªè£½éç¨‹æœƒè€ƒé‡åœ–ç´™è¼¸å‡ºçš„èˆ’é©åº¦ï¼Œæœ€å°å­—é«˜é€šå¸¸æœƒä»¥3.4.5ç‚ºåŸå‰‡ï¼Œæ–‡å­—èªªæ˜æœƒå›ºå®šä»¥30åº¦å‘ˆç¾\r\n\r\nç•¶è·é›¢å¤ªè¿‘æ™‚å¯ä»¥é€éèª¿æ•´Xè»¸æ¯”ä¾‹è®“é–“è·æ‹‰é–‹ï¼Œæ©«å‘æœƒé‡ç–Šçš„æ™‚å€™å°±é€²è¡Œä¸Šä¸‹ä½ç§»ï¼Œæ–¹ä¾¿è®€è€…è§€çœ‹ã€‚\r\n\r\nå› æ­¤æœ¬ç¯‡å°±æ˜¯è¦é€éVBAæŠ“å–èªªæ˜æ–‡å­—çš„å¤–æ¡†åŠä¸‹ç·šï¼Œè‡ªå‹•èª¿æ•´æ–‡å­—é‡ç–Šå…§å®¹ï¼Œä»¥ä¸‹é€²è¡Œèªªæ˜:\r\n\r\n\r\nğŸ“Œç¯„ä¾‹èªªæ˜\r\n\r\n\r\nFig1. æ’æ——æ–‡å­—èªªæ˜\r\n\r\nğŸ”·æµç¨‹è§£èªª\r\nä¸€èˆ¬æ’æ——æ–‡å­—éƒ½æ˜¯å±¬æ–¼æ—‹è½‰è‡³ç¬¬ä¸€è±¡é™çš„å…§å®¹(0åº¦~90åº¦)\r\n\r\né€éCAD VBAå…§å»ºæŒ‡ä»¤GetBoundingBoxæ‰¾åˆ°é‚Šç•Œé»ã€‚\r\né€éå¹¾ä½•åœ–å½¢å­¸åŠä¸‰è§’å‡½æ•¸é—œä¿‚é€²è¡Œåˆ—å¼ã€‚\r\nç”¨ä¸€å…ƒäºŒæ¬¡è¯ç«‹æ–¹ç¨‹å¼è§£æåƒæ•¸ã€‚\r\nä»£å›åŸæœ¬ç¬¬ä¸€è±¡é™çš„æ­£ç¢ºé»ä½ã€‚\r\nå¼•å…¥clsACADé€²è¡ŒLINEç‰©ä»¶ç¹ªè£½ã€‚\r\n\r\n\r\nğŸŒŸå¹¾ä½•é—œä¿‚\r\n\\[ Hcos\\theta+Lsin\\theta=Y_1-Y_0=const.\r\n\\] \\[\r\nHsin\\theta+Lcos\\theta=X_1-X_0=const. \\]\r\næ­£ç¢ºè§’é»:\r\n\r\n\r\n\r\né»å\r\nXåº§æ¨™\r\nYåº§æ¨™\r\n\r\n\r\n\r\n\r\nå·¦ä¸‹\r\n\\[ X_0+Hsin\\theta \\]\r\n\\[ Y_0 \\]\r\n\r\n\r\nå³ä¸‹\r\n\\[ X_1 \\]\r\n\\[ Y_1-Hcos\\theta \\]\r\n\r\n\r\nå·¦ä¸Š\r\n\\[ X_0 \\]\r\n\\[ Y_0+Hcos\\theta \\]\r\n\r\n\r\nå³ä¸Š\r\n\\[ X_1-Hsin\\theta \\]\r\n\\[ Y_1 \\]\r\n\r\n\r\n\r\n\r\n\r\nFig2. æ–‡å­—å¤–æ¡†ã€é»ä½å¹¾ä½•é—œä¿‚\r\n\r\n\r\n\r\n\r\nFig3. ä¸Šä¸‹åº•ç·šç¹ªè£½æˆæœ\r\n\r\nâš¡ç¨‹å¼ç¢¼\r\næ¨¡çµ„(module)\r\nSub test_getBoundingBox()    &#x27;é©ç”¨æ–¼ç¬¬ä¸€è±¡é™    Dim CAD As New clsACAD    Dim L As Double    Dim H As Double    Set sset2 = CAD.CreateSSET()    Set entobj = sset2(0)        rotate_degree = entobj.Rotation * 180 / 3.14        Call entobj.GetBoundingBox(Min, Max)        X0 = Min(0)    Y0 = Min(1)    X1 = Max(0)    Y1 = Max(1)        Call CAD.AddPoint(Min)    Call CAD.AddPoint(Max)        &#x27;---ä¸€å…ƒäºŒæ¬¡è¯ç«‹æ–¹ç¨‹å¼---        a1 = Sin(rotate_degree / 180 * 3.14)    b1 = Cos(rotate_degree / 180 * 3.14)    c1 = Y1 - Y0        a2 = Cos(rotate_degree / 180 * 3.14)    b2 = Sin(rotate_degree / 180 * 3.14)    c2 = X1 - X0        Call SolveLinearEquations(a1, b1, c1, a2, b2, c2, L, H)        &#x27;------åº•ç·š------        Xpt_LD = X0 + H * Sin(rotate_degree / 180 * 3.14)    Ypt_LD = Y0        Xpt_RD = X1    Ypt_RD = Y1 - H * Cos(rotate_degree / 180 * 3.14)        Call CAD.AddLineCO(Xpt_LD, Ypt_LD, Xpt_RD, Ypt_RD)        &#x27;-------é ‚ç·š------        Xpt_LU = X0    Ypt_LU = Y0 + H * Cos(rotate_degree / 180 * 3.14)        Xpt_RU = X1 - H * Sin(rotate_degree / 180 * 3.14)    Ypt_RU = Y1        Call CAD.AddLineCO(Xpt_LU, Ypt_LU, Xpt_RU, Ypt_RU)    End SubFunction SolveLinearEquations(ByVal a1 As Double, ByVal b1 As Double, ByVal c1 As Double, ByVal a2 As Double, ByVal b2 As Double, ByVal c2 As Double, ByRef x As Double, ByRef y As Double) As Boolean    Dim determinant As Double        determinant = a1 * b2 - a2 * b1        If determinant = 0 Then        SolveLinearEquations = False    Else        x = (c1 * b2 - c2 * b1) / determinant        y = (a1 * c2 - a2 * c1) / determinant        SolveLinearEquations = True            End If    End Function\r\nç‰©ä»¶é¡åˆ¥æ¨¡çµ„(clsACAD)\r\nPrivate mo As ObjectPrivate pa As ObjectPublic acadDoc As ObjectPublic CADVer As StringPrivate Sub Class_Initialize()strCAD = &quot;AutoCAD.application&quot;CADVer = &quot;AUTOCAD&quot;Call CADInit(strCAD)End SubPrivate Sub CADInit(ByVal strCAD As String)On Error Resume NextSet acadApp = GetObject(, strCAD) &#x27;æŸ¥çœ‹å®‰è£If Err &lt;&gt; 0 Then Set acadApp = CreateObject(strCAD)acadApp.Visible = TrueOn Error GoTo 0Set mo = acadApp.ActiveDocument.ModelSpaceSet pa = acadApp.ActiveDocument.PaperSpaceSet acadDoc = acadApp.ActiveDocumentEnd SubFunction CreateSSET(Optional ByVal sname As String = &quot;SS1&quot;, Optional ByVal ftypetmp As Variant = &quot;&quot;, Optional ByVal fdatatmp As Variant = &quot;&quot;)&#x27;****PorgeCADä¸­ä¼¼ä¹æ²’è¾¦æ³•åšåˆ°éæ¿¾çš„æ¢ä»¶?*****&#x27;0:object type&#x27;2:object name&#x27;8:layer name&#x27;62:color number(0 to 256)Dim FilterType() As IntegerDim FilterData() As VariantOn Error Resume Next: acadDoc.SelectionSets(sname).Delete: On Error GoTo 0Set sset = acadDoc.SelectionSets.Add(sname)If ftypetmp = &quot;&quot; Then    sset.SelectOnScreen    Else    ft = Split(ftypetmp, &quot;,&quot;)    fd = Split(fdatatmp, &quot;,&quot;)        ReDim FilterType(0 To UBound(ft))    ReDim FilterData(0 To UBound(fd))        For i = 0 To UBound(ft)            FilterType(i) = ft(i)        FilterData(i) = fd(i)            Next        sset.SelectOnScreen FilterType, FilterData    End IfSet CreateSSET = ssetEnd FunctionFunction AddPoint(pt) As ObjectIf CADVer = &quot;ICAD&quot; Then    Set AddPoint = mo.AddPointEntity(tranPoint(pt))Else    Set AddPoint = mo.AddPoint(tranPoint(pt))End IfEnd FunctionFunction AddLineCO(X1, Y1, X2, Y2) As ObjectDim spt(2) As DoubleDim ept(2) As Doublespt(0) = X1: spt(1) = Y1ept(0) = X2: ept(1) = Y2Set AddLineCO = AddLine(spt, ept)End FunctionFunction AddLine(spt, ept) As ObjectSet AddLine = mo.AddLine(tranPoint(spt), tranPoint(ept))End Function&#x27;=============transform ICAD about point and points======================Function tranPoint(ByVal CADpt)If CADVer &lt;&gt; &quot;ICAD&quot; Then tranPoint = CADpt: Exit FunctionSet tranPoint = Library.CreatePoint(CADpt(0), CADpt(1), CADpt(2))End Function\r\nğŸ‘‰å¾ŒçºŒåˆ©ç”¨\r\nç¢ºèªä¸‹ä¸€æ–‡å­—å¤–æ¡†é»æ˜¯å¦ä½æ–¼é€™æ¬¡æ–‡å­—æ¡†ä¸­ï¼Œé€²è¡Œé‡ç–Šæ–‡å­—åˆ¤è­˜ï¼Œå¦‚ä¸ç¬¦åˆå‰‡å†ä¸Šä¸‹ä½ç§»å³å¯ã€‚\r\nFunction checkPtFromBorders(midX,midY,BorderPTs) as booleanBorder_minX = CDbl(BorderPTs(0))Border_minY = CDbl(BorderPTs(1))Border_maxX = CDbl(BorderPTs(2))Border_maxY = CDbl(BorderPTs(3))If midX &gt;= Border_minX And midX &lt;= Border_maxX And midY &gt;= Border_minY And midY &lt;= Border_maxY Then        checkPtFromBorders = true    Exit For    End IfEnd Function\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["AutoCAD VBA","ProgeCAD VBA"]},{"title":"Seleniumæ“ä½œç´°ç¯€","url":"/posts/391727536/","content":"å‰è¨€\r\nåŸæœ¬æƒ³åƒä¸­çš„Seleniumæœƒéœ€è¦å¾ç„¡åˆ°æœ‰é–‹å•Ÿä¸€å€‹ç¶²ç«™å¾Œé–‹å§‹é€²è¡Œè³‡æ–™å¡«å¯«ï¼Œå¤§å¤šæ•¸çš„ç¶²ç«™éƒ½æœƒæœ‰å¸³è™Ÿå¯†ç¢¼é©—è­‰æ©Ÿåˆ¶ï¼Œç”šè‡³ç¥­å‡ºé©—è­‰ç¢¼ã€é¸æ“‡æ±½è»Šåœ–ç‰‡ã€ç§»å‹•æ»‘é¼ åˆ°æŒ‡å®šä½ç½®...ç­‰åçˆ¬èŸ²æ©Ÿåˆ¶ä¾†ç¢ºèªæ˜¯å¦ç‚ºæ©Ÿå™¨äººï¼Œä½†è‹¥ç¶²é å¯ä»¥è¢«æ¥ç®¡ç¹é–‹é€™äº›æ©Ÿåˆ¶çš„è©±ï¼Œé‚£æ•´å€‹è³‡æ–™å¡«å ±ä½œæ¥­å°±æœƒå¾ˆæœ‰æ©Ÿæœƒè®“é›»è…¦ä»£å‹ï¼Œé€™å°±æ˜¯å¯«ç¨‹å¼çš„è¶£å‘³ä¾†æºï¼Œç•¶ç„¶é‚„æ˜¯è¦å°å¿ƒä¸èƒ½é»å¤ªå¿«ï¼Œå¦å‰‡ç¶²ç«™å¯èƒ½æœƒè² è·ä¸éä¾†ã€‚\r\n\r\nä½¿ç”¨å·¥å…·\r\nChrome\r\nç¶²é ç€è¦½å™¨ï¼Œé€éä»¥ä¸‹æŒ‡ä»¤å³å¯é€²è¡Œç¶²ç«™æ“ä½œæ¥ç®¡ï¼Œéœ€è¦æ ¹æ“šè‡ªèº«é›»è…¦çš„chromeå®‰è£è·¯å¾‘åŸ·è¡Œï¼Œå»ºè­°å°‡åŸæœ¬æ‰€é–‹å•Ÿä¸­çš„chromeç•«é¢é€šé€šé—œé–‰å¾Œå†åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚\r\nWIN10\r\n\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\" â€“remote-debugging-port=9222\r\nWIN11\r\n\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" â€“remote-debugging-port=9222\r\nNOTE:å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ç€è¦½å™¨çš„åŸ·è¡Œè·¯å¾‘ï¼Œå¯ä»¥åœ¨åŸæœ¬æ¡Œé¢ç€è¦½å™¨æ·å¾‘æ‰¾å°‹å…§å®¹\r\n\r\n\r\nFig1. ç€è¦½å™¨ç•«é¢\r\n\r\nSelenium\r\nç›®å‰ä½¿ç”¨ç‚ºSelenium4çš„èªæ³•ï¼Œé€éåˆ†æç¶²ç«™çš„å…ƒç´ ä¾†é€²è¡Œæ–‡å­—è¼¸å…¥ã€æ–‡å­—èƒå–ã€é»æ“Šé€£çµã€å¾ªç’°è¡¨æ ¼å–å¾—ç›®æ¨™æ¬„ä½...ç­‰ã€‚\r\nç¶²ç«™æ¥ç®¡æ­¥é©Ÿ\r\n\r\næ‰“é–‹çµ‚ç«¯æ©Ÿ\r\n\r\næœå°‹&gt;è¼¸å…¥cmd\r\n\r\nè¼¸å…¥æŒ‡ä»¤\r\n\r\n\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" â€“remote-debugging-port=9222\r\n\r\né–‹å•Ÿç¶²ç«™ï¼Œè¼¸å…¥å¸³è™Ÿå¯†ç¢¼é©—è­‰ç¢¼å¾Œåˆ°å¯å¡«å¯«ç•«é¢\r\näº¤çµ¦Seleniumä¾†é€²è¡Œç¶²ç«™è‡ªå‹•å¡«å ±ä½œæ¥­ã€‚\r\n\r\nPython\r\nrequirements.txt\r\nseleniumpandasopenpyxl\r\nmain.py\r\næ¥ç®¡ç€è¦½å™¨\r\nfrom selenium import webdriverfrom selenium.webdriver.chrome.options import Optionsdef init_driver():    chrome_options = Options()    chrome_options.add_experimental_option(&quot;debuggerAddress&quot;, &quot;127.0.0.1:9222&quot;)    driver = webdriver.Chrome(options=chrome_options)    return driver    #======ä¸»è¦ä»‹é¢é–‹å§‹======driver=init_driver()# ç²å–ç•¶å‰ç¶²å€current_url = driver.current_urlprint(&quot;ç•¶å‰ç¶²å€:&quot;, current_url)\r\nå–å¾—ç¶²é å…ƒç´ \r\n\r\n\r\n\r\næ–¹æ³•\r\né©ç”¨æƒ…æ³\r\n\r\n\r\n\r\n\r\nID\r\nç”¨æ–¼å®šä½å…·æœ‰å”¯ä¸€æ¨™è­˜ç¬¦çš„å…ƒç´ \r\n\r\n\r\nXPATH\r\nç•¶å…ƒç´ ä½ç½®ä¸ç¢ºå®šæˆ–ç„¡æ³•ä½¿ç”¨å…¶ä»–æ–¹å¼å®šä½æ™‚ä½¿ç”¨\r\n\r\n\r\nLINK_TEXT\r\nç”¨æ–¼å®šä½é é¢ä¸Šå¯é»æ“Šçš„è¶…é€£çµæ–‡å­—\r\n\r\n\r\nCSS_SELECTOR\r\nç•¶å…ƒç´ çš„çµæ§‹è¼ƒç‚ºè¤‡é›œæˆ–ç„¡æ³•ä½¿ç”¨IDæ™‚ä½¿ç”¨\r\n\r\n\r\n\r\nåŸ·è¡Œç¶²é å‹•ä½œ\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\næ“ä½œé¡å‹\r\næ–¹æ³•\r\næè¿°\r\n\r\n\r\n\r\n\r\næ–‡å­—æ¬„ä½æ“ä½œ\r\nclear\r\næ¸…ç©ºæ–‡å­—æ¬„ä½çš„å…§å®¹\r\n\r\n\r\n\r\nsendkey\r\nåœ¨æ–‡å­—æ¬„ä½ä¸­è¼¸å…¥æ–‡å­—\r\n\r\n\r\n\r\nclick\r\né»æ“Šæ–‡å­—æ¬„ä½ï¼ˆè‹¥ç‚ºå¯é»æ“Šçš„å…ƒç´ ï¼‰\r\n\r\n\r\né¸æ“‡æ¬„ä½æ“ä½œ\r\nselect_by_value\r\næ ¹æ“šé¸é …çš„å€¼ä¾†é¸æ“‡\r\n\r\n\r\n\r\nselect_by_visible_value\r\næ ¹æ“šé¸é …çš„å¯è¦‹æ–‡å­—ä¾†é¸æ“‡\r\n\r\n\r\n\r\nç¶²é è¡¨æ ¼æ“ä½œ\r\ndef edit_case(driver,targetID):     select_element  = driver.find_element(By.XPATH, &#x27;//*[@id=&quot;DataTables_Table_0_length&quot;]/label/select&#x27;)    select = Select(select_element)    select.select_by_value(&quot;100&quot;)    table = driver.find_element(By.ID, &quot;DataTables_Table_0&quot;)    rows = table.find_elements(By.CSS_SELECTOR, &quot;tbody tr&quot;)    for row in rows:        cells = row.find_elements(By.CSS_SELECTOR, &quot;td&quot;)                # print(cells[0].text)                if cells[0].text==targetID:            print(cells[0].text)            edit_button = cells[3].find_element(By.CSS_SELECTOR, &quot;a&quot;)            edit_button.click()                        break\r\nåˆªé™¤æ™‚ä¹‹è­¦å‘Šè¦–çª—\r\ndef check_item_by_chname(driver,ch_name,is_rebuild):    table = driver.find_element(By.ID, &quot;DataTables_Table_0&quot;)    rows = table.find_elements(By.CSS_SELECTOR, &quot;tbody tr&quot;)    for row in rows:        cells = row.find_elements(By.CSS_SELECTOR, &quot;td&quot;)        del_button=cells[3].find_element(By.CSS_SELECTOR, &#x27;a[onclick^=&quot;delConfirm&quot;]&#x27;)        del_button.click()        alert = Alert(driver)        alert.accept()  # é»æ“Šç¢ºèª        print(&quot;å·²ç¶“å¼·åˆ¶åˆªé™¤&quot;)        \r\nåœ–ç‰‡ç½®æ›è™•ç†\r\ndef get_photo_path(ch_name):    import os    if os.path.exists(&#x27;./data/&#x27;+ch_name):        photo_list=[]        for file in os.listdir(&#x27;D:/Python/st_selenium/data/&#x27;+ch_name):            print(file)            photo_list.append(&#x27;D:/Python/st_selenium/data/&#x27;+ch_name+&quot;/&quot;+file)        return photo_listdef paste_photo(driver,photo_list):    # å®šä½æ–‡ä»¶ä¸Šå‚³çš„ input å…ƒç´     file_input = driver.find_element(By.ID, &quot;userfile1&quot;)    file_path =photo_list[0] # è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘    file_input.send_keys(file_path)    file_input = driver.find_element(By.ID, &quot;userfile2&quot;)    file_path =photo_list[1] # è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘    file_input.send_keys(file_path)    file_input = driver.find_element(By.ID, &quot;userfile3&quot;)    file_path =photo_list[2] # è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘    file_input.send_keys(file_path)# ===ä¸»è¦æ“ä½œå…§å®¹===    photo_list=get_photo_path(ch)paste_photo(driver,photo_list)    \r\n\r\nè³‡æ–™å¤¾å®‰æ’\r\n\r\n\r\n\r\nFig2.\r\nè³‡æ–™å¤¾å®‰æ’(ä»¥æ¸ é“åç¨±ç‚ºåˆ†é¡)\r\n\r\n\r\nè³‡æ–™å¤¾å…§å®¹\r\n\r\n\r\n\r\nFig1.\r\nè³‡æ–™å¤¾å…§å®¹(æª”æ¡ˆåç¨±å–ç‚ºæ•¸å­—æ–¹ä¾¿æ’åºé€²è¡Œ)\r\n\r\néŒ¯èª¤ç´€éŒ„\r\n\r\nå¦‚æœå–å¾—è¡¨æ ¼ä¹‹å¾Œå°±è¦ç›´æ¥é€²è¡Œå„é …åŠŸèƒ½æ“ä½œï¼Œæœƒå‡ºç¾ä¸­æ­¢ç‹€æ³ï¼Œéœ€è¦å…ˆæŠŠæ¯å€‹åˆ—çš„è³‡æ–™å…ˆå„²å­˜æˆlistï¼Œæ‰èƒ½æ ¹æ“šæ¯å€‹listä¸­çš„å…§å®¹é€²è¡Œå¾ŒçºŒå¡«å¯«ã€ä¿®æ”¹ã€å„²å­˜ç­‰åŠŸèƒ½ã€‚\r\n\r\nfor i in range(166,167):    # print(&quot;OO113T&quot;+str(i))    edit_case(driver,&quot;OO113T&quot;+str(i))    table = driver.find_element(By.ID, &quot;DataTables_Table_0&quot;)    rows = table.find_elements(By.CSS_SELECTOR, &quot;tbody tr&quot;)    ### å…ˆæŠŠè³‡æ–™å„²å­˜èµ·ä¾†        ch_list=[]        for row in rows:        cells = row.find_elements(By.CSS_SELECTOR, &quot;td&quot;)        ch=cells[1].text        ch_list.append(ch)    ### å¾ªç’°æ¯å€‹LISTä¸­çš„å…§å®¹é€²è¡Œå¾ŒçºŒè™•ç†            for ch in ch_list:        #do something~\r\n","categories":["åŸºæœ¬åŸç†"],"tags":["Python","Selenium"]},{"title":"é“è·¯æ¨™ç·šæ¨™è¨»å½™ç¸½VBA","url":"/posts/2735421494/","content":"å‰è¨€\r\né“è·¯æ¨™ç·šï¼Œä¹ƒä¾æ“šé“è·¯äº¤é€šæ¨™èªŒæ¨™ç·šè™ŸèªŒè¨­ç½®è¦å‰‡æ‰€ç¹ªè£½è€Œæˆï¼Œæ–¼CADä¸Šå¸¸ç”¨èšåˆç·šã€é™£åˆ—ã€åœ–å¡Šä¾†å‘ˆç¾ï¼Œå¹³é¢åœ–ä¸Šç¹ªè£½ã€æ¨™è¨»ã€æ•¸é‡å½™ç¸½ï¼Œæœ€å¾Œè®“æ–½å·¥å» å•†æ“šä»¥æ–½å·¥ï¼Œï¼Œç„¡è«–æ˜¯æ¨™ç·šæˆ–åœ–å¡Šçš†éœ€è¦æ›ç®—å…¶æ–½ä½œé¢ç©(m2)è¨ˆåƒ¹ã€‚\r\n\r\næ“ä½œå°è±¡\r\n\r\n\r\nèšåˆç·š\r\n\r\nè·¯é¢é‚Šç·šã€ç¦æ­¢è‡¨æ™‚åœè»Šç·šã€ç¦æ­¢åœè»Šç·š...ç­‰\r\n\r\né™£åˆ—\r\n\r\næ•æœ¨ç´‹è¡Œäººç©¿è¶Šç·šã€è·¯å£è¡Œè»Šå¼•å°ç·š...ç­‰\r\n\r\nåœ–å¡Š\r\n\r\nå³è½‰ç®­é ­ã€å·¦è½‰ç®­é ­ã€æ©Ÿè»Šåœç­‰å€...ç­‰\r\n\r\n\r\nå·¥ä½œæµç¨‹ä¸­æœ€ç¹ç‘£çš„æ­¥é©Ÿé‡å°æ¯å€‹æ¨™ç·šæ¨™ç¤ºå…¶ç·šååŠé•·åº¦ï¼Œå†æ ¹æ“šå„å€‹ä¸åŒç·šåç™»æ‰“æ•¸é‡å…¬å¼ï¼Œæœ¬ç¯‡æ–‡ç« ä»‹ç´¹å¦‚ä½•é€éAutoCAD\r\nVBAçš„æ–¹å¼ï¼Œå°‡å„å€‹æ“ä½œå°è±¡åŸå…ˆçš„å·¥ä½œæµç¨‹é€²è¡Œç°¡åŒ–ã€‚\r\n\r\né æœŸæˆæœ\r\n\r\n\r\nFig1. æ¨™ç·šæ‰€éœ€æ¨™ç¤ºå…§å®¹\r\n\r\nç¹ªè£½æ–¹å¼\r\nç·šæ®µç¹ªè£½\r\nç·šã€èšåˆç·šéƒ½æ˜¯å±¬æ–¼ç·šæ®µçš„ä¸€ç¨®ï¼Œä½†å°æ–¼VBAè€Œè¨€ï¼Œä»–å€‘çš„åº§æ¨™ç‰©ä»¶ä¸åŒï¼Œç·šçš„åº§æ¨™ç‚ºStartPointåŠEndPointï¼Œèšåˆç·šçš„åº§æ¨™ç‚ºCoordinatesï¼Œå»ºè­°åœ¨ä½¿ç”¨ä¸Šéƒ½ç”¨èšåˆç·š(æŒ‡ä»¤ç‚ºPL)ä½œç‚ºç•«ç·šçš„æ–¹å¼ã€‚\r\nåœ–å±¤è¨­å®š\r\nVBAä¸­å¯ä»¥é€éSelectionSetæ¡†é¸CADç‰©ä»¶ï¼Œä¸¦é‡å°å„å€‹ç‰©ä»¶é€²è¡Œå±¬æ€§è®€å–ï¼ŒåŒ…å«åœ–å±¤ã€åº§æ¨™ã€é•·åº¦...ç­‰ç­‰ï¼Œå¦‚æœå°‡æ‰€æœ‰çš„ç‰©ä»¶éƒ½æ‹‰é€²ä¾†ï¼Œåœ¨è¨ˆç®—ä¸Šæœƒè¼ƒé›£è™•ç†ï¼Œå› æ­¤è¦è®“ä½¿ç”¨è€…åœ¨ç¹ªè£½ç·šæ®µçš„éç¨‹ï¼Œå°‡åœ–å±¤åç¨±è¨­ç½®å‰ç¶´ä»¥åˆ©ç¨‹å¼åˆ¤è®€ï¼Œå†å°‡æ“ä½œå°è±¡è¨­å®šç‚ºæ­¤åœ–å±¤åã€‚\r\n\r\nèˆ‰ä¾‹: é•·åº¦_ç¦æ­¢åœè»Šç·š èˆ‰ä¾‹: é™£åˆ—_æ•æœ¨ç´‹è¡Œç©¿ç·š\r\n\r\nåŸ·è¡Œæ­¥é©Ÿ\r\n\r\nç¢ºèªæ“ä½œå°è±¡ç‚ºèšåˆç·šï¼Œä¸¦ä¸”åœ–å±¤åç¨±ç‚ºé•·åº¦_{ç·šå}\r\nç¢ºèªæ“ä½œå°è±¡ç‚ºé™£åˆ—éƒ¨åˆ†ï¼Œå…¶åœ–å±¤åç¨±ç‚ºé™£åˆ—_{ç·šå}\r\né»é¸æŒ‰éˆ•é•·åº¦æ¨™ç¤º\r\nç§»å‹•è‡³CADæ¡†é¸æ‰€æœ‰é•·åº¦å…§å®¹\r\nç”±ä¸‹è€Œä¸Šä¾åºé»é¸æ¨™ç·šæ–‡å­—å‡ºç¾ä½ç½®\r\né»é¸æŒ‰éˆ•é•·åº¦å½™ç¸½\r\nç§»å‹•è‡³CADé»é¸é•·åº¦å½™ç¸½å‡ºç¾ä½ç½®\r\n\r\nå½±ç‰‡DEMO\r\n\r\n\r\n","categories":["å°ˆæ¡ˆé–‹ç™¼"],"tags":["AutoCAD VBA"]},{"title":"é›²ç«¯ç©ºé–“Synology-C2-Object","url":"/posts/1168852487/","content":"å‰è¨€\r\nä¸€æåˆ°é›²ç«¯ç©ºé–“ï¼Œå»£ç‚ºäººçŸ¥çš„ä¸å¤–ä¹æ˜¯Google\r\nDriveã€DropBoxã€OneDriveç­‰ç­‰çŸ¥åå¤§å» çš„ç”¢å“ï¼ŒNAS(åœ°ç«¯å„²å­˜ä¼ºæœå™¨)å‰‡å¤§å¤šå¸¸è¦‹ç‚ºSynologyç¾¤æš‰æ‰€ä¸»å°ï¼Œè€Œæœ¬ç¯‡è¦ä»‹ç´¹çš„Synology\r\nC2 Objectå‰‡æ˜¯ç¾¤æš‰æ‰€æä¾›çš„æœå‹™ä¹‹ä¸€ã€‚\r\nåœ¨ç¶²è·¯ä¸Šæœ‰è¨±å¤šæœå‹™ç¶“éä½¿ç”¨è€…å°ç¶²é é€²è¡Œäº’å‹•ï¼Œä¼ºæœå™¨èƒŒå¾Œé€šå¸¸éƒ½æœƒæœ‰ä¸€å€‹ä»¥ä¸Šçš„è³‡æ–™åº«åŠæª”æ¡ˆç©ºé–“é€²è¡Œå„²å­˜ï¼Œè€Œæœ¬ç¯‡\r\nSynology C2 Object\r\nå°±æ˜¯æŒ‡æª”æ¡ˆå­˜å­˜æ”¾ç©ºé–“ï¼Œåªå› ç‚ºå®ƒå±¬æ–¼é›²ç«¯æ‰€æä¾›çš„æœå‹™ï¼Œå› æ­¤å«åšé›²ç«¯ç©ºé–“ã€‚\r\næœªä¾†åªè¦æœ‰å»ºç«‹å¥½é€£æ¥çš„åƒæ•¸ï¼Œå°±å¯ä»¥é€éAPIé€²è¡Œå‘¼å«å­˜æ”¾ã€å–ç”¨ï¼Œæœ‰é—œæª”æ¡ˆç©ºé–“ç”³è«‹ä¸»è¦ç›®çš„ç‚ºå–å¾—ä¸‹åˆ—é‡è¦åƒæ•¸ï¼Œä»¥å‚™æœªä¾†é€²è¡Œæª”æ¡ˆç©ºé–“ä¸²æ¥ã€‚\r\n\r\nBUCKET_NAME\r\nendpoint_url\r\naws_access_key_id\r\naws_secret_access_key\r\n\r\n\r\n\r\nç”³è«‹æµç¨‹\r\né»æ“Šç™»å…¥\r\nå¯ä»¥ç¶å®šGoogleæˆ–è€…è‡ªè¡Œç”³è«‹ä¸€çµ„å¸³è™Ÿå¯†ç¢¼\r\n\r\n\r\nFig1.å¤šç¨®ç™»å…¥æ–¹å¼\r\n\r\nç™»å…¥ç•«é¢\r\n\r\n\r\nFig2.å…¥å£ç•«é¢\r\n\r\né¸å–C2 Object Storage\r\n\r\n\r\nFig3.é¸æ“‡C2 Object\r\nStorageæœå‹™\r\n\r\né»é¸é–‹å§‹ä½¿ç”¨15GBå…è²»ç©ºé–“\r\n\r\n\r\nFig4.é–‹å§‹ä½¿ç”¨\r\n\r\né»é¸æœå‹™æ¢æ¬¾\r\n\r\n\r\nFig5.æœå‹™æ¢æ¬¾\r\n\r\nå»ºç«‹å„²å­˜é«”\r\n\r\n\r\nFig6.å»ºç«‹å„²å­˜é«”\r\n\r\n\r\n\r\nFig7.å»ºç«‹å­˜å–é‡‘é‘°\r\n\r\n\r\n\r\nFig8.é è¨­å°±å¥½\r\n\r\nå–å¾—é‡‘é‘°IDèˆ‡ç§å¯†é‡‘é‘°\r\n\r\n\r\nFig9.å­˜å–é‡‘é‘°èˆ‡ç§å¯†é‡‘é‘°\r\n\r\n\r\naws_access_key_id\r\naws_secret_access_key\r\n\r\nç¢ºèªå„²å­˜é«”åç¨±åŠç«¯é»\r\n\r\n\r\nFig9.å„²å­˜é«”åç¨±åŠç«¯é»\r\n\r\n\r\nBUCKET_NAME\r\nendpoint_url\r\n\r\nçµè«–\r\nç”³è«‹å®Œç•¢ä¹‹å¾Œå°±å¯ä»¥ç”¨Pythonä¸­Boto3çš„å¥—ä»¶é€²è¡Œæª”æ¡ˆç©ºé–“çš„å„²å­˜ã€ä¸‹è¼‰äº†ï¼Œæœªä¾†è¦é–‹ç™¼ç›¸é—œç¶²ç«™çš„æ™‚å€™ä¹Ÿå¤šäº†ä¸€å€‹åœ°æ–¹å¯ä»¥æ”¾ç½®æª”æ¡ˆã€‚\r\né–‹ç™¼ç¯„ä¾‹\r\nimport boto3from botocore.exceptions import NoCredentialsError, PartialCredentialsErrorimport streamlit as stimport pandas as pd# è«‹å¡«å…¥ä½ çš„ bucket åç¨±BUCKET_NAME = &#x27;hankbucket&#x27;# è¨­å®š S3 å®¢æˆ¶ç«¯def get_s3_client():    return boto3.client(        &#x27;s3&#x27;,        endpoint_url=&#x27;https://OOOOO.OO.synologyc2.net&#x27;,        aws_access_key_id=&#x27;twmOPTcq8MAxXaNVMOOOOOOOOO&#x27;,        aws_secret_access_key=&#x27;n7O1Pys3nyp15T5OGOOOOOOO&#x27;    )# åˆ—å‡ºæ‰€æœ‰æª”æ¡ˆdef list_files(bucket_name):    s3 = get_s3_client()    try:        response = s3.list_objects_v2(Bucket=bucket_name)        files = response.get(&#x27;Contents&#x27;, [])        # print(files)        file_list = []        for file in files:            file_info = &#123;                &quot;File Name&quot;: file[&#x27;Key&#x27;],                &quot;Size (bytes)&quot;: file[&#x27;Size&#x27;],                &quot;Last Modified&quot;: file[&#x27;LastModified&#x27;],                &quot;ETag&quot;: file[&#x27;ETag&#x27;]            &#125;            file_list.append(file_info)        return file_list    except (NoCredentialsError, PartialCredentialsError) as e:        return str(e)# ä¸Šå‚³æª”æ¡ˆdef upload_file(bucket_name, file_path, object_name):    s3 = get_s3_client()    try:        with open(file_path, &#x27;rb&#x27;) as f:            s3.upload_fileobj(f, bucket_name, object_name)        return f&quot;Uploaded &#123;object_name&#125; to &#123;bucket_name&#125;&quot;    except Exception as e:        return str(e)# ä¸Šå‚³æª”æ¡ˆä¸¦ç²å–å”¯ä¸€ç¢¼def upload_file_and_get_etag(bucket_name, file_path, object_name):    s3 = get_s3_client()    try:        with open(file_path, &#x27;rb&#x27;) as f:            response = s3.upload_fileobj(f, bucket_name, object_name)        return response[&#x27;ETag&#x27;]    except Exception as e:        return str(e)# ä¸Šå‚³æª”æ¡ˆä¸¦é¡¯ç¤ºå”¯ä¸€ç¢¼def upload_new_file():    uploaded_file = st.file_uploader(&quot;Choose a file&quot;)    if uploaded_file is not None:        with open(uploaded_file.name, &quot;wb&quot;) as f:            f.write(uploaded_file.getbuffer())        etag = upload_file_and_get_etag(BUCKET_NAME, uploaded_file.name, uploaded_file.name)        st.write(f&quot;Uploaded &#123;uploaded_file.name&#125; with ETag: &#123;etag&#125;&quot;)# åˆªé™¤æª”æ¡ˆdef delete_file(bucket_name, object_name):    s3 = get_s3_client()    try:        s3.delete_object(Bucket=bucket_name, Key=object_name)        return f&quot;Deleted &#123;object_name&#125; from &#123;bucket_name&#125;&quot;    except Exception as e:        return str(e)# åˆ—å‡ºæ‰€æœ‰æª”æ¡ˆdef list_all_files():    files = list_files(BUCKET_NAME)    if files:        # print(files)        file_list = [&#123;&quot;File Name&quot;: file[&#x27;File Name&#x27;],                       &quot;Etag&quot;: file[&#x27;ETag&#x27;],                       &quot;Size (bytes)&quot;: file[&#x27;Size (bytes)&#x27;], &quot;Last Modified&quot;: file[&#x27;Last Modified&#x27;]&#125;                         for file in files]        df = pd.DataFrame(file_list)        return df    else:        return pd.DataFrame(columns=[&quot;File Name&quot;, &quot;ETag&quot;])# ä¸‹è¼‰æª”æ¡ˆdef download_file(bucket_name, object_name):    s3 = get_s3_client()    try:        with open(object_name, &#x27;wb&#x27;) as f:            s3.download_fileobj(bucket_name, object_name, f)        return f&quot;Downloaded &#123;object_name&#125; from &#123;bucket_name&#125;&quot;    except Exception as e:        return str(e)# ä¸‹è¼‰æª”æ¡ˆdef download_selected_file(selected_file):    response = download_file(BUCKET_NAME, selected_file)    st.write(response)# Streamlit app layoutst.title(&quot;Synology C2 Storage Management with S3 API&quot;)st.header(&quot;List and Download Files&quot;)files_df = list_all_files()st.dataframe(files_df)if not files_df.empty:    selected_file = st.selectbox(&quot;Select a file to download&quot;, files_df[&quot;File Name&quot;].tolist())    if st.button(&quot;Download File&quot;):        download_selected_file(selected_file)st.header(&quot;Upload a New File and Get Unique ETag&quot;)upload_new_file()\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["Python","API"]},{"title":"Clever cloud postgreSQLç”³è«‹æµç¨‹","url":"/posts/3965020317/","content":"å‰è¨€\r\nè³‡æ–™åº«ä»‹ç´¹\r\nè³‡æ–™åº«(æ­¤ç‚ºé—œè¯å¼è³‡æ–™åº«)çš„ä¸»è¦ç”¨é€”æ˜¯ç‚ºè³‡æ–™æä¾›ä¸€å€‹å„²å­˜ç©ºé–“ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é€²è¡Œè®€å–ã€å¯«å…¥ã€ä¿®æ”¹ã€åˆªé™¤ç­‰åŠŸèƒ½ã€‚\r\né—œè¯å¼è³‡æ–™åº«å¸¸è¦‹å¦‚ä¸‹:\r\n\r\nMySQL å’Œ PostgreSQL æ˜¯é–‹æºä¸”å»£æ³›ä½¿ç”¨çš„é¸æ“‡ï¼Œé©åˆä¸­å°å‹æ‡‰ç”¨ç¨‹å¼\r\nMicrosoft SQL Server é€šå¸¸ç”¨æ–¼å¤§å‹ä¼æ¥­è§£æ±ºæ–¹æ¡ˆ\r\nSQLite å‰‡æ˜¯ä¸€å€‹è¼•é‡ç´šçš„è³‡æ–™åº«ï¼Œé©åˆç”¨æ–¼åµŒå…¥å¼æ‡‰ç”¨æˆ–å–®æ©Ÿæ‡‰ç”¨ã€‚\r\n\r\nç”³è«‹é›²ç«¯æœå‹™\r\næœ¬ç¯‡æ–‡ç« ä»‹ç´¹çš„éƒ¨åˆ†ç‚ºClever Cloud æ‰€æä¾›ç„¡æ–™çš„ 256MB PostgreSQL\r\næœå‹™ï¼Œé©åˆéœ€è¦åŸºæœ¬è³‡æ–™åº«åŠŸèƒ½çš„å°å‹æ‡‰ç”¨ç¨‹å¼ã€‚\r\né‡è¦åƒæ•¸\r\nç•¶æ‚¨æˆåŠŸè¨»å†Šä¸¦å•Ÿç”¨ PostgreSQL æœå‹™å¾Œï¼Œåªéœ€è¦å–å¾—ä¸€é …é‡è¦åƒæ•¸\r\nCONNECTION_URIå³å¯é–‹å§‹ä½¿ç”¨é›²ç«¯è³‡æ–™åº«ã€‚\r\n\r\né€²å…¥ç¶²ç«™\r\nClever-Coud\r\nè¨»å†Š\r\n\r\n\r\nFig1. ç™»å…¥é é¢\r\n\r\nè¨»å†Šæ–¹å¼:\r\n\r\nemail\r\nGithub\r\n\r\n\r\n\r\nFig2. ç™»å…¥é é¢2\r\n\r\nå…¥å£ç•«é¢\r\n\r\n\r\nFig3. å…¥å£ç•«é¢\r\n\r\néœ€è¦å…ˆå»é©—è­‰ä½ çš„emailæ˜¯å¦æ­£ç¢º\r\n\r\n\r\nFig4. é©—è­‰ä¿¡å…§å®¹\r\n\r\næ–°å¢ä¸€å€‹addon\r\n\r\n\r\nFig5. æ–°å»ºæŒ‰éˆ•\r\n\r\né¸å–PostgreSQL\r\n\r\n\r\nFig6. è³‡æ–™åº«æœå‹™\r\n\r\næŒ‡å®šè¨ˆç•«åç¨±ç‚ºDEVï¼Œæœ€å³ä¸‹è§’æœ‰ä¸€å€‹next\r\n\r\n\r\nFig7. é¸æ“‡å…§å®¹DEV\r\n\r\nå¡«å¯«åç¨±\r\n\r\n\r\nFig8. æœå‹™åç¨±\r\n\r\næœå‹™æˆåŠŸå»ºç«‹\r\n\r\n\r\nFig9. è³‡æ–™åº«ç®¡ç†ä»‹é¢\r\n\r\n\r\nçµè«–\r\nä¸Šè¿°çµè«–å°±å¯ä»¥å¾—åˆ°ä¸€çµ„ Connection\r\nURIï¼Œé€™å°±å¯ä»¥æ‹¿ä¾†ç•¶ä½œå…¶ä»–ç¶²ç«™çš„è³‡æ–™åº«ä½¿ç”¨äº†!!\r\n\r\n256MBé›–ç„¶æ²’æœ‰å¾ˆå¤§ï¼Œä½†æ˜¯å¯ä»¥å¡å¤§æ¦‚58è¬æ¢ç´”æ–‡å­—ç´€éŒ„ï¼Œä¸€èˆ¬é–‹ç™¼ä¸Šä¾†èªªæ»¿å¤ çš„ã€‚\r\n\r\nä¸²æ¥ç¯„ä¾‹\r\nfrom sqlalchemy import create_engine, Column, Integer, String, DateTime, JSON, UniqueConstraint, ForeignKeyfrom sqlalchemy.orm import sessionmaker,declarative_base, relationshipfrom datetime import datetimefrom sqlalchemy.orm import Sessionfrom sqlalchemy import select,textimport pytz# PostgreSQL é…ç½®(æ”¹æˆä½ çš„)DATABASE_URL=&quot;postgresql://uizbhnmkOOOOOO:K0r18XtU1Nb2yGwC1SfwoOOOOOOO@bngbuvea6wkwlOOOg-postgresql.services.clever-cloud.com:50OOO/bngbuvea6wOOOOOOhzig&quot;engine = create_engine(DATABASE_URL)SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)# DATABASE_URL2=&quot;sqlite:///members.db&quot;# engine2 = create_engine(DATABASE_URL2)# SessionLocal2 = sessionmaker(autocommit=False, autoflush=False, bind=engine2)    Base = declarative_base()# å®šç¾©æ•¸æ“šåº«æ¨¡å‹class Photo(Base):    __tablename__ = &#x27;photos_backup&#x27;    id = Column(Integer, primary_key=True, index=True)    user_id = Column(String(255))    group_id = Column(String(255))    photo_name = Column(String(255))    photo_url = Column(String(255))    photo_thumbnail_url = Column(String(255))    place_tmp=  Column(String(50))    created_time = Column(DateTime, default=lambda: datetime.now(pytz.timezone(&#x27;Asia/Taipei&#x27;)))    photo_properties = Column(JSON)    photo_image_hash = Column(String(255))#, unique=True, nullable=False)Base.metadata.create_all(bind=engine)def add_photo(user_id, group_id, photo_name, photo_url, photo_thumbnail_url, place_tmp, photo_properties, photo_image_hash):    # å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±    db: Session = SessionLocal()    try:        # å‰µå»º Photo å¯¦ä¾‹        new_photo = Photo(            user_id=user_id,            group_id=group_id,            photo_name=photo_name,            photo_url=photo_url,            photo_thumbnail_url=photo_thumbnail_url,            place_tmp=place_tmp,            photo_properties=photo_properties,            photo_image_hash=photo_image_hash        )                # å°‡æ–°å¯¦ä¾‹æ·»åŠ åˆ°æœƒè©±ä¸­        db.add(new_photo)                # æäº¤æœƒè©±ä»¥ä¿å­˜æ›´æ”¹        db.commit()                # åˆ·æ–°æœƒè©±ä»¥ç²å–æ–°è³‡æ–™çš„ ID        db.refresh(new_photo)                print(f&quot;æ–°å¢ç…§ç‰‡è³‡æ–™æˆåŠŸï¼ŒID: &#123;new_photo.id&#125;&quot;)    except Exception as e:        # å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™        db.rollback()        print(f&quot;æ–°å¢ç…§ç‰‡è³‡æ–™å¤±æ•—: &#123;e&#125;&quot;)    finally:        # é—œé–‰æœƒè©±        db.close()def get_all_photos():    # å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±    db: Session = SessionLocal()    try:        # ç²å–æ‰€æœ‰ç…§ç‰‡è³‡æ–™        photos = db.query(Photo).all()        return photos    except Exception as e:        # å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™        db.rollback()        print(f&quot;ç²å–ç…§ç‰‡è³‡æ–™å¤±æ•—: &#123;e&#125;&quot;)    finally:        # é—œé–‰æœƒè©±        db.close()def delete_photo_by_id(photo_id):    # å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±    db: Session = SessionLocal()    try:        # é€é ID åˆªé™¤ç…§ç‰‡è³‡æ–™        db.query(Photo).filter(Photo.id == photo_id).delete()        db.commit()        print(f&quot;åˆªé™¤ç…§ç‰‡è³‡æ–™æˆåŠŸï¼ŒID: &#123;photo_id&#125;&quot;)    except Exception as e:        # å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™        db.rollback()        print(f&quot;åˆªé™¤ç…§ç‰‡è³‡æ–™å¤±æ•—: &#123;e&#125;&quot;)    finally:        # é—œé–‰æœƒè©±        db.close()# ä½¿ç”¨ç¯„ä¾‹add_photo(    user_id=&quot;user_123&quot;,    group_id=&quot;group_456&quot;,    photo_name=&quot;example_photo.jpg&quot;,    photo_url=&quot;http://example.com/photo.jpg&quot;,    photo_thumbnail_url=&quot;http://example.com/photo_thumb.jpg&quot;,    place_tmp=&quot;Taipei&quot;,    photo_properties=&#123;&quot;description&quot;: &quot;A beautiful sunset.&quot;&#125;,    photo_image_hash=&quot;hash_value_example&quot;)photos = get_all_photos()print(photos)delete_photo_by_id(1)session = SessionLocal()try:    # ä½¿ç”¨åŸç”Ÿ SQL åŸ·è¡Œ ALTER TABLEï¼Œä¸¦ä½¿ç”¨ text() åŒ…è£ SQL èªå¥    # session.execute(text(&quot;ALTER TABLE photos_backup ADD COLUMN description TEXT&quot;))    session.execute(text(&quot;DROP TABLE IF EXISTS photos_backup&quot;))    session.commit()except Exception as e:    print(f&quot;å‡ºéŒ¯äº†: &#123;e&#125;&quot;)    session.rollback()finally:    session.close()\r\né­é‡å•é¡Œç´€éŒ„\r\nç•¶ä»‹é¢çš„PG\r\nStudioç„¡æ³•ç™»å…¥æ™‚ï¼Œæœƒç„¡æ³•æ“ä½œè³‡æ–™åº«ä¸­çš„æ‰€æœ‰å…§å®¹ï¼Œå„˜ç®¡ç”¨pgadminä¾†é€²è¡Œä¹Ÿæœƒå‡ºç¾'ServerManager'æ²’æœ‰å­˜åœ¨user_infoä¹‹é¡çš„éŒ¯èª¤è¨Šæ¯ã€‚\r\næˆ‘ç”¨streamlitå»ºç«‹ä¸€å€‹ä»‹é¢å»é€²è¡Œæ“ä½œä¹Ÿç„¡æ³•æˆåŠŸ(å¾Œä¾†æ“ä½œæˆåŠŸäº†!?)\r\nVScodeé€²è¡Œé€£æ¥æ™‚æœƒå‡ºç¾pg_tableç„¡æ³•é¡¯ç¤º\r\nç¸½è¨€ä¹‹å°±æ˜¯ä¸€å€‹å¾ˆç„¡è§£çš„éç¨‹ï¼Œçœ‹ä¾†é›²ç«¯æœå‹™ä¹Ÿä¸ä¸€å®šæ˜¯å¥½çš„æ–¹æ¡ˆï¼Œèƒ½å¤ å®Œæ•´æŒæ¡æœƒæ¯”è¼ƒå®‰å…¨\r\n","categories":["åŸºæœ¬æ¦‚å¿µ"],"tags":["SQL"]}]